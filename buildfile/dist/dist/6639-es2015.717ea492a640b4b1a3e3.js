"use strict";(self.webpackChunkassc_crs=self.webpackChunkassc_crs||[]).push([[6639,7506],{36639:function(e,t,i){i.r(t),i.d(t,{DwBaseIframeComponent:function(){return d},DwBaseIframeModule:function(){return b},DwIframeGeneralComponent:function(){return v},DwIframeGeneralModule:function(){return w},DwIframeModule:function(){return g}});var n=i(55245),r=i(42746),s=i(71049),a=i(87974),o=i(47372),m=i(30469),c=i(83174),u=i(27038);const f=["dwIframe"],l=function(e){return["iframe-ww",e]};function h(e,t){if(1&e&&(r.\u0275\u0275elementContainerStart(0),r.\u0275\u0275elementStart(1,"div",1),r.\u0275\u0275elementStart(2,"div",2),r.\u0275\u0275element(3,"iframe",3,4),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275element(5,"div",5),r.\u0275\u0275elementContainerEnd()),2&e){const e=r.\u0275\u0275nextContext();r.\u0275\u0275advance(1),r.\u0275\u0275attribute("iframetype",null==e.item?null:e.item.type),r.\u0275\u0275advance(2),r.\u0275\u0275property("ngClass",r.\u0275\u0275pureFunction1(5,l,"dw-f-iframe-"+(null==e.item?null:e.item.type))),r.\u0275\u0275attribute("sandbox",null==e.item?null:e.item.attr),r.\u0275\u0275advance(2),r.\u0275\u0275styleProp("display",!0===e.showMask?"block":"none")}}function p(e,t){if(1&e&&r.\u0275\u0275element(0,"dw-base-iframe",1),2&e){const e=r.\u0275\u0275nextContext();r.\u0275\u0275property("item",e.item)("itemObserve",e.itemRxjsBehavior)}}let d=(()=>{class e{constructor(e){this._elementRef=e}ngOnInit(){}ngAfterViewInit(){this.iframes.changes.subscribe(e=>{e.length&&this.item&&(e.first.nativeElement.src=this.item.url)}),this.itemObserve?this.itemObserve.subscribe(e=>{e&&(this.item=e,this.iframe.nativeElement.src=this.item.url)},e=>{}):this.iframe&&(this.iframe.nativeElement.src=this.item.url)}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275directiveInject(r.ElementRef))},e.\u0275cmp=r.\u0275\u0275defineComponent({type:e,selectors:[["dw-base-iframe"]],viewQuery:function(e,t){if(1&e&&(r.\u0275\u0275viewQuery(f,5),r.\u0275\u0275viewQuery(f,5)),2&e){let e;r.\u0275\u0275queryRefresh(e=r.\u0275\u0275loadQuery())&&(t.iframe=e.first),r.\u0275\u0275queryRefresh(e=r.\u0275\u0275loadQuery())&&(t.iframes=e)}},inputs:{item:"item",itemObserve:"itemObserve",showMask:"showMask"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"ww-iframe-overflow"],[1,"ww-iframe-block"],["frameborder","0",3,"ngClass"],["dwIframe",""],[1,"drag-handler","iframe-mask"]],template:function(e,t){1&e&&r.\u0275\u0275template(0,h,6,7,"ng-container",0),2&e&&r.\u0275\u0275property("ngIf",t.item)},directives:[n.NgIf,n.NgClass],styles:["[_nghost-%COMP%]{height:100%;width:100%}.ww-iframe-block[_ngcontent-%COMP%]{position:relative;width:100%;height:100%}.iframe-ww[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.iframe-mask[_ngcontent-%COMP%]{display:none;background-color:#fff0;position:absolute;top:0;left:0;right:0;bottom:0}.ww-iframe-overflow[_ngcontent-%COMP%]{height:100%}"]}),e})(),b=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=r.\u0275\u0275defineInjector({imports:[[n.CommonModule]]}),e})(),v=(()=>{class e{constructor(e,t,i,n,r){this.router=e,this.activatedRoute=t,this.iframeGeneralInfoService=i,this.usingTab=n,this.item={url:"",type:"externalUrl"},this.postMessageHub=r.getHubInstance(),this.itemRxjsBehavior=new s.BehaviorSubject(null)}ngOnInit(){if(!this.usingTab){let e=!1;this.initSubscription=this.activatedRoute.paramMap.pipe((0,o.switchMap)(e=>this.activatedRoute.queryParamMap,(e,t)=>({routeParam:e,queryParam:t}))).subscribe(t=>{e||(e=!0,this.setIframe(t.routeParam,t.queryParam.params)),this.initSubscription&&this.initSubscription.unsubscribe()}),this.changeSubscription=this.router.events.pipe((0,o.filter)(e=>e instanceof a.NavigationEnd),(0,o.withLatestFrom)(this.activatedRoute.paramMap,this.activatedRoute.queryParamMap)).subscribe(([e,t,i])=>{this.setIframe(t,i.params)})}}ngOnDestroy(){this.initSubscription&&this.initSubscription.unsubscribe(),this.changeSubscription&&this.changeSubscription.unsubscribe()}setIframe(e,t){const i=e.get("programId");this.iframeGeneralInfoService.generalInfo(i,t).subscribe(e=>{this.item=e,this.itemRxjsBehavior.next(this.item)},e=>{console.log(e)})}ngAfterViewInit(){if(this.baseIframeComponent&&this.baseIframeComponent.iframe){const e=this.baseIframeComponent.iframe.nativeElement.contentWindow,t=new URL(this.baseIframeComponent.iframe.nativeElement.src);this.postMessageHub.addReceiver(e,`${t.protocol}//${t.host}`)}}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275directiveInject(a.Router),r.\u0275\u0275directiveInject(a.ActivatedRoute),r.\u0275\u0275directiveInject(u.DwIframeGeneralInfoService),r.\u0275\u0275directiveInject(m.DW_USING_TAB),r.\u0275\u0275directiveInject(c.DwPostMessageFactoryService))},e.\u0275cmp=r.\u0275\u0275defineComponent({type:e,selectors:[["dw-iframe-general"]],viewQuery:function(e,t){if(1&e&&r.\u0275\u0275viewQuery(d,5),2&e){let e;r.\u0275\u0275queryRefresh(e=r.\u0275\u0275loadQuery())&&(t.baseIframeComponent=e.first)}},decls:1,vars:1,consts:[[3,"item","itemObserve",4,"ngIf"],[3,"item","itemObserve"]],template:function(e,t){1&e&&r.\u0275\u0275template(0,p,1,2,"dw-base-iframe",0),2&e&&r.\u0275\u0275property("ngIf",!t.usingTab)},directives:[n.NgIf,d],styles:["[_nghost-%COMP%]{height:100%;width:100%}"]}),e})(),w=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=r.\u0275\u0275defineInjector({imports:[[n.CommonModule,b]]}),e})(),g=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=r.\u0275\u0275defineInjector({imports:[[n.CommonModule],b,w]}),e})()}}]);