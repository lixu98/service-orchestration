"use strict";(self.webpackChunkassc_crs=self.webpackChunkassc_crs||[]).push([[5145,4933],{5145:function(e,t,n){n.r(t),n.d(t,{DwLoginBlockComponent:function(){return de},DwLoginBlockModalComponent:function(){return ce},DwLoginBlockModalModule:function(){return me},DwLoginBlockModalService:function(){return ue},DwLoginModule:function(){return pe},DwRememberLoginService:function(){return se}});var r=n(42746),i=n(62481),o=n(12146),a=n(87974),l=n(1020),s=n(71049),d=n(83522),c=n(31441),m=n(30469),u=n(32276),p=n(66800),g=n(32245),w=n(68521),h=n(52575),f=n(44573),v=n(52161),b=n(44720),S=n(59083),E=n(55245),I=n(85277),y=n(93761),C=n(35626),T=n(85773),x=n(67280),D=n(74591),L=n(80376),N=n(29872),M=n(78169),P=n(12095),R=n(8852),F=n(96670);const k=["tenantModalTemp"];function A(e,t){1&e&&r.\u0275\u0275elementContainer(0)}function O(e,t){if(1&e&&(r.\u0275\u0275elementStart(0,"dw-tab",8),r.\u0275\u0275pipe(1,"translate"),r.\u0275\u0275template(2,A,1,0,"ng-container",9),r.\u0275\u0275elementEnd()),2&e){const e=t.$implicit,n=r.\u0275\u0275nextContext(2),i=r.\u0275\u0275reference(2),o=r.\u0275\u0275reference(4);r.\u0275\u0275property("dwTitle",r.\u0275\u0275pipeBind1(1,2,"dw-login-"+e)),r.\u0275\u0275advance(2),r.\u0275\u0275property("ngTemplateOutlet",n.tabSelectedIndex===n.loginTypeEnum.GENERAL?i:o)}}function V(e,t){if(1&e){const e=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementContainerStart(0),r.\u0275\u0275elementStart(1,"div",5),r.\u0275\u0275elementStart(2,"dw-tabset",6),r.\u0275\u0275listener("dwSelectedIndexChange",function(t){return r.\u0275\u0275restoreView(e),r.\u0275\u0275nextContext().tabSelectedIndex=t})("dwSelectedIndexChange",function(t){return r.\u0275\u0275restoreView(e),r.\u0275\u0275nextContext().tabsChanged(t)}),r.\u0275\u0275template(3,O,3,4,"dw-tab",7),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementContainerEnd()}if(2&e){const e=r.\u0275\u0275nextContext();r.\u0275\u0275advance(2),r.\u0275\u0275property("dwTabPosition","top")("dwType","card")("dwSelectedIndex",e.tabSelectedIndex),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngForOf",e.tabs)}}function j(e,t){1&e&&r.\u0275\u0275element(0,"i",27)}function _(e,t){1&e&&r.\u0275\u0275element(0,"i",28)}function U(e,t){1&e&&(r.\u0275\u0275elementStart(0,"label",29),r.\u0275\u0275element(1,"span",30),r.\u0275\u0275elementEnd()),2&e&&(r.\u0275\u0275advance(1),r.\u0275\u0275property("translate","dw-login-rememberMe"))}function B(e,t){if(1&e){const e=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementStart(0,"div",31),r.\u0275\u0275elementStart(1,"label"),r.\u0275\u0275elementStart(2,"a",32),r.\u0275\u0275listener("click",function(){return r.\u0275\u0275restoreView(e),r.\u0275\u0275nextContext(2).forget()}),r.\u0275\u0275element(3,"span",30),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd()}2&e&&(r.\u0275\u0275advance(3),r.\u0275\u0275property("translate","dw-login-forgetPassword"))}function z(e,t){1&e&&(r.\u0275\u0275elementStart(0,"div",33),r.\u0275\u0275element(1,"dw-language",34),r.\u0275\u0275elementEnd()),2&e&&(r.\u0275\u0275property("dwSpan",24),r.\u0275\u0275advance(1),r.\u0275\u0275property("template","dropdown"))}const G=function(e,t){return{en_US:e,zh_CN:t}};function W(e,t){if(1&e){const e=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementStart(0,"form",10),r.\u0275\u0275listener("ngSubmit",function(){return r.\u0275\u0275restoreView(e),r.\u0275\u0275nextContext().submitForm()}),r.\u0275\u0275elementStart(1,"dw-form-item",11),r.\u0275\u0275elementStart(2,"dw-input-group",12),r.\u0275\u0275element(3,"input",13),r.\u0275\u0275pipe(4,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275template(5,j,1,0,"ng-template",null,14,r.\u0275\u0275templateRefExtractor),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(7,"dw-form-item",15),r.\u0275\u0275elementStart(8,"dw-input-group",12),r.\u0275\u0275element(9,"input",16),r.\u0275\u0275pipe(10,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275template(11,_,1,0,"ng-template",null,17,r.\u0275\u0275templateRefExtractor),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(13,"dw-form-item",18),r.\u0275\u0275elementStart(14,"dw-form-control",19),r.\u0275\u0275elementStart(15,"div",20),r.\u0275\u0275elementStart(16,"div",21),r.\u0275\u0275template(17,U,2,1,"label",22),r.\u0275\u0275elementEnd(),r.\u0275\u0275template(18,B,4,1,"div",23),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(19,"dw-form-item",24),r.\u0275\u0275elementStart(20,"dw-form-control",19),r.\u0275\u0275template(21,z,2,2,"div",25),r.\u0275\u0275elementStart(22,"button",26),r.\u0275\u0275listener("click",function(){return r.\u0275\u0275restoreView(e),r.\u0275\u0275nextContext().login()}),r.\u0275\u0275text(23),r.\u0275\u0275pipe(24,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd()}if(2&e){const e=r.\u0275\u0275reference(6),t=r.\u0275\u0275reference(12),n=r.\u0275\u0275nextContext();r.\u0275\u0275property("formGroup",n.validateForm),r.\u0275\u0275advance(2),r.\u0275\u0275property("dwPrefix",e),r.\u0275\u0275advance(1),r.\u0275\u0275property("placeholder",r.\u0275\u0275pipeBind1(4,16,"dw-login-account"))("dwSize","large"),r.\u0275\u0275advance(5),r.\u0275\u0275property("dwPrefix",t),r.\u0275\u0275advance(1),r.\u0275\u0275property("type","password")("placeholder",r.\u0275\u0275pipeBind1(10,18,"dw-login-password"))("dwSize","large"),r.\u0275\u0275advance(4),r.\u0275\u0275property("ngClass",r.\u0275\u0275pureFunction2(22,G,"en_US"===n.language,"zh_CN"===n.language)),r.\u0275\u0275advance(4),r.\u0275\u0275property("ngIf",n.showRemember),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngIf",n.tabSelectedIndex!==n.loginTypeEnum.INTERNAL),r.\u0275\u0275advance(3),r.\u0275\u0275property("ngIf",n.showLanguage),r.\u0275\u0275advance(1),r.\u0275\u0275property("disabled",n.validateForm.invalid||n.isDisabled)("dwType","primary")("dwLoading",n.dwLoading),r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(24,20,"dw-login-signIn"))}}function H(e,t){1&e&&r.\u0275\u0275element(0,"i",27)}function q(e,t){1&e&&r.\u0275\u0275element(0,"i",27)}function Z(e,t){1&e&&r.\u0275\u0275element(0,"i",28)}function $(e,t){1&e&&(r.\u0275\u0275elementStart(0,"label",40),r.\u0275\u0275element(1,"span",30),r.\u0275\u0275elementEnd()),2&e&&(r.\u0275\u0275advance(1),r.\u0275\u0275property("translate","dw-login-rememberMe"))}function J(e,t){if(1&e){const e=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementStart(0,"div",31),r.\u0275\u0275elementStart(1,"label"),r.\u0275\u0275elementStart(2,"a",32),r.\u0275\u0275listener("click",function(){return r.\u0275\u0275restoreView(e),r.\u0275\u0275nextContext(2).forget()}),r.\u0275\u0275element(3,"span",30),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd()}2&e&&(r.\u0275\u0275advance(3),r.\u0275\u0275property("translate","dw-login-forgetPassword"))}function Q(e,t){1&e&&(r.\u0275\u0275elementStart(0,"div",33),r.\u0275\u0275element(1,"dw-language",34),r.\u0275\u0275elementEnd()),2&e&&(r.\u0275\u0275property("dwSpan",24),r.\u0275\u0275advance(1),r.\u0275\u0275property("template","dropdown"))}function Y(e,t){if(1&e){const e=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementStart(0,"form",10),r.\u0275\u0275listener("ngSubmit",function(){return r.\u0275\u0275restoreView(e),r.\u0275\u0275nextContext().submitForm()}),r.\u0275\u0275elementStart(1,"dw-form-item",35),r.\u0275\u0275elementStart(2,"dw-input-group",12),r.\u0275\u0275element(3,"input",36),r.\u0275\u0275pipe(4,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275template(5,H,1,0,"ng-template",null,14,r.\u0275\u0275templateRefExtractor),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(7,"dw-form-item",11),r.\u0275\u0275elementStart(8,"dw-input-group",12),r.\u0275\u0275element(9,"input",37),r.\u0275\u0275pipe(10,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275template(11,q,1,0,"ng-template",null,14,r.\u0275\u0275templateRefExtractor),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(13,"dw-form-item",15),r.\u0275\u0275elementStart(14,"dw-input-group",12),r.\u0275\u0275element(15,"input",38),r.\u0275\u0275pipe(16,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275template(17,Z,1,0,"ng-template",null,17,r.\u0275\u0275templateRefExtractor),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(19,"dw-form-item",18),r.\u0275\u0275elementStart(20,"dw-form-control",19),r.\u0275\u0275elementStart(21,"div",20),r.\u0275\u0275elementStart(22,"div",21),r.\u0275\u0275template(23,$,2,1,"label",39),r.\u0275\u0275elementEnd(),r.\u0275\u0275template(24,J,4,1,"div",23),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(25,"dw-form-item",24),r.\u0275\u0275elementStart(26,"dw-form-control",19),r.\u0275\u0275template(27,Q,2,2,"div",25),r.\u0275\u0275elementStart(28,"button",26),r.\u0275\u0275listener("click",function(){return r.\u0275\u0275restoreView(e),r.\u0275\u0275nextContext().login()}),r.\u0275\u0275text(29),r.\u0275\u0275pipe(30,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd()}if(2&e){const e=r.\u0275\u0275reference(6),t=r.\u0275\u0275reference(18),n=r.\u0275\u0275nextContext();r.\u0275\u0275property("formGroup",n.validateForm),r.\u0275\u0275advance(2),r.\u0275\u0275property("dwPrefix",e),r.\u0275\u0275advance(1),r.\u0275\u0275property("placeholder",r.\u0275\u0275pipeBind1(4,19,"dw-login-enterprise"))("dwSize","large"),r.\u0275\u0275advance(5),r.\u0275\u0275property("dwPrefix",e),r.\u0275\u0275advance(1),r.\u0275\u0275property("placeholder",r.\u0275\u0275pipeBind1(10,21,"dw-login-user"))("dwSize","large"),r.\u0275\u0275advance(5),r.\u0275\u0275property("dwPrefix",t),r.\u0275\u0275advance(1),r.\u0275\u0275property("type","password")("placeholder",r.\u0275\u0275pipeBind1(16,23,"dw-login-ep-password"))("dwSize","large"),r.\u0275\u0275advance(4),r.\u0275\u0275property("ngClass",r.\u0275\u0275pureFunction2(27,G,"en_US"===n.language,"zh_CN"===n.language)),r.\u0275\u0275advance(4),r.\u0275\u0275property("ngIf",n.showRemember),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngIf",n.tabSelectedIndex!==n.loginTypeEnum.INTERNAL),r.\u0275\u0275advance(3),r.\u0275\u0275property("ngIf",n.showLanguage),r.\u0275\u0275advance(1),r.\u0275\u0275property("disabled",n.validateForm.invalid||n.isDisabled)("dwType","primary")("dwLoading",n.dwLoading),r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(30,25,"dw-login-signIn"))}}function K(e,t){1&e&&r.\u0275\u0275element(0,"i",27)}function X(e,t){1&e&&r.\u0275\u0275element(0,"i",28)}function ee(e,t){1&e&&(r.\u0275\u0275elementStart(0,"label",29),r.\u0275\u0275element(1,"span",30),r.\u0275\u0275elementEnd()),2&e&&(r.\u0275\u0275advance(1),r.\u0275\u0275property("translate","dw-login-rememberMe"))}function te(e,t){if(1&e){const e=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementStart(0,"div",31),r.\u0275\u0275elementStart(1,"label"),r.\u0275\u0275elementStart(2,"a",32),r.\u0275\u0275listener("click",function(){return r.\u0275\u0275restoreView(e),r.\u0275\u0275nextContext(2).forget()}),r.\u0275\u0275element(3,"span",30),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd()}2&e&&(r.\u0275\u0275advance(3),r.\u0275\u0275property("translate","dw-login-forgetPassword"))}function ne(e,t){1&e&&(r.\u0275\u0275elementStart(0,"div",43),r.\u0275\u0275element(1,"dw-language",34),r.\u0275\u0275elementEnd()),2&e&&(r.\u0275\u0275property("dwSpan",8),r.\u0275\u0275advance(1),r.\u0275\u0275property("template","dropdown"))}function re(e,t){if(1&e){const e=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementStart(0,"form",41),r.\u0275\u0275listener("ngSubmit",function(){return r.\u0275\u0275restoreView(e),r.\u0275\u0275nextContext().submitForm()}),r.\u0275\u0275elementStart(1,"dw-form-item",11),r.\u0275\u0275elementStart(2,"dw-input-group",12),r.\u0275\u0275element(3,"input",13),r.\u0275\u0275pipe(4,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275template(5,K,1,0,"ng-template",null,14,r.\u0275\u0275templateRefExtractor),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(7,"dw-form-item",15),r.\u0275\u0275elementStart(8,"dw-input-group",12),r.\u0275\u0275element(9,"input",16),r.\u0275\u0275pipe(10,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275template(11,X,1,0,"ng-template",null,17,r.\u0275\u0275templateRefExtractor),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(13,"dw-form-item",18),r.\u0275\u0275elementStart(14,"dw-form-control",19),r.\u0275\u0275elementStart(15,"div",20),r.\u0275\u0275elementStart(16,"div",21),r.\u0275\u0275template(17,ee,2,1,"label",22),r.\u0275\u0275elementEnd(),r.\u0275\u0275template(18,te,4,1,"div",23),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(19,"dw-form-item",24),r.\u0275\u0275elementStart(20,"dw-form-control",19),r.\u0275\u0275elementStart(21,"button",26),r.\u0275\u0275listener("click",function(){return r.\u0275\u0275restoreView(e),r.\u0275\u0275nextContext().login()}),r.\u0275\u0275text(22),r.\u0275\u0275pipe(23,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275template(24,ne,2,2,"div",42),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd()}if(2&e){const e=r.\u0275\u0275reference(6),t=r.\u0275\u0275reference(12),n=r.\u0275\u0275nextContext();r.\u0275\u0275property("formGroup",n.validateForm),r.\u0275\u0275advance(2),r.\u0275\u0275property("dwPrefix",e),r.\u0275\u0275advance(1),r.\u0275\u0275property("placeholder",r.\u0275\u0275pipeBind1(4,16,"dw-login-account"))("dwSize","large"),r.\u0275\u0275advance(5),r.\u0275\u0275property("dwPrefix",t),r.\u0275\u0275advance(1),r.\u0275\u0275property("type","password")("placeholder",r.\u0275\u0275pipeBind1(10,18,"dw-login-password"))("dwSize","large"),r.\u0275\u0275advance(4),r.\u0275\u0275property("ngClass",r.\u0275\u0275pureFunction2(22,G,"en_US"===n.language,"zh_CN"===n.language)),r.\u0275\u0275advance(4),r.\u0275\u0275property("ngIf",n.showRemember),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngIf",n.dwMultiTenant),r.\u0275\u0275advance(3),r.\u0275\u0275property("disabled",n.validateForm.invalid||n.isDisabled)("dwType","primary")("dwLoading",n.dwLoading),r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(23,20,"dw-login-signIn")),r.\u0275\u0275advance(2),r.\u0275\u0275property("ngIf",n.showLanguage)}}function ie(e,t){if(1&e){const e=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementStart(0,"a",32),r.\u0275\u0275listener("click",function(){r.\u0275\u0275restoreView(e);const t=r.\u0275\u0275nextContext().$implicit;return r.\u0275\u0275nextContext(2).changeTenant(t.tenantSid)}),r.\u0275\u0275text(1),r.\u0275\u0275elementEnd()}if(2&e){const e=r.\u0275\u0275nextContext().$implicit;r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate(e.tenantName)}}function oe(e,t){if(1&e&&(r.\u0275\u0275element(0,"dw-list-item",46),r.\u0275\u0275template(1,ie,2,1,"ng-template",null,47,r.\u0275\u0275templateRefExtractor)),2&e){const e=r.\u0275\u0275reference(2);r.\u0275\u0275property("dwContent",e)}}function ae(e,t){if(1&e&&(r.\u0275\u0275elementStart(0,"dw-list",44),r.\u0275\u0275template(1,oe,3,1,"ng-template",null,45,r.\u0275\u0275templateRefExtractor),r.\u0275\u0275elementEnd()),2&e){const e=r.\u0275\u0275reference(2),t=r.\u0275\u0275nextContext();r.\u0275\u0275property("dwDataSource",t.currTenantList)("dwRenderItem",e)}}function le(e,t){if(1&e&&(r.\u0275\u0275elementStart(0,"div",7),r.\u0275\u0275text(1),r.\u0275\u0275elementEnd()),2&e){const e=r.\u0275\u0275nextContext();r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate(e.title)}}let se=(()=>{class e{constructor(e){this.localStorage=e}setRememberLogin(e,t=o.DwLoginTypeEnum.GENERAL){t===o.DwLoginTypeEnum.GENERAL&&(e.rememberLogin?(Object.keys(e).forEach(t=>{this.localStorage.set(t,e[t])}),this.localStorage.remove("dwRememberEnterpriseLoignInfo")):this._removeGeneralStorage()),t===o.DwLoginTypeEnum.INTERNAL&&e.hasOwnProperty("dwRememberEnterpriseLoignInfo")&&(e.dwRememberEnterpriseLoignInfo.rememberLogin?(this.localStorage.set("dwRememberEnterpriseLoignInfo",JSON.stringify(e.dwRememberEnterpriseLoignInfo)),this._removeGeneralStorage()):this.localStorage.remove("dwRememberEnterpriseLoignInfo"))}_removeGeneralStorage(){this.localStorage.remove("rememberLogin"),this.localStorage.remove("userId"),this.localStorage.remove("userName"),this.localStorage.remove("language")}getRememberLogin(){const e={rememberLogin:!1,userId:"",userName:"",language:"",dwRememberEnterpriseLoignInfo:{rememberLogin:!1,tenantId:"",userId:"",userName:"",language:""}};return JSON.parse(this.localStorage.get("rememberLogin"))&&(e.rememberLogin=!0),this.localStorage.get("userId")&&(e.userId=this.localStorage.get("userId")),this.localStorage.get("userName")&&(e.userName=this.localStorage.get("userName")),this.localStorage.get("language")&&(e.language=this.localStorage.get("language")),this.localStorage.get("dwRememberEnterpriseLoignInfo")&&(e.dwRememberEnterpriseLoignInfo=Object.assign(e.dwRememberEnterpriseLoignInfo,JSON.parse(this.localStorage.get("dwRememberEnterpriseLoignInfo")))),e}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275inject(i.LocalStorage))},e.\u0275prov=r.\u0275\u0275defineInjectable({factory:function(){return new e(r.\u0275\u0275inject(i.LocalStorage))},token:e,providedIn:"root"}),e})(),de=(()=>{class e{constructor(e,t,n,r,i,a,l,d,c,m,u,p,g,w,h,f,v){this.router=e,this.route=t,this.fBuilder=n,this.dwModalService=r,this.authService=i,this.userService=a,this.rememberLoginService=l,this.languageService=d,this.translateService=c,this.dwTenantService=m,this.dwProgramExecuteService=u,this.configService=p,this.dwMessageService=g,this.dwAppId=w,this.dwDeclarationService=h,this.dwChangePasswordInfoService=f,this.dwUpdatePasswordModalService=v,this.subscription=new s.Subscription,this.user={loginType:0,userId:"",password:"",identityType:"",tenantId:""},this.isDisabled=!1,this.dwLoading=!1,this._identityType="query",this._tenantId=null,this.showLoginTabSet=!1,this.currTenantList=[],this.isAutoForward=!1,this.tabs=["accountLogin","enterpriseUserLogin"],this.loginTypeEnum=o.DwLoginTypeEnum,this.tabSelectedIndex=o.DwLoginTypeEnum.GENERAL,this.configService.get("multiTenant").subscribe(e=>this.dwMultiTenant=e),this.configService.get("consoleUrl").subscribe(e=>this.consoleUrl=e)}set identityType(e){e&&(this._identityType=e)}set tenantId(e){e&&(this._tenantId=e)}submitForm(){for(const e in this.validateForm.controls)this.validateForm.controls.hasOwnProperty(e)&&this.validateForm.controls[e].markAsDirty()}login(){const e=this.tabSelectedIndex===this.loginTypeEnum.INTERNAL;this.user={loginType:this.tabSelectedIndex,tenantId:e?this.validateForm.controls.EPtenantId.value:this._tenantId,userId:e?this.validateForm.controls.EPuserId.value:this.validateForm.controls.userId.value,password:e?this.validateForm.controls.EPpassword.value:this.validateForm.controls.password.value,identityType:this._identityType},this.isDisabled=!0,this.dwLoading=!0,this.authService.login(this.user).subscribe(e=>{if(this.isDisabled=!1,this.dwLoading=!1,!1!==e.success)!0===e.success&&this.afterLogin();else{if(e.description)if(this.dwMultiTenant&&this.consoleUrl&&"@CONSOLE_URL@"!==this.consoleUrl&&e.description===this.translateService.instant("dw-login-failure-noTenant")){let e=this.translateService.instant("dw-login-failure-noTenant-console");e+=this.translateService.instant("dw-login-confirm-go-console"),this.dwMessageService.confirm({dwTitle:"",dwContent:e}).subscribe(e=>{e&&window.open(`${this.consoleUrl}/mang-enterprise/list`)})}else this.dwModalService.error({dwContent:e.description});this.authService.logout(!1)}},e=>{this.authService.logout(!1),e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&(this.dwModalService.error({dwContent:e.error.errorMessage}),e.error.hasOwnProperty("errorCode")&&"21018"===e.error.errorCode&&(this.tabSelectedIndex=this.loginTypeEnum.INTERNAL)),this.isDisabled=!1,this.dwLoading=!1})}afterLogin(){const e={rememberLogin:this.validateForm.get("remember").value,userId:this.userService.getUser("userId"),userName:this.userService.getUser("userName"),language:this.languageService.currentLanguage};this.tabSelectedIndex===this.loginTypeEnum.INTERNAL&&(e.dwRememberEnterpriseLoignInfo={tenantId:this.validateForm.controls.EPtenantId.value,userId:this.validateForm.controls.EPuserId.value,rememberLogin:this.validateForm.get("EPremember").value,userName:this.userService.getUser("userName"),language:this.languageService.currentLanguage}),this.rememberLoginService.setRememberLogin(e,this.tabSelectedIndex),this.loginedForwardUrl(this.returnUrl)}loginedForwardUrl(e){this.unsubscribe(),null!==e&&""!==e&&"/"!==e?this.router.navigateByUrl(e):this.dwProgramExecuteService.goHome()}ngOnDestroy(){this.unsubscribe()}ngAfterViewInit(){setTimeout(()=>{!0!==this.isAutoForward?(this.subscription.add(this.dwTenantService.currTenantList$.subscribe(e=>{e.length>1&&(this.currTenantList=e,this.tplModal=this.dwModalService.create({dwTitle:this.translateService.instant("dw-login-tenant-selectOne"),dwClosable:!1,dwFooter:null,dwContent:this.tenantModalTemp}))})),this.subscription.add(this.dwDeclarationService.openAgreeModal$.subscribe(e=>{this.tplAgreeModal&&this.tplAgreeModal.destroy(),this.tplAgreeModal=this.dwModalService.create({dwTitle:this.translateService.instant("dw-declaration-title"),dwClosable:!0,dwMaskClosable:!1,dwFooter:null,dwOnOk:()=>{this.dwDeclarationService.activeAgreeStatus()},dwOnCancel:()=>{this.dwDeclarationService.notActiveAgreeStatus()},dwContent:f.DwDeclarationModalComponent,dwComponentParams:{userInfo:e}})})),this.subscription.add(this.dwChangePasswordInfoService.openChangePasswordModal$.subscribe(e=>{this.tplchangePWModal=this.dwModalService.create({dwTitle:this.translateService.instant("dw-default-pw-change-title"),dwClosable:!1,dwMaskClosable:!1,dwFooter:null,dwOnOk:()=>{this.dwUpdatePasswordModalService.open({modalOnCancel:()=>{this.dwChangePasswordInfoService.notActiveChangedStatus()}}).subscribe(e=>{this.dwChangePasswordInfoService.activeChangedStatus()})},dwContent:v.DwChangeDefaultPasswordInfoComponent})}))):this.isAutoForward=!1})}tabsChanged(e){const t=this.validateForm.controls;e===this.loginTypeEnum.GENERAL&&(t.userId.setValidators([l.Validators.required]),t.password.setValidators([l.Validators.required]),t.EPtenantId.setValidators(null),t.EPuserId.setValidators(null),t.EPpassword.setValidators(null)),e===this.loginTypeEnum.INTERNAL&&(t.userId.setValidators(null),t.password.setValidators(null),t.EPtenantId.setValidators([l.Validators.required]),t.EPuserId.setValidators([l.Validators.required]),t.EPpassword.setValidators([l.Validators.required])),Object.keys(t).forEach(e=>{t[e].updateValueAndValidity()})}shouldSwitchToEnterpriseLoginTab(e){if(!this.showLoginTabSet||!this.dwMultiTenant)return;const t=e.dwRememberEnterpriseLoignInfo;if(t.tenantId){this.tabSelectedIndex=this.loginTypeEnum.INTERNAL,this.tabsChanged(this.tabSelectedIndex),this.validateForm.controls.EPtenantId.setValue(t.tenantId),this.validateForm.controls.EPuserId.setValue(t.userId),this.validateForm.controls.EPremember.setValue(t.rememberLogin);const e=t.language;e!==this.languageService.currentLanguage&&this.languageService.setUp(e)}}ngOnInit(){const e=this.rememberLoginService.getRememberLogin(),t=e.rememberLogin,n=e.userId;if(t){const t=e.language;t!==this.languageService.currentLanguage&&this.languageService.setUp(t)}if(this.returnUrl=this.route.snapshot.queryParamMap.get("returnUrl"),this.validateForm=this.fBuilder.group({tenantId:[null],userId:[n,[l.Validators.required]],password:[null,[l.Validators.required]],remember:[t],EPtenantId:[null],EPuserId:[null],EPpassword:[null],EPremember:[null]}),this.shouldSwitchToEnterpriseLoginTab(e),!0===this.authService.isLoggedIn)return this.isAutoForward=!0,void this.loginedForwardUrl(this.returnUrl)}forget(){this.router.navigateByUrl("/forget")}changeTenant(e){this.subscription.add(this.dwTenantService.tokenRefreshTenant(e).subscribe(()=>{this.tplModal.destroy(),this.afterLogin()},e=>{console.log("error>>>>>>>",e),this.tplModal.destroy(),this.authService.logout(!1),e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.dwModalService.error({dwContent:e.error.errorMessage})}))}unsubscribe(){this.subscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275directiveInject(a.Router),r.\u0275\u0275directiveInject(a.ActivatedRoute),r.\u0275\u0275directiveInject(l.FormBuilder),r.\u0275\u0275directiveInject(c.DwModalService),r.\u0275\u0275directiveInject(u.DwAuthService),r.\u0275\u0275directiveInject(p.DwUserService),r.\u0275\u0275directiveInject(se),r.\u0275\u0275directiveInject(g.DwLanguageService),r.\u0275\u0275directiveInject(d.TranslateService),r.\u0275\u0275directiveInject(p.DwTenantService),r.\u0275\u0275directiveInject(w.DwProgramExecuteService),r.\u0275\u0275directiveInject(m.DwSystemConfigService),r.\u0275\u0275directiveInject(h.DwHttpMessageService),r.\u0275\u0275directiveInject(m.DW_APP_ID),r.\u0275\u0275directiveInject(o.DwDeclarationService),r.\u0275\u0275directiveInject(o.DwChangePasswordInfoService),r.\u0275\u0275directiveInject(b.DwUpdatePasswordModalService))},e.\u0275cmp=r.\u0275\u0275defineComponent({type:e,selectors:[["dw-login-block"]],viewQuery:function(e,t){if(1&e&&r.\u0275\u0275viewQuery(k,7),2&e){let e;r.\u0275\u0275queryRefresh(e=r.\u0275\u0275loadQuery())&&(t.tenantModalTemp=e.first)}},inputs:{showLoginTabSet:"showLoginTabSet",identityType:"identityType",tenantId:"tenantId",showRemember:"showRemember",showLanguage:"showLanguage"},decls:9,vars:2,consts:[[4,"ngIf","ngIfElse"],["accountLoginTmp",""],["enterpriseUserLoginTemp",""],["defaultLoginTemp",""],["tenantModalTemp",""],[1,"dw-login-block-tab"],[3,"dwTabPosition","dwType","dwSelectedIndex","dwSelectedIndexChange"],[3,"dwTitle",4,"ngFor","ngForOf"],[3,"dwTitle"],[4,"ngTemplateOutlet"],["dw-form","",1,"login-form","multi",3,"formGroup","ngSubmit"],[1,"login-username"],[3,"dwPrefix"],["dw-input","","formControlName","userId",3,"placeholder","dwSize"],["prefixTemplateUserId",""],[1,"login-password"],["dw-input","","formControlName","password","autocomplete","on",3,"type","placeholder","dwSize"],["prefixTemplatePassword",""],[1,"login-remember",3,"ngClass"],["dwSpan","24"],["dw-row",""],["dw-col","","dwSpan","12",1,"dw-f-remeber-block"],["dw-checkbox","","formControlName","remember",4,"ngIf"],["dw-col","","dwSpan","12","class","dw-f-forgerpassword",4,"ngIf"],[1,"login-btn"],["class","login-form-forgot","dw-col","",3,"dwSpan",4,"ngIf"],["type","submit","dw-button","",1,"login-form-button",3,"disabled","dwType","dwLoading","click"],["dw-icon","","dwType","user"],["dw-icon","","dwType","lock"],["dw-checkbox","","formControlName","remember"],[3,"translate"],["dw-col","","dwSpan","12",1,"dw-f-forgerpassword"],[3,"click"],["dw-col","",1,"login-form-forgot",3,"dwSpan"],[3,"template"],[1,"login-enterprise"],["dw-input","","formControlName","EPtenantId",3,"placeholder","dwSize"],["dw-input","","formControlName","EPuserId",3,"placeholder","dwSize"],["dw-input","","formControlName","EPpassword","autocomplete","on",3,"type","placeholder","dwSize"],["dw-checkbox","","formControlName","EPremember",4,"ngIf"],["dw-checkbox","","formControlName","EPremember"],["dw-form","",1,"login-form","single",3,"formGroup","ngSubmit"],["class","login-form-forgot login-form-language","dw-col","",3,"dwSpan",4,"ngIf"],["dw-col","",1,"login-form-forgot","login-form-language",3,"dwSpan"],["dwBordered","","dwSize","large",3,"dwDataSource","dwRenderItem"],["listTemp",""],[3,"dwContent"],["contentTemp",""]],template:function(e,t){if(1&e&&(r.\u0275\u0275template(0,V,4,4,"ng-container",0),r.\u0275\u0275template(1,W,25,25,"ng-template",null,1,r.\u0275\u0275templateRefExtractor),r.\u0275\u0275template(3,Y,31,30,"ng-template",null,2,r.\u0275\u0275templateRefExtractor),r.\u0275\u0275template(5,re,25,25,"ng-template",null,3,r.\u0275\u0275templateRefExtractor),r.\u0275\u0275template(7,ae,3,2,"ng-template",null,4,r.\u0275\u0275templateRefExtractor)),2&e){const e=r.\u0275\u0275reference(6);r.\u0275\u0275property("ngIf",t.dwMultiTenant&&t.showLoginTabSet)("ngIfElse",e)}},directives:[E.NgIf,M.DwTabSetComponent,E.NgForOf,M.DwTabComponent,E.NgTemplateOutlet,l.\u0275NgNoValidate,l.NgControlStatusGroup,T.DwFormDirective,l.FormGroupDirective,N.DwRowDirective,T.DwFormItemComponent,x.DwInputGroupComponent,R.u,x.DwInputGroupWhitSuffixOrPrefixDirective,x.DwInputDirective,l.DefaultValueAccessor,l.NgControlStatus,l.FormControlName,E.NgClass,N.DwColDirective,T.DwFormControlComponent,y.DwButtonComponent,F.uG,I.DwIconDirective,D.DwCheckboxComponent,d.TranslateDirective,P.DwLanguageComponent,L.DwListComponent,L.DwListItemComponent],pipes:[d.TranslatePipe],styles:[""]}),e})(),ce=(()=>{class e{constructor(e,t){this._sanitizer=e,this.modalSubject=t}set description(e){this._description=this._sanitizer.bypassSecurityTrustHtml(e)}get description(){return this._description}close(){this.modalSubject.destroy(!0)}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275directiveInject(S.DomSanitizer),r.\u0275\u0275directiveInject(c.DwModalRef))},e.\u0275cmp=r.\u0275\u0275defineComponent({type:e,selectors:[["dw-login-block-modal"]],inputs:{description:"description",title:"title",btnTitle:"btnTitle"},decls:9,vars:5,consts:[[1,"moadl-body"],["dw-icon","","dwType","exclamation-circle",1,"warning",3,"dwTheme","dwTwotoneColor"],[1,"content"],["class","title",4,"ngIf"],[1,"description",3,"innerHtml"],[1,"btns"],["dw-button","","dwType","primary",3,"click"],[1,"title"]],template:function(e,t){1&e&&(r.\u0275\u0275elementStart(0,"div"),r.\u0275\u0275elementStart(1,"div",0),r.\u0275\u0275element(2,"i",1),r.\u0275\u0275elementStart(3,"div",2),r.\u0275\u0275template(4,le,2,1,"div",3),r.\u0275\u0275element(5,"div",4),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(6,"div",5),r.\u0275\u0275elementStart(7,"button",6),r.\u0275\u0275listener("click",function(){return t.close()}),r.\u0275\u0275text(8),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd()),2&e&&(r.\u0275\u0275advance(2),r.\u0275\u0275property("dwTheme","twotone")("dwTwotoneColor","#faad14"),r.\u0275\u0275advance(2),r.\u0275\u0275property("ngIf",t.title),r.\u0275\u0275advance(1),r.\u0275\u0275property("innerHtml",t.description,r.\u0275\u0275sanitizeHtml),r.\u0275\u0275advance(3),r.\u0275\u0275textInterpolate(t.btnTitle))},directives:[I.DwIconDirective,R.u,E.NgIf,y.DwButtonComponent,F.uG],styles:[".moadl-body[_ngcontent-%COMP%] > .anticon[_ngcontent-%COMP%]{font-size:22px;float:left}.warning[_ngcontent-%COMP%]{color:#faad14}.content[_ngcontent-%COMP%]{margin-left:30px;text-align:left}.content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#000000d9;font-weight:500;font-size:16px;line-height:1.4}.btns[_ngcontent-%COMP%]{margin-top:24px;text-align:right}"]}),e})(),me=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=r.\u0275\u0275defineInjector({providers:[],imports:[[E.CommonModule,d.TranslateModule,I.DwIconModule,y.DwButtonModule]]}),e})(),ue=(()=>{class e{constructor(e){this.dwModalService=e}showWarning(e){let t={description:"",btnTitle:"",width:"400",closable:!1,maskClosable:!1};return t=Object.assign(t,e),this._postModal=this.dwModalService.create({dwContent:ce,dwWidth:t.width,dwFooter:null,dwClosable:t.closable,dwMaskClosable:t.maskClosable,dwComponentParams:{description:t.description,btnTitle:t.btnTitle}}),s.Observable.create(e=>{this._postModal.afterClose.subscribe(t=>{t&&e.next(!0),e.complete()})})}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275inject(c.DwModalService))},e.\u0275prov=r.\u0275\u0275defineInjectable({factory:function(){return new e(r.\u0275\u0275inject(c.DwModalService))},token:e,providedIn:"root"}),e})(),pe=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=r.\u0275\u0275defineInjector({providers:[],imports:[[E.CommonModule,l.FormsModule,l.ReactiveFormsModule,C.DwSelectModule,T.DwFormModule,x.DwInputModule,L.DwListModule,y.DwButtonModule,N.DwGridModule,D.DwCheckboxModule,I.DwIconModule,M.DwTabsModule,P.DwLanguageModule,v.DwChangeDefaultPasswordInfoModule,f.DwDeclarationModalModule]]}),e})()},8852:function(e,t,n){n.d(t,{u:function(){return o},f:function(){return a}});var r=n(36535),i=n(42746);let o=(()=>{class e{constructor(e,t){this.elementRef=e,this.renderer=t,this.hidden=null,this.renderer.setAttribute(this.elementRef.nativeElement,"hidden","")}setHiddenAttribute(){this.hidden?this.renderer.setAttribute(this.elementRef.nativeElement,"hidden","string"==typeof this.hidden?this.hidden:""):this.renderer.removeAttribute(this.elementRef.nativeElement,"hidden")}ngOnChanges(){this.setHiddenAttribute()}ngAfterViewInit(){this.setHiddenAttribute()}}return e.\u0275fac=function(t){return new(t||e)(i.\u0275\u0275directiveInject(i.ElementRef),i.\u0275\u0275directiveInject(i.Renderer2))},e.\u0275dir=i.\u0275\u0275defineDirective({type:e,selectors:[["","dw-button",""],["dw-button-group"],["","dw-icon",""],["","dw-menu-item",""],["","dw-submenu",""],["dw-select-top-control"],["dw-select-placeholder"],["dw-input-group"]],inputs:{hidden:"hidden"},features:[i.\u0275\u0275NgOnChangesFeature]}),e})(),a=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=i.\u0275\u0275defineInjector({imports:[[r.PlatformModule]]}),e})()},96670:function(e,t,n){n.d(t,{uG:function(){return d},ln:function(){return c}});var r=n(36535),i=n(42746),o=n(88065);class a{constructor(e,t,n,i){this.triggerElement=e,this.ngZone=t,this.insertExtraNode=n,this.platformId=i,this.waveTransitionDuration=400,this.styleForPseudo=null,this.extraNode=null,this.lastTime=0,this.onClick=e=>{!this.triggerElement||!this.triggerElement.getAttribute||this.triggerElement.getAttribute("disabled")||"INPUT"===e.target.tagName||this.triggerElement.className.indexOf("disabled")>=0||this.fadeOutWave()},this.platform=new r.Platform(this.platformId),this.clickHandler=this.onClick.bind(this),this.bindTriggerEvent()}get waveAttributeName(){return this.insertExtraNode?"ant-click-animating":"ant-click-animating-without-extra-node"}bindTriggerEvent(){this.platform.isBrowser&&this.ngZone.runOutsideAngular(()=>{this.removeTriggerEvent(),this.triggerElement&&this.triggerElement.addEventListener("click",this.clickHandler,!0)})}removeTriggerEvent(){this.triggerElement&&this.triggerElement.removeEventListener("click",this.clickHandler,!0)}removeStyleAndExtraNode(){this.styleForPseudo&&document.body.contains(this.styleForPseudo)&&(document.body.removeChild(this.styleForPseudo),this.styleForPseudo=null),this.insertExtraNode&&this.triggerElement.contains(this.extraNode)&&this.triggerElement.removeChild(this.extraNode)}destroy(){this.removeTriggerEvent(),this.removeStyleAndExtraNode()}fadeOutWave(){const e=this.triggerElement,t=this.getWaveColor(e);e.setAttribute(this.waveAttributeName,"true"),!(Date.now()<this.lastTime+this.waveTransitionDuration)&&(this.isValidColor(t)&&(this.styleForPseudo||(this.styleForPseudo=document.createElement("style")),this.styleForPseudo.innerHTML=`\n      [ant-click-animating-without-extra-node='true']::after, .ant-click-animating-node {\n        --antd-wave-shadow-color: ${t};\n      }`,document.body.appendChild(this.styleForPseudo)),this.insertExtraNode&&(this.extraNode||(this.extraNode=document.createElement("div")),this.extraNode.className="ant-click-animating-node",e.appendChild(this.extraNode)),this.lastTime=Date.now(),this.runTimeoutOutsideZone(()=>{e.removeAttribute(this.waveAttributeName),this.removeStyleAndExtraNode()},this.waveTransitionDuration))}isValidColor(e){return!!e&&"#ffffff"!==e&&"rgb(255, 255, 255)"!==e&&this.isNotGrey(e)&&!/rgba\(\d*, \d*, \d*, 0\)/.test(e)&&"transparent"!==e}isNotGrey(e){const t=e.match(/rgba?\((\d*), (\d*), (\d*)(, [\.\d]*)?\)/);return!(t&&t[1]&&t[2]&&t[3]&&t[1]===t[2]&&t[2]===t[3])}getWaveColor(e){const t=getComputedStyle(e);return t.getPropertyValue("border-top-color")||t.getPropertyValue("border-color")||t.getPropertyValue("background-color")}runTimeoutOutsideZone(e,t){this.ngZone.runOutsideAngular(()=>setTimeout(e,t))}}const l={disabled:!1},s=new i.InjectionToken("dw-wave-global-options",{providedIn:"root",factory:function(){return l}});let d=(()=>{class e{constructor(e,t,n,r,i){this.ngZone=e,this.elementRef=t,this.config=n,this.animationType=r,this.platformId=i,this.dwWaveExtraNode=!1,this.waveDisabled=!1,this.waveDisabled=this.isConfigDisabled()}get disabled(){return this.waveDisabled}get rendererRef(){return this.waveRenderer}isConfigDisabled(){let e=!1;return this.config&&"boolean"==typeof this.config.disabled&&(e=this.config.disabled),"NoopAnimations"===this.animationType&&(e=!0),e}ngOnDestroy(){this.waveRenderer&&this.waveRenderer.destroy()}ngOnInit(){this.renderWaveIfEnabled()}renderWaveIfEnabled(){!this.waveDisabled&&this.elementRef.nativeElement&&(this.waveRenderer=new a(this.elementRef.nativeElement,this.ngZone,this.dwWaveExtraNode,this.platformId))}disable(){this.waveDisabled=!0,this.waveRenderer&&(this.waveRenderer.removeTriggerEvent(),this.waveRenderer.removeStyleAndExtraNode())}enable(){this.waveDisabled=this.isConfigDisabled()||!1,this.waveRenderer&&this.waveRenderer.bindTriggerEvent()}}return e.\u0275fac=function(t){return new(t||e)(i.\u0275\u0275directiveInject(i.NgZone),i.\u0275\u0275directiveInject(i.ElementRef),i.\u0275\u0275directiveInject(s,8),i.\u0275\u0275directiveInject(o.ANIMATION_MODULE_TYPE,8),i.\u0275\u0275directiveInject(i.PLATFORM_ID))},e.\u0275dir=i.\u0275\u0275defineDirective({type:e,selectors:[["","dw-wave",""],["button","dw-button","",3,"dwType","link",3,"dwType","text"]],inputs:{dwWaveExtraNode:"dwWaveExtraNode"},exportAs:["dwWave"]}),e})(),c=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=i.\u0275\u0275defineInjector({imports:[[r.PlatformModule]]}),e})()}}]);