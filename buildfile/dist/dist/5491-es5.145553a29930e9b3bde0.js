!function(){"use strict";function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkassc_crs=self.webpackChunkassc_crs||[]).push([[5491,1414],{35491:function(t,r,i){i.r(r),i.d(r,{DwRoutingTabSetComponent:function(){return U},DwRoutingTabSetModule:function(){return F},TAB_STORED_KEY:function(){return B}});var a=i(55245),c=i(42746),l=i(87974),u=i(71049),s=i(47372),d=i(30469),f=i(66800),m=i(32276),p=i(83174),v=i(29853),b=i(61699),I=i(28396),h=i(1020),y=i(83522),g=i(78169),w=i(85277),S=i(43542),T=i(96677);function C(e,t){if(1&e){var n=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"i",11),c.\u0275\u0275listener("click",function(e){c.\u0275\u0275restoreView(n);var t=c.\u0275\u0275nextContext(2).index;return c.\u0275\u0275nextContext(2).closeTab(t,e)}),c.\u0275\u0275pipe(1,"translate"),c.\u0275\u0275elementEnd()}2&e&&c.\u0275\u0275propertyInterpolate("title",c.\u0275\u0275pipeBind1(1,1,"dw-tab-close"))}function x(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"div"),c.\u0275\u0275element(1,"dw-icon-element",8),c.\u0275\u0275element(2,"dw-program-title",9),c.\u0275\u0275template(3,C,2,3,"i",10),c.\u0275\u0275elementEnd()),2&e){var n=c.\u0275\u0275nextContext().$implicit;c.\u0275\u0275advance(1),c.\u0275\u0275property("dwIconClass",n.iconClass),c.\u0275\u0275advance(1),c.\u0275\u0275property("titleKey",n.title)("programId",n.code?n.code:n.id),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",n.canClose||!1!==n.canClose)}}function k(e,t){if(1&e){var n=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementContainerStart(0),c.\u0275\u0275elementStart(1,"dw-tab",6),c.\u0275\u0275listener("dwClick",function(){var e=c.\u0275\u0275restoreView(n).index;return c.\u0275\u0275nextContext(2).tabClick(e)})("dwSelect",function(){var e=c.\u0275\u0275restoreView(n).$implicit;return c.\u0275\u0275nextContext(2).tabSelected(e)}),c.\u0275\u0275template(2,x,4,4,"ng-template",null,7,c.\u0275\u0275templateRefExtractor),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementContainerEnd()}if(2&e){var r=c.\u0275\u0275reference(3);c.\u0275\u0275advance(1),c.\u0275\u0275property("dwTitle",r)}}function E(e,t){1&e&&c.\u0275\u0275element(0,"router-outlet")}function D(e,t){if(1&e&&c.\u0275\u0275element(0,"dw-base-iframe",14),2&e){var n=c.\u0275\u0275nextContext(2).$implicit,r=c.\u0275\u0275nextContext(2);c.\u0275\u0275styleProp("display",(null==n?null:n.tabId)===(null==r.currentTabInfo?null:r.currentTabInfo.tabId)?"block":"none"),c.\u0275\u0275property("item",n.item)}}function R(e,t){if(1&e&&c.\u0275\u0275element(0,"dw-base-iframe",14),2&e){var n=c.\u0275\u0275nextContext(2).$implicit;c.\u0275\u0275property("item",n.item)}}function O(e,t){if(1&e&&(c.\u0275\u0275elementContainerStart(0),c.\u0275\u0275template(1,D,1,3,"dw-base-iframe",12),c.\u0275\u0275template(2,R,1,1,"dw-base-iframe",13),c.\u0275\u0275elementContainerEnd()),2&e){var n=c.\u0275\u0275nextContext().$implicit,r=c.\u0275\u0275nextContext(2);c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",void 0===(null==n?null:n.reload)||!1===(null==n?null:n.reload)),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",void 0!==(null==n?null:n.reload)&&!0===(null==n?null:n.reload)&&(null==n?null:n.tabId)===(null==r.currentTabInfo?null:r.currentTabInfo.tabId))}}function A(e,t){if(1&e&&(c.\u0275\u0275elementContainerStart(0),c.\u0275\u0275template(1,O,3,2,"ng-container",0),c.\u0275\u0275elementContainerEnd()),2&e){var n=t.$implicit;c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",n&&("fineReport"===(null==n?null:n.type)||"externalUrl"===(null==n?null:n.type)))}}function j(e,t){if(1&e&&(c.\u0275\u0275elementContainerStart(0),c.\u0275\u0275elementStart(1,"div"),c.\u0275\u0275elementStart(2,"dw-tabset",2),c.\u0275\u0275template(3,k,4,1,"ng-container",3),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(4,"div",4),c.\u0275\u0275elementStart(5,"div",5),c.\u0275\u0275template(6,E,1,0,"router-outlet",0),c.\u0275\u0275template(7,A,2,1,"ng-container",3),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementContainerEnd()),2&e){var n=c.\u0275\u0275nextContext(),r=c.\u0275\u0275reference(2);c.\u0275\u0275advance(2),c.\u0275\u0275property("dwType","card")("dwSelectedIndex",n.selectedIndex)("dwTabBarExtraContent",r),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngForOf",n.routeInfos)("ngForTrackBy",n.trackByTabId),c.\u0275\u0275advance(3),c.\u0275\u0275property("ngIf",n.routeInfos.length>0),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngForOf",n.routeInfos)("ngForTrackBy",n.trackByTabId)}}function P(e,t){if(1&e){var n=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"i",15),c.\u0275\u0275listener("click",function(){return c.\u0275\u0275restoreView(n),c.\u0275\u0275nextContext().closeAll()}),c.\u0275\u0275pipe(1,"translate"),c.\u0275\u0275elementEnd()}2&e&&c.\u0275\u0275propertyInterpolate("title",c.\u0275\u0275pipeBind1(1,1,"dw-tab-close-all"))}var M,B="TAB_STORED_KEY",U=((M=function(){function t(e,r,o,i,a,c,s,d,f,m,p,v){var b=this;n(this,t),this.routeInfoService=e,this.multiOpen=r,this.recursiveMenuService=o,this.router=i,this.tabRouting=a,this.storageService=s,this.doc=d,this.zone=f,this.subscription=new u.Subscription,this.oldIframe=[];var I=null;this.messageHub=v.getHubInstance(),this.differ=c.find(this.routeInfos).create(this.trackByTabId),this.subscription.add(this.routeInfoService.tabSetIndexChanged.subscribe(function(e){setTimeout(function(){b.selectedIndex=e,b.currentTabInfo=b.routeInfoService.getTabState(b.selectedIndex),b.isStarted=!0,b.currentTabInfo&&b.recursiveMenuService.onSelect(b.currentTabInfo.menuId,b.currentTabInfo.id)})})),this.subscription.add(this.router.events.subscribe(function(e){if(e instanceof l.ActivationStart&&null===I&&e.snapshot.component&&(I=e.snapshot.component),e instanceof l.ActivationEnd&&null===I&&e.snapshot.component&&(I=e.snapshot.component),e instanceof l.NavigationStart&&(b.routeInfoService.tabSetStateArray[b.routeInfoService.previousIndex].scrollTop=b.outletDiv.scrollTop),e instanceof l.NavigationEnd){b.storeTabs(),b.outletDiv.scrollTop=b.routeInfoService.tabSetStateArray[b.routeInfoService.currentIndex].scrollTop||0;var t=b.routeInfoService.tabChangeState;if(t){var n=b.clearParams(e.url);b.routeInfoService.tabRouterChanged.next({currentId:t.currentTabId,previousId:t.previousTabId,currentRouterLink:n,componentType:I,tabChanged:t.tabChanged})}else b.routeInfoService.tabRouterChanged.next(null);I=null}})),this.subscription.add(m.isLoggedIn$.subscribe(function(e){e||b.clearStoredTabs()})),this.subscription.add(p.isTokenValid$.subscribe(function(e){e||b.clearStoredTabs()}))}return o(t,[{key:"hidden",get:function(){return 0===this.routeInfos.length}},{key:"clearParams",value:function(e){var t=new l.DefaultUrlSerializer,n=t.parse(e);return this.clearUrlSegmentGroupParams(n.root),n.queryParams={},t.serialize(n)}},{key:"clearUrlSegmentGroupParams",value:function(e){var t=this;e.segments.forEach(function(e){e.parameters={}}),e.hasChildren()&&Object.keys(e.children).forEach(function(n){t.clearUrlSegmentGroupParams(e.children[n])})}},{key:"routeInfos",get:function(){return this.routeInfoService.tabSetStateArray}},{key:"ngOnInit",value:function(){this.routeInfoService.createFirstRouteFromCurrentRoute(this.getStoredTabs())}},{key:"ngAfterViewInit",value:function(){var e=this,t=this.doc.querySelector(".for-tab-query-class");this.outletDiv=t||this.doc.documentElement||this.doc.body,this.iframes.changes.subscribe(function(t){e._handleReceives(t)}),this.iframes.length>0&&this._handleReceives(this.iframes)}},{key:"_handleReceives",value:function(t){var n=this,r=t.toArray(),o=r.filter(function(e){return-1===n.oldIframe.indexOf(e)}),i=this.oldIframe.filter(function(e){return-1===r.indexOf(e)});o.forEach(function(e){if(e.iframe&&e.iframe.nativeElement){var t=new URL(e.iframe.nativeElement.src);n.messageHub.addReceiver(e.iframe.nativeElement.contentWindow,"".concat(t.protocol,"//").concat(t.host))}else e.iframes.changes.pipe((0,s.first)()).subscribe(function(e){var t=new URL(e.first.nativeElement.src);n.messageHub.addReceiver(e.first.nativeElement.contentWindow,"".concat(t.protocol,"//").concat(t.host))})}),i.forEach(function(e){e.iframe&&n.messageHub.removeReceiver(e.iframe.nativeElement.contentWindow)}),this.oldIframe=e(r)}},{key:"closeTab",value:function(e,t){return this.routeInfoService.close(e),t.preventDefault(),t.stopPropagation(),!1}},{key:"tabClick",value:function(e){this.routeInfoService.setCurrentIndex(e),this.selectedIndex=e}},{key:"showKeys",value:function(){console.log(this.routeInfos)}},{key:"ngDoCheck",value:function(){var e=this,t=this.differ.diff(this.routeInfos);t&&(t.forEachAddedItem(function(t){e.tabRouting.eventSubject.next(new v.DwTabOpen(t.item.tabId,t.item.currentUrl,t.item.id,t.item.module,t.item.type))}),t.forEachRemovedItem(function(t){e.tabRouting.eventSubject.next(new v.DwTabClose(t.item.tabId,t.item.currentUrl,t.item.id,t.item.module,t.item.type))}),this.storeTabs())}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe(),this.routeInfoService.destroy()}},{key:"closeAll",value:function(){this.routeInfoService.closeAll()}},{key:"trackByTabId",value:function(e,t){return t.tabId}},{key:"tabSelected",value:function(e){var t=this.routeInfoService.tabSetStateArray[this.routeInfoService.previousIndex];this.tabRouting.eventSubject.next(new v.DwTabFocusout(t.tabId,t.currentUrl,t.id,t.module,t.type)),this.tabRouting.eventSubject.next(new v.DwTabFocusin(e.tabId,e.currentUrl,e.id,e.module,e.type))}},{key:"getStoredTabs",value:function(){var e=this.storageService.get(B);return e?JSON.parse(e):null}},{key:"clearStoredTabs",value:function(){this.storageService.remove(B)}},{key:"storeTabs",value:function(){var e=this;if(this.isStarted){var t={tabs:[],currentIndex:this.selectedIndex};this.routeInfoService.tabSetStateArray.forEach(function(e,n){t.tabs.push({id:e.id,tabId:e.tabId,opener:e.opener,lastPath:e.lastPath,menuId:e.menuId,title:e.title,queryParams:e.queryParams,routerLink:e.routerLink,type:e.type,currentUrl:e.currentUrl,defaultOpen:!0,scrollTop:e.scrollTop,canClose:e.canClose,iconClass:e.iconClass})}),this.zone.runOutsideAngular(function(){setTimeout(function(){return e.storageService.set(B,JSON.stringify(t))})})}}}]),t}()).\u0275fac=function(e){return new(e||M)(c.\u0275\u0275directiveInject(v.DwTabInfoService2),c.\u0275\u0275directiveInject(d.DW_TAB_MULTI_OPEN),c.\u0275\u0275directiveInject(I.DwRecursiveMenuService),c.\u0275\u0275directiveInject(l.Router),c.\u0275\u0275directiveInject(v.DwTabRoutingService),c.\u0275\u0275directiveInject(c.IterableDiffers),c.\u0275\u0275directiveInject(v.DwTabInfoStorageService),c.\u0275\u0275directiveInject(a.DOCUMENT),c.\u0275\u0275directiveInject(c.NgZone),c.\u0275\u0275directiveInject(m.DwAuthService),c.\u0275\u0275directiveInject(f.DwTenantService),c.\u0275\u0275directiveInject(p.DwPostMessageFactoryService))},M.\u0275cmp=c.\u0275\u0275defineComponent({type:M,selectors:[["dw-routing-tabset"]],viewQuery:function(e,t){var n;1&e&&c.\u0275\u0275viewQuery(b.DwBaseIframeComponent,5),2&e&&c.\u0275\u0275queryRefresh(n=c.\u0275\u0275loadQuery())&&(t.iframes=n)},hostVars:1,hostBindings:function(e,t){2&e&&c.\u0275\u0275hostProperty("hidden",t.hidden)},decls:3,vars:1,consts:[[4,"ngIf"],["tabBarExtraContent",""],[1,"dw-f-tabset-bar",3,"dwType","dwSelectedIndex","dwTabBarExtraContent"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"dw-f-layout-content"],[1,"dw-f-tab-info-wp"],[3,"dwTitle","dwClick","dwSelect"],["titleTemplate",""],[3,"dwIconClass"],[3,"titleKey","programId"],["dw-icon","","dwType","close","class","tab-close",3,"title","click",4,"ngIf"],["dw-icon","","dwType","close",1,"tab-close",3,"title","click"],[3,"item","display",4,"ngIf"],[3,"item",4,"ngIf"],[3,"item"],["dw-icon","","dwType","",1,"closeall",3,"title","click"]],template:function(e,t){1&e&&(c.\u0275\u0275template(0,j,8,8,"ng-container",0),c.\u0275\u0275template(1,P,2,3,"ng-template",null,1,c.\u0275\u0275templateRefExtractor)),2&e&&c.\u0275\u0275property("ngIf",t.routeInfos.length>0)},directives:[a.NgIf,g.DwTabSetComponent,a.NgForOf,g.DwTabComponent,S.DwIconElementComponent,T.DwProgramTitleComponent,w.DwIconDirective,l.RouterOutlet,b.DwBaseIframeComponent],pipes:[y.TranslatePipe],styles:[".error[_ngcontent-%COMP%]{color:red}.tab-close[_ngcontent-%COMP%]{margin-left:8px;margin-right:0}.closeall[_ngcontent-%COMP%]{cursor:pointer;content:url(/assets/dw-framework/img/closeall.svg);width:14px}"]}),M),F=function(){var e=o(function e(){n(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=c.\u0275\u0275defineInjector({imports:[[a.CommonModule,l.RouterModule,g.DwTabsModule,w.DwIconModule,h.FormsModule,S.DwIconElementModule,T.DwProgramTitleModule,h.ReactiveFormsModule,b.DwBaseIframeModule,y.TranslateModule]]}),e}()}}])}();