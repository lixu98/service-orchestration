"use strict";(self.webpackChunkassc_crs=self.webpackChunkassc_crs||[]).push([[6996,5953],{66996:function(e,t,n){n.r(t),n.d(t,{DwAccountInfoComponent:function(){return Z},DwAccountInfoModule:function(){return z}});var r=n(42746),o=n(55245),a=n(1020),i=n(83522),s=n(67733),d=n(85773),l=n(80677),c=n(67280),p=n(35626),m=n(82542),u=n(93761),h=n(29872),f=n(74591),w=n(71049),g=n(47372),v=n(31441),S=n(12146),I=n(44720),b=n(30469),C=n(21656),y=n(96670),x=n(8852);function E(e,t){1&e&&r.\u0275\u0275element(0,"img",17)}const O=function(){return{showPreviewIcon:!1,showRemoveIcon:!0}};function P(e,t){if(1&e){const e=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementStart(0,"dw-upload",18),r.\u0275\u0275listener("dwFileListChange",function(t){return r.\u0275\u0275restoreView(e),r.\u0275\u0275nextContext(2).headImage=t}),r.\u0275\u0275elementStart(1,"p",19),r.\u0275\u0275element(2,"i",20),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(3,"p",21),r.\u0275\u0275text(4),r.\u0275\u0275pipe(5,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd()}if(2&e){const e=r.\u0275\u0275nextContext(2);r.\u0275\u0275property("dwBeforeUpload",e.beforeLogoUpload)("dwRemove",e.remove)("dwShowUploadList",r.\u0275\u0275pureFunction0(9,O))("dwFileList",e.headImage)("dwShowButton",e.headImage.length<1)("dwMultiple",!1),r.\u0275\u0275advance(4),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(5,7,"dw-account-info-upload"))}}function D(e,t){if(1&e){const e=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementStart(0,"div",22),r.\u0275\u0275elementStart(1,"button",23),r.\u0275\u0275listener("click",function(){return r.\u0275\u0275restoreView(e),r.\u0275\u0275nextContext(2).updatePassword()}),r.\u0275\u0275elementStart(2,"span",16),r.\u0275\u0275text(3),r.\u0275\u0275pipe(4,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd()}2&e&&(r.\u0275\u0275advance(1),r.\u0275\u0275property("dwType","primary"),r.\u0275\u0275advance(2),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(4,2,"dw-account-info-updatePassword")))}function M(e,t){if(1&e&&(r.\u0275\u0275elementContainerStart(0),r.\u0275\u0275elementStart(1,"dw-form-item"),r.\u0275\u0275elementStart(2,"dw-form-control",27),r.\u0275\u0275elementStart(3,"label",28),r.\u0275\u0275text(4),r.\u0275\u0275pipe(5,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementContainerEnd()),2&e){const e=r.\u0275\u0275nextContext().$implicit;r.\u0275\u0275advance(2),r.\u0275\u0275property("dwSpan",e.grid.inputSpan)("dwOffset",e.grid.labelSpan),r.\u0275\u0275advance(1),r.\u0275\u0275property("formControlName",e.name),r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(5,4,e.label))}}function F(e,t){if(1&e&&(r.\u0275\u0275elementContainerStart(0),r.\u0275\u0275elementStart(1,"dw-form-item"),r.\u0275\u0275elementStart(2,"dw-form-label",29),r.\u0275\u0275text(3),r.\u0275\u0275pipe(4,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(5,"dw-form-control",29),r.\u0275\u0275text(6),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementContainerEnd()),2&e){const e=r.\u0275\u0275nextContext().$implicit,t=r.\u0275\u0275nextContext(2);r.\u0275\u0275advance(2),r.\u0275\u0275property("dwSpan",e.grid.labelSpan),r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate1(" ",r.\u0275\u0275pipeBind1(4,4,e.label)," "),r.\u0275\u0275advance(2),r.\u0275\u0275property("dwSpan",e.grid.inputSpan),r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate1(" ",t.accountInfoForm.get(e.name).value," ")}}function k(e,t){if(1&e&&(r.\u0275\u0275elementContainerStart(0),r.\u0275\u0275elementStart(1,"label",31),r.\u0275\u0275text(2),r.\u0275\u0275pipe(3,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementContainerEnd()),2&e){const e=t.$implicit;r.\u0275\u0275advance(1),r.\u0275\u0275property("dwValue",e.value),r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(3,2,e.label))}}function _(e,t){if(1&e&&(r.\u0275\u0275elementContainerStart(0),r.\u0275\u0275elementStart(1,"dw-form-item"),r.\u0275\u0275elementStart(2,"dw-form-label",29),r.\u0275\u0275text(3),r.\u0275\u0275pipe(4,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(5,"dw-form-control",29),r.\u0275\u0275elementStart(6,"dw-radio-group",30),r.\u0275\u0275template(7,k,4,4,"ng-container",11),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementContainerEnd()),2&e){const e=r.\u0275\u0275nextContext().$implicit;r.\u0275\u0275advance(2),r.\u0275\u0275property("dwSpan",e.grid.labelSpan),r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate1(" ",r.\u0275\u0275pipeBind1(4,5,e.label)," "),r.\u0275\u0275advance(2),r.\u0275\u0275property("dwSpan",e.grid.inputSpan),r.\u0275\u0275advance(1),r.\u0275\u0275property("formControlName",e.name),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngForOf",e.option)}}function N(e,t){if(1&e&&(r.\u0275\u0275elementContainerStart(0),r.\u0275\u0275element(1,"dw-form-select",32),r.\u0275\u0275pipe(2,"translate"),r.\u0275\u0275pipe(3,"translate"),r.\u0275\u0275elementContainerEnd()),2&e){const e=r.\u0275\u0275nextContext().$implicit;r.\u0275\u0275advance(1),r.\u0275\u0275property("dwOptionList",e.option)("dwMode",e.selectMode)("formControlName",e.name)("dwLabel",r.\u0275\u0275pipeBind1(2,8,e.label))("dwShowSearch",e.selectShowSearch)("dwPlaceHolder",r.\u0275\u0275pipeBind1(3,10,e.placeHolder))("dwLabelSpan",e.grid.labelSpan)("dwInputSpan",e.grid.inputSpan)}}function V(e,t){if(1&e&&(r.\u0275\u0275elementContainerStart(0),r.\u0275\u0275element(1,"dw-form-date-picker",33),r.\u0275\u0275pipe(2,"translate"),r.\u0275\u0275pipe(3,"translate"),r.\u0275\u0275elementContainerEnd()),2&e){const e=r.\u0275\u0275nextContext().$implicit;r.\u0275\u0275advance(1),r.\u0275\u0275property("formControlName",e.name)("dwLabel",r.\u0275\u0275pipeBind1(2,6,e.label))("dwPlaceHolder",r.\u0275\u0275pipeBind1(3,8,e.placeHolder))("dwLabelSpan",e.grid.labelSpan)("dwInputSpan",e.grid.inputSpan)("dwDisabled",e.disabled)}}function U(e,t){if(1&e&&(r.\u0275\u0275elementContainerStart(0),r.\u0275\u0275element(1,"dw-option",42),r.\u0275\u0275elementContainerEnd()),2&e){const e=t.$implicit;r.\u0275\u0275advance(1),r.\u0275\u0275property("dwLabel",e.label)("dwValue",e.value)}}function T(e,t){if(1&e&&(r.\u0275\u0275elementStart(0,"dw-select",41),r.\u0275\u0275template(1,U,2,2,"ng-container",11),r.\u0275\u0275elementEnd()),2&e){const e=r.\u0275\u0275nextContext(3).$implicit;r.\u0275\u0275property("formControlName",e.prefix.name)("dwDisabled",e.disabled),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngForOf",e.prefix.option)}}function L(e,t){if(1&e){const e=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementContainerStart(0),r.\u0275\u0275elementStart(1,"dw-input-group",38),r.\u0275\u0275template(2,T,2,3,"ng-template",null,39,r.\u0275\u0275templateRefExtractor),r.\u0275\u0275elementStart(4,"input",40),r.\u0275\u0275listener("ngModelChange",function(){return r.\u0275\u0275restoreView(e),r.\u0275\u0275nextContext(4).onPhoneChanged()}),r.\u0275\u0275pipe(5,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementContainerEnd()}if(2&e){const e=r.\u0275\u0275reference(3),t=r.\u0275\u0275nextContext(2).$implicit;r.\u0275\u0275advance(1),r.\u0275\u0275property("dwAddOnBefore",e),r.\u0275\u0275advance(3),r.\u0275\u0275property("formControlName",t.name)("placeholder",r.\u0275\u0275pipeBind1(5,3,t.placeHolder))}}function R(e,t){if(1&e&&(r.\u0275\u0275elementStart(0,"span"),r.\u0275\u0275text(1),r.\u0275\u0275pipe(2,"translate"),r.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate1(" ",r.\u0275\u0275pipeBind2(2,1,e.key,e.value)," ")}}function A(e,t){if(1&e&&(r.\u0275\u0275elementContainerStart(0),r.\u0275\u0275template(1,R,3,4,"span",11),r.\u0275\u0275pipe(2,"keyvalue"),r.\u0275\u0275elementContainerEnd()),2&e){const e=r.\u0275\u0275nextContext(3).$implicit,t=r.\u0275\u0275nextContext(2);r.\u0275\u0275advance(1),r.\u0275\u0275property("ngForOf",r.\u0275\u0275pipeBind1(2,1,t.accountInfoForm.get(e.prefix.name).errors))}}function B(e,t){if(1&e&&(r.\u0275\u0275elementStart(0,"span"),r.\u0275\u0275text(1),r.\u0275\u0275pipe(2,"translate"),r.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate1(" ",r.\u0275\u0275pipeBind2(2,1,e.key,e.value)," ")}}function j(e,t){if(1&e&&(r.\u0275\u0275elementContainerStart(0),r.\u0275\u0275template(1,B,3,4,"span",11),r.\u0275\u0275pipe(2,"keyvalue"),r.\u0275\u0275elementContainerEnd()),2&e){const e=r.\u0275\u0275nextContext(3).$implicit,t=r.\u0275\u0275nextContext(2);r.\u0275\u0275advance(1),r.\u0275\u0275property("ngForOf",r.\u0275\u0275pipeBind1(2,1,t.accountInfoForm.get(e.name).errors))}}function H(e,t){if(1&e&&(r.\u0275\u0275template(0,A,3,3,"ng-container",36),r.\u0275\u0275template(1,j,3,3,"ng-container",36)),2&e){const e=r.\u0275\u0275nextContext(2).$implicit,t=r.\u0275\u0275nextContext(2);r.\u0275\u0275property("ngIf",t.accountInfoForm.get(e.name).dirty&&t.accountInfoForm.get(e.prefix.name).errors),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngIf",t.accountInfoForm.get(e.name).dirty&&t.accountInfoForm.get(e.name).errors)}}function $(e,t){if(1&e&&(r.\u0275\u0275elementContainerStart(0),r.\u0275\u0275elementStart(1,"dw-form-item",10),r.\u0275\u0275elementStart(2,"dw-form-label",34),r.\u0275\u0275text(3),r.\u0275\u0275pipe(4,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(5,"dw-form-control",35),r.\u0275\u0275template(6,L,6,5,"ng-container",36),r.\u0275\u0275template(7,H,2,2,"ng-template",null,37,r.\u0275\u0275templateRefExtractor),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementContainerEnd()),2&e){const e=r.\u0275\u0275reference(8),t=r.\u0275\u0275nextContext().$implicit,n=r.\u0275\u0275nextContext(2);r.\u0275\u0275advance(2),r.\u0275\u0275property("dwSpan",t.grid.labelSpan)("dwRequired",t.required),r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate1(" ",r.\u0275\u0275pipeBind1(4,7,t.label)," "),r.\u0275\u0275advance(2),r.\u0275\u0275property("dwSpan",t.grid.inputSpan)("dwValidateStatus",n.checkPhoneError(t.required))("dwErrorTip",e),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngIf","prefixSelect"===t.prefix.type)}}function q(e,t){if(1&e&&(r.\u0275\u0275elementContainerStart(0),r.\u0275\u0275element(1,"dw-form-input",43),r.\u0275\u0275pipe(2,"translate"),r.\u0275\u0275pipe(3,"translate"),r.\u0275\u0275elementContainerEnd()),2&e){const e=r.\u0275\u0275nextContext().$implicit;r.\u0275\u0275advance(1),r.\u0275\u0275property("formControlName",e.name)("dwLabel",r.\u0275\u0275pipeBind1(2,6,e.label))("dwPlaceHolder",r.\u0275\u0275pipeBind1(3,8,e.placeHolder))("dwLabelSpan",e.grid.labelSpan)("dwInputSpan",e.grid.inputSpan)("dwRequired",e.required)}}function G(e,t){if(1&e&&(r.\u0275\u0275elementContainerStart(0),r.\u0275\u0275elementStart(1,"div",12),r.\u0275\u0275elementContainerStart(2,24),r.\u0275\u0275template(3,M,6,6,"ng-container",25),r.\u0275\u0275template(4,F,7,6,"ng-container",25),r.\u0275\u0275template(5,_,8,7,"ng-container",25),r.\u0275\u0275template(6,N,4,12,"ng-container",25),r.\u0275\u0275template(7,V,4,10,"ng-container",25),r.\u0275\u0275template(8,$,9,9,"ng-container",25),r.\u0275\u0275template(9,q,4,10,"ng-container",26),r.\u0275\u0275elementContainerEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementContainerEnd()),2&e){const e=t.$implicit;r.\u0275\u0275advance(1),r.\u0275\u0275property("dwSpan",e.grid.colSpan),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngSwitch",e.type),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngSwitchCase","checkbox"),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngSwitchCase","label"),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngSwitchCase","radio"),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngSwitchCase","select"),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngSwitchCase","date"),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngSwitchCase","phone")}}function W(e,t){if(1&e){const e=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementStart(0,"dw-content",1),r.\u0275\u0275elementStart(1,"form",2),r.\u0275\u0275elementStart(2,"div",3),r.\u0275\u0275elementStart(3,"div",4),r.\u0275\u0275elementStart(4,"div",5),r.\u0275\u0275template(5,E,1,0,"img",6),r.\u0275\u0275template(6,P,6,10,"dw-upload",7),r.\u0275\u0275elementEnd(),r.\u0275\u0275template(7,D,5,4,"div",8),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(8,"div",9),r.\u0275\u0275elementStart(9,"div",10),r.\u0275\u0275template(10,G,10,8,"ng-container",11),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(11,"div",10),r.\u0275\u0275elementStart(12,"div",12),r.\u0275\u0275elementStart(13,"dw-form-item",13),r.\u0275\u0275elementStart(14,"dw-form-control",14),r.\u0275\u0275elementStart(15,"button",15),r.\u0275\u0275listener("click",function(){return r.\u0275\u0275restoreView(e),r.\u0275\u0275nextContext().saveFormData()}),r.\u0275\u0275elementStart(16,"span",16),r.\u0275\u0275text(17,"dw-account-info-save"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd()}if(2&e){const e=r.\u0275\u0275nextContext();r.\u0275\u0275advance(1),r.\u0275\u0275property("formGroup",e.accountInfoForm),r.\u0275\u0275advance(4),r.\u0275\u0275property("ngIf",!e.isUseHeadImage),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngIf",e.isUseHeadImage),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngIf",e.isUseUpdatePassword),r.\u0275\u0275advance(3),r.\u0275\u0275property("ngForOf",e.formOption),r.\u0275\u0275advance(2),r.\u0275\u0275property("dwSpan",24),r.\u0275\u0275advance(3),r.\u0275\u0275property("dwType","primary")("disabled",!e.accountInfoForm.valid)("dwLoading",e.isButtLoading)}}let Z=(()=>{class e{constructor(e,t,n,o,a,i,s,d,l){this.fb=e,this.accountInfoService=t,this.accountInfoDataSourceService=n,this.accountInfoUploadService=o,this.dwModalService=a,this.dwUpdatePasswordModalService=i,this.translateService=s,this.configService=d,this.dwDateFormat=l,this.isShowForm=!1,this.headImage=[],this.isButtLoading=!1,this.cellphonePrefixRequired=!1,this._formOption=[],this._userInfo=null,this._isUseHeadImage=!0,this._isUseUpdatePassword=!0,this.userInfoValue=new r.EventEmitter,this.beforeLogoUpload=e=>{const t=new w.Subject,n=new FileReader,r=this.fileToObject(e);return n.addEventListener("load",()=>{r.thumbUrl=n.result,this.headImage=[r],t.next(!1)}),n.readAsDataURL(e),r.status="done",t.asObservable()},this.remove=e=>new w.Observable(e=>{this.headImage=[],this._userInfo.headImageUrl="",e.next(!0),e.complete()}),this.configService.get("multiTenant").subscribe(e=>{this.dwMultiTenant=e})}set isUseHeadImage(e){this._isUseHeadImage="string"==typeof e?JSON.parse(e):e}get isUseHeadImage(){return this._isUseHeadImage}set isUseUpdatePassword(e){this._isUseUpdatePassword="string"==typeof e?JSON.parse(e):e}get isUseUpdatePassword(){return this._isUseUpdatePassword}set formOption(e){this._formOption=this.accountInfoService.getFullConfig(e)}get formOption(){return this._formOption}ngOnInit(){const e=[this.getRxjsFormOption(),this.accountInfoDataSourceService.getUserBasicInfo()];(0,w.forkJoin)(e).subscribe(e=>{this.formOption=e[0],this._userInfo=e[1],this.userInfoValue.emit(this._userInfo),this.accountInfoForm=this.fb.group({}),this.formOption.forEach(e=>{this.setFormControl(e),e.hasOwnProperty("prefix")&&this.setFormControl(e.prefix)}),this.formOption.hasOwnProperty("telephone")&&this.formOption.telephone.hasOwnProperty("cellphonePrefix")&&(this.cellphonePrefixRequired=this.formOption.telephone.cellphonePrefix.required),this._userInfo.hasOwnProperty("headImageUrl")&&this._userInfo.headImageUrl&&(this.headImage=[{url:this._userInfo.headImageUrl}]),this.isShowForm=!0},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.dwModalService.error({dwContent:e.error.errorMessage})})}getRxjsFormOption(){return null===this.formOption$?(0,w.of)(this.accountInfoService.getDefaultConfig()):this.formOption$}setFormControl(e){let t="";this._userInfo.hasOwnProperty(e.name)&&(t=this._userInfo[e.name]),"select"===e.type&&(t=this._userInfo[e.name]?this._userInfo[e.name]:[]),"checkbox"===e.type&&(t="boolean"==typeof t&&t),this.accountInfoForm.addControl(e.name,new a.FormControl(t)),e.disabled&&this.accountInfoForm.get(e.name).disable(),this.getDefaultValidators(e),!0===e.required?("checkbox"===e.type?this.accountInfoForm.get(e.name).setValidators([...e.validators,a.Validators.requiredTrue]):this.accountInfoForm.get(e.name).setValidators([...e.validators,a.Validators.required]),e.asyncValidators.length>0&&this.accountInfoForm.get(e.name).setAsyncValidators([...e.asyncValidators])):(e.validators.length&&this.accountInfoForm.get(e.name).setValidators([...e.validators]),e.asyncValidators.length>0&&this.accountInfoForm.get(e.name).setAsyncValidators([...e.asyncValidators]))}getDefaultValidators(e){if(!this.formOption$)switch(e.name){case"email":Object.assign(e,{validators:[a.Validators.email]}),this.dwMultiTenant&&(e.hasOwnProperty("asyncValidators")?e.asyncValidators.push(this.accountInfoService.verifyEmailExist(this._userInfo)):e.asyncValidators=[this.accountInfoService.verifyEmailExist(this._userInfo)]);break;case"telephone":Object.assign(e,{validators:[a.Validators.minLength(10),a.Validators.maxLength(11),this.accountInfoService.userMobilephoneNumeric()]}),this.dwMultiTenant&&(e.hasOwnProperty("asyncValidators")?e.asyncValidators.push(this.accountInfoService.verifyMobilephone(this._userInfo)):e.asyncValidators=[this.accountInfoService.verifyMobilephone(this._userInfo)])}}onPhoneChanged(){if(!this.dwMultiTenant)return;const e=this.accountInfoForm.get("telephone"),t=this.accountInfoForm.get("cellphonePrefix");e.dirty&&!e.errors&&e.value?t.setValidators([a.Validators.required]):this.cellphonePrefixRequired||t.setValidators([]),t.updateValueAndValidity()}checkPhoneError(e){const t=this.accountInfoForm.get("telephone"),n=this.accountInfoForm.get("cellphonePrefix");if((t.dirty||n.dirty)&&(t.errors||n.errors))return"error"}fileToObject(e){return{lastModified:e.lastModified,lastModifiedDate:e.lastModifiedDate,name:e.filename||e.name,size:e.size,type:e.type,uid:e.uid,response:e.response,error:e.error,percent:0,originFileObj:e}}getFormValue(){const e=this.accountInfoForm.getRawValue();for(let[t,n]of Object.entries(e))n instanceof Date&&(n=new o.DatePipe("zh_tw").transform(n,this.dwDateFormat)),Array.isArray(n)&&(n=n.toString()),this._userInfo[t]=n}getPostValue(){const e={};for(const t of Object.keys(this.accountInfoForm.controls))e[t]=this._userInfo[t];return e.headImageUrl=this._userInfo.headImageUrl,e}saveFormData(){this.isButtLoading=!0,this.getFormValue(),this.updateHeadImage().pipe((0,g.switchMap)(e=>(this._userInfo.headImageUrl=e,this.accountInfoDataSourceService.updateUserBasicInfo(this.getPostValue()))),(0,g.switchMap)(e=>this.accountInfoDataSourceService.refreshUserInfo(this._userInfo))).subscribe(e=>{this.isButtLoading=!1,this.userInfoValue.emit(this._userInfo),this.dwModalService.success({dwTitle:this.translateService.instant("dw-account-info-form-update-success-title"),dwContent:this.translateService.instant("dw-account-info-form-update-success-content")})},e=>{this.isButtLoading=!1,e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.dwModalService.error({dwContent:e.error.errorMessage})})}updateHeadImage(){return 0===this.headImage.length?new w.Observable(e=>{e.next(""),e.complete()}):this.headImage[0].hasOwnProperty("url")&&this.headImage[0].url?new w.Observable(e=>{e.next(this.headImage[0].url),e.complete()}):this.accountInfoUploadService.uploadAndShare(this.headImage[0].originFileObj).pipe((0,g.filter)(e=>e.hasOwnProperty("shareUrl")&&e.shareUrl),(0,g.map)(e=>e.shareUrl))}updatePassword(){this.dwUpdatePasswordModalService.open().subscribe()}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275directiveInject(a.FormBuilder),r.\u0275\u0275directiveInject(S.DwAccountInfoService),r.\u0275\u0275directiveInject(S.DwAccountInfoDataSourceService),r.\u0275\u0275directiveInject(S.DwAccountInfoUploadService),r.\u0275\u0275directiveInject(v.DwModalService),r.\u0275\u0275directiveInject(I.DwUpdatePasswordModalService),r.\u0275\u0275directiveInject(i.TranslateService),r.\u0275\u0275directiveInject(b.DwSystemConfigService),r.\u0275\u0275directiveInject(b.APP_DATE_FORMAT))},e.\u0275cmp=r.\u0275\u0275defineComponent({type:e,selectors:[["dw-account-info"]],inputs:{isUseHeadImage:"isUseHeadImage",isUseUpdatePassword:"isUseUpdatePassword",formOption$:"formOption$"},outputs:{userInfoValue:"userInfoValue"},decls:1,vars:1,consts:[["class","dw-f-content-list",4,"ngIf"],[1,"dw-f-content-list"],["dw-form","",1,"account-info-form",3,"formGroup"],[1,"inputBlock"],[1,"user-pic-block"],[1,"photo-box"],["src","./assets/img/user-pic.png",4,"ngIf"],["dwListType","picture-card","dwFileType","image/png,image/jpeg,image/gif,image/bmp","class","headImage-upload",3,"dwBeforeUpload","dwRemove","dwShowUploadList","dwFileList","dwShowButton","dwMultiple","dwFileListChange",4,"ngIf"],["class","btn-block",4,"ngIf"],[1,"user-data-block"],["dw-row",""],[4,"ngFor","ngForOf"],["dw-col","",3,"dwSpan"],[1,"customize-footer"],["dwSpan","24"],["dw-button","",3,"dwType","disabled","dwLoading","click"],["translate",""],["src","./assets/img/user-pic.png"],["dwListType","picture-card","dwFileType","image/png,image/jpeg,image/gif,image/bmp",1,"headImage-upload",3,"dwBeforeUpload","dwRemove","dwShowUploadList","dwFileList","dwShowButton","dwMultiple","dwFileListChange"],[1,"ant-upload-drag-icon"],["dw-icon","","dwType","plus","dwTheme","outline"],[1,"ant-upload-text"],[1,"btn-block"],["dw-button","",3,"dwType","click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"dwSpan","dwOffset"],["dw-checkbox","",3,"formControlName"],[3,"dwSpan"],[3,"formControlName"],["dw-radio","",3,"dwValue"],[3,"dwOptionList","dwMode","formControlName","dwLabel","dwShowSearch","dwPlaceHolder","dwLabelSpan","dwInputSpan"],[3,"formControlName","dwLabel","dwPlaceHolder","dwLabelSpan","dwInputSpan","dwDisabled"],[3,"dwSpan","dwRequired"],[3,"dwSpan","dwValidateStatus","dwErrorTip"],[4,"ngIf"],["accountInfoErrorTpl",""],[3,"dwAddOnBefore"],["phoneTemplate",""],["dw-input","",3,"formControlName","placeholder","ngModelChange"],[2,"width","80px",3,"formControlName","dwDisabled"],[3,"dwLabel","dwValue"],[3,"formControlName","dwLabel","dwPlaceHolder","dwLabelSpan","dwInputSpan","dwRequired"]],template:function(e,t){1&e&&r.\u0275\u0275template(0,W,18,9,"dw-content",0),2&e&&r.\u0275\u0275property("ngIf",t.isShowForm)},directives:[o.NgIf,l.DwContentComponent,a.\u0275NgNoValidate,a.NgControlStatusGroup,d.DwFormDirective,a.FormGroupDirective,h.DwRowDirective,o.NgForOf,h.DwColDirective,d.DwFormItemComponent,d.DwFormControlComponent,u.DwButtonComponent,y.uG,x.u,i.TranslateDirective,s.DwUploadComponent,o.NgSwitch,o.NgSwitchCase,o.NgSwitchDefault,f.DwCheckboxComponent,a.NgControlStatus,a.FormControlName,d.DwFormLabelComponent,m.DwRadioGroupComponent,m.DwRadioComponent,C.DwFormSelectComponent,C.DwFormDatePickerComponent,c.DwInputGroupComponent,c.DwInputDirective,a.DefaultValueAccessor,p.DwSelectComponent,p.DwOptionComponent,C.DwFormInputComponent],pipes:[i.TranslatePipe,o.KeyValuePipe],styles:[".headImage-upload[_ngcontent-%COMP%]   .ant-upload.ant-upload-select-picture-card[_ngcontent-%COMP%]{margin-top:.31rem;border-radius:.38rem;width:100%}.headImage-upload[_ngcontent-%COMP%]   .ant-upload.ant-upload-select-picture-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:1.13rem}.headImage-upload[_ngcontent-%COMP%]   .ant-upload.ant-upload-select-picture-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.5rem;color:#ddd}[_nghost-%COMP%]     .user-data-block .has-error .ant-form-item-children{line-height:40px;display:block}[_nghost-%COMP%]     .user-data-block .has-error .ant-form-explain{font-size:.75rem;transform:scale(.95);position:absolute;z-index:2;text-shadow:1px 1px 5px #fff,-1px -1px 5px #fff;background-color:#fff6;bottom:-14px}[_nghost-%COMP%]     .user-data-block .ant-calendar-picker{width:100%}[_nghost-%COMP%]     .user-pic-block span.ant-form-item-children img{margin-bottom:1rem}[_nghost-%COMP%]     .user-pic-block .ant-upload-list-picture-card .ant-upload-list-item, [_nghost-%COMP%]     .user-pic-block .ant-upload.ant-upload-select-picture-card{margin-right:0;margin-bottom:1rem}.inputBlock[_ngcontent-%COMP%]{display:inline-flex}.inputBlock[_ngcontent-%COMP%]   .user-pic-block[_ngcontent-%COMP%]{width:8.75rem}.inputBlock[_ngcontent-%COMP%]   .user-pic-block[_ngcontent-%COMP%]   .photo-box[_ngcontent-%COMP%]{display:table;margin:0 auto}.inputBlock[_ngcontent-%COMP%]   .user-pic-block[_ngcontent-%COMP%]   .btn-block[_ngcontent-%COMP%]{text-align:center;width:100%}.inputBlock[_ngcontent-%COMP%]   .user-data-block[_ngcontent-%COMP%]{width:calc(100% - 9rem)}"]}),e})(),z=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=r.\u0275\u0275defineInjector({imports:[[o.CommonModule,a.ReactiveFormsModule,s.DwUploadModule,d.DwFormModule,l.DwLayoutModule,c.DwInputModule,p.DwSelectModule,m.DwRadioModule,u.DwButtonModule,h.DwGridModule,f.DwCheckboxModule,C.DwFormItemsModule,i.TranslateModule]]}),e})()},8852:function(e,t,n){n.d(t,{u:function(){return a},f:function(){return i}});var r=n(36535),o=n(42746);let a=(()=>{class e{constructor(e,t){this.elementRef=e,this.renderer=t,this.hidden=null,this.renderer.setAttribute(this.elementRef.nativeElement,"hidden","")}setHiddenAttribute(){this.hidden?this.renderer.setAttribute(this.elementRef.nativeElement,"hidden","string"==typeof this.hidden?this.hidden:""):this.renderer.removeAttribute(this.elementRef.nativeElement,"hidden")}ngOnChanges(){this.setHiddenAttribute()}ngAfterViewInit(){this.setHiddenAttribute()}}return e.\u0275fac=function(t){return new(t||e)(o.\u0275\u0275directiveInject(o.ElementRef),o.\u0275\u0275directiveInject(o.Renderer2))},e.\u0275dir=o.\u0275\u0275defineDirective({type:e,selectors:[["","dw-button",""],["dw-button-group"],["","dw-icon",""],["","dw-menu-item",""],["","dw-submenu",""],["dw-select-top-control"],["dw-select-placeholder"],["dw-input-group"]],inputs:{hidden:"hidden"},features:[o.\u0275\u0275NgOnChangesFeature]}),e})(),i=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=o.\u0275\u0275defineInjector({imports:[[r.PlatformModule]]}),e})()},96670:function(e,t,n){n.d(t,{uG:function(){return l},ln:function(){return c}});var r=n(36535),o=n(42746),a=n(88065);class i{constructor(e,t,n,o){this.triggerElement=e,this.ngZone=t,this.insertExtraNode=n,this.platformId=o,this.waveTransitionDuration=400,this.styleForPseudo=null,this.extraNode=null,this.lastTime=0,this.onClick=e=>{!this.triggerElement||!this.triggerElement.getAttribute||this.triggerElement.getAttribute("disabled")||"INPUT"===e.target.tagName||this.triggerElement.className.indexOf("disabled")>=0||this.fadeOutWave()},this.platform=new r.Platform(this.platformId),this.clickHandler=this.onClick.bind(this),this.bindTriggerEvent()}get waveAttributeName(){return this.insertExtraNode?"ant-click-animating":"ant-click-animating-without-extra-node"}bindTriggerEvent(){this.platform.isBrowser&&this.ngZone.runOutsideAngular(()=>{this.removeTriggerEvent(),this.triggerElement&&this.triggerElement.addEventListener("click",this.clickHandler,!0)})}removeTriggerEvent(){this.triggerElement&&this.triggerElement.removeEventListener("click",this.clickHandler,!0)}removeStyleAndExtraNode(){this.styleForPseudo&&document.body.contains(this.styleForPseudo)&&(document.body.removeChild(this.styleForPseudo),this.styleForPseudo=null),this.insertExtraNode&&this.triggerElement.contains(this.extraNode)&&this.triggerElement.removeChild(this.extraNode)}destroy(){this.removeTriggerEvent(),this.removeStyleAndExtraNode()}fadeOutWave(){const e=this.triggerElement,t=this.getWaveColor(e);e.setAttribute(this.waveAttributeName,"true"),!(Date.now()<this.lastTime+this.waveTransitionDuration)&&(this.isValidColor(t)&&(this.styleForPseudo||(this.styleForPseudo=document.createElement("style")),this.styleForPseudo.innerHTML=`\n      [ant-click-animating-without-extra-node='true']::after, .ant-click-animating-node {\n        --antd-wave-shadow-color: ${t};\n      }`,document.body.appendChild(this.styleForPseudo)),this.insertExtraNode&&(this.extraNode||(this.extraNode=document.createElement("div")),this.extraNode.className="ant-click-animating-node",e.appendChild(this.extraNode)),this.lastTime=Date.now(),this.runTimeoutOutsideZone(()=>{e.removeAttribute(this.waveAttributeName),this.removeStyleAndExtraNode()},this.waveTransitionDuration))}isValidColor(e){return!!e&&"#ffffff"!==e&&"rgb(255, 255, 255)"!==e&&this.isNotGrey(e)&&!/rgba\(\d*, \d*, \d*, 0\)/.test(e)&&"transparent"!==e}isNotGrey(e){const t=e.match(/rgba?\((\d*), (\d*), (\d*)(, [\.\d]*)?\)/);return!(t&&t[1]&&t[2]&&t[3]&&t[1]===t[2]&&t[2]===t[3])}getWaveColor(e){const t=getComputedStyle(e);return t.getPropertyValue("border-top-color")||t.getPropertyValue("border-color")||t.getPropertyValue("background-color")}runTimeoutOutsideZone(e,t){this.ngZone.runOutsideAngular(()=>setTimeout(e,t))}}const s={disabled:!1},d=new o.InjectionToken("dw-wave-global-options",{providedIn:"root",factory:function(){return s}});let l=(()=>{class e{constructor(e,t,n,r,o){this.ngZone=e,this.elementRef=t,this.config=n,this.animationType=r,this.platformId=o,this.dwWaveExtraNode=!1,this.waveDisabled=!1,this.waveDisabled=this.isConfigDisabled()}get disabled(){return this.waveDisabled}get rendererRef(){return this.waveRenderer}isConfigDisabled(){let e=!1;return this.config&&"boolean"==typeof this.config.disabled&&(e=this.config.disabled),"NoopAnimations"===this.animationType&&(e=!0),e}ngOnDestroy(){this.waveRenderer&&this.waveRenderer.destroy()}ngOnInit(){this.renderWaveIfEnabled()}renderWaveIfEnabled(){!this.waveDisabled&&this.elementRef.nativeElement&&(this.waveRenderer=new i(this.elementRef.nativeElement,this.ngZone,this.dwWaveExtraNode,this.platformId))}disable(){this.waveDisabled=!0,this.waveRenderer&&(this.waveRenderer.removeTriggerEvent(),this.waveRenderer.removeStyleAndExtraNode())}enable(){this.waveDisabled=this.isConfigDisabled()||!1,this.waveRenderer&&this.waveRenderer.bindTriggerEvent()}}return e.\u0275fac=function(t){return new(t||e)(o.\u0275\u0275directiveInject(o.NgZone),o.\u0275\u0275directiveInject(o.ElementRef),o.\u0275\u0275directiveInject(d,8),o.\u0275\u0275directiveInject(a.ANIMATION_MODULE_TYPE,8),o.\u0275\u0275directiveInject(o.PLATFORM_ID))},e.\u0275dir=o.\u0275\u0275defineDirective({type:e,selectors:[["","dw-wave",""],["button","dw-button","",3,"dwType","link",3,"dwType","text"]],inputs:{dwWaveExtraNode:"dwWaveExtraNode"},exportAs:["dwWave"]}),e})(),c=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=o.\u0275\u0275defineInjector({imports:[[r.PlatformModule]]}),e})()}}]);