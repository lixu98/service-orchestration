"use strict";(self.webpackChunkassc_crs=self.webpackChunkassc_crs||[]).push([[7277,4520],{57277:function(r,e,t){t.r(e),t.d(e,{DwOperationInfoListService:function(){return g},DwOperationInfoService:function(){return d},DwOperationModule:function(){return p},DwProgramInfoListJsonService:function(){return u},DwRouterInfoService:function(){return f}});var o=t(42746),n=t(71049),i=t(47372),a=t(30469),s=t(55245),c=t(66800);let p=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=o.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=o.\u0275\u0275defineInjector({imports:[[s.CommonModule]]}),r})(),u=(()=>{class r{constructor(r,e,t){if(this.dwProgramJson=r,this.dwProgramPageJson=e,this.dwProgramActionJson=t,this._programListJsonMap=null,this.programListJsonSubject=new n.BehaviorSubject(this._programListJsonMap),this._dwProgramDataFramework=JSON.parse(JSON.stringify(a.dwProgramDataFramework)),(0,o.isDevMode)()){const r=JSON.parse(JSON.stringify(a.dwProgramDataDev));this._dwProgramDataFramework=this._dwProgramDataFramework.concat(r)}let i=JSON.parse(JSON.stringify(this.dwProgramJson));Array.isArray(i)||(i=[]);let s=JSON.parse(JSON.stringify(this.dwProgramPageJson));Array.isArray(s)||(s=[]);let c=JSON.parse(JSON.stringify(this.dwProgramActionJson));Array.isArray(c)||(c=[]),i.forEach(r=>{const e=s.length;for(let o=0;o<e;o++)if(s[o].programId===r.id){r.page=JSON.parse(JSON.stringify(s[o].page));break}const t=c.length;for(let o=0;o<t;o++)if(c[o].programId===r.id){r.action=JSON.parse(JSON.stringify(c[o].action));break}});const p=i.length,u=JSON.parse(JSON.stringify(a.programInfoJson)),g=JSON.parse(JSON.stringify(a.programPageInfoJson)),f=g.length,d=JSON.parse(JSON.stringify(a.programActionInfoJson)),l=d.length;u.forEach(r=>{for(let e=0;e<p;e++)if(i[e].id===r.id){i[e]=JSON.parse(JSON.stringify(r));for(let t=0;t<f;t++)g[t].programId===r.id&&(i[e].page=JSON.parse(JSON.stringify(g[t].page)));for(let t=0;t<l;t++)d[t].programId===r.id&&(i[e].action=JSON.parse(JSON.stringify(d[t].action)));break}});const m=[...this.dwProgramInfoFrameworkJson,...i];this._programListJsonMap={},m.forEach(r=>{const e=r.id;r.hasOwnProperty("page")||(r.page=[]),r.hasOwnProperty("action")||(r.action=[]),delete r.id,this._programListJsonMap[e]=r});const h=Object.assign({},this._programListJsonMap);this.programListJsonSubject.next(h)}get programListJsonMap$(){return this.programListJsonSubject.asObservable().pipe((0,i.filter)(r=>null!==r),(0,i.distinctUntilChanged)())}get programListJsonMap(){const r={};return Object.keys(this._programListJsonMap).forEach(e=>{const t=Object.assign({},this._programListJsonMap[e]);r[e]=t}),r}get dwProgramInfoFrameworkJson(){return JSON.parse(JSON.stringify(this._dwProgramDataFramework))}}return r.\u0275fac=function(e){return new(e||r)(o.\u0275\u0275inject(a.DW_PROGRAM_JSON),o.\u0275\u0275inject(a.DW_PROGRAM_PAGE),o.\u0275\u0275inject(a.DW_PROGRAM_ACTION))},r.\u0275prov=o.\u0275\u0275defineInjectable({factory:function(){return new r(o.\u0275\u0275inject(a.DW_PROGRAM_JSON),o.\u0275\u0275inject(a.DW_PROGRAM_PAGE),o.\u0275\u0275inject(a.DW_PROGRAM_ACTION))},token:r,providedIn:p}),r})(),g=(()=>{class r{constructor(r,e){this.programInfoListJsonService=r,this.dwTenantService=e,this.operationSubject=new n.BehaviorSubject(null);let t,o=!1;this.dwTenantService.isTokenValid$.subscribe(r=>{r?o||(o=!0,t=this.programInfoListJsonService.programListJsonMap$.subscribe(r=>{this.operationSubject.next(r)},r=>{console.log(r),this.operationSubject.next({})})):(o=!1,this.operationSubject.next(null),t&&t.unsubscribe())})}get operationListMap$(){return this.operationSubject.asObservable().pipe((0,i.filter)(r=>null!==r),(0,i.distinctUntilChanged)())}}return r.\u0275fac=function(e){return new(e||r)(o.\u0275\u0275inject(u),o.\u0275\u0275inject(c.DwTenantService))},r.\u0275prov=o.\u0275\u0275defineInjectable({factory:function(){return new r(o.\u0275\u0275inject(u),o.\u0275\u0275inject(c.DwTenantService))},token:r,providedIn:p}),r})(),f=(()=>{class r{constructor(){}routerProgramId(r){let e=null;const t=r.firstChild,o=r.data.value;if(o.dwRouteData&&o.dwRouteData.hasOwnProperty("programId")&&(e=o.dwRouteData.programId),!e)if(t)e=this.routerProgramId(t);else{const t=r.params.value;t.programId&&(e=t.programId)}return e}routeSnapshotProgramId(r){let e=null;const t=r.pathFromRoot.reverse();let o;for(let n=0;n<t.length;n++)if(o=t[n],o.routeConfig&&o.routeConfig.data&&o.routeConfig.data.dwRouteData&&o.routeConfig.data.dwRouteData.programId){e=o.routeConfig.data.dwRouteData.programId;break}return e}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=o.\u0275\u0275defineInjectable({factory:function(){return new r},token:r,providedIn:p}),r})(),d=(()=>{class r{constructor(r,e,t){this.dwOperationInfoListService=r,this.dwProgramInfoListJsonService=e,this.dwRouterInfoService=t}operationInfo$(r,e){const t=new n.BehaviorSubject(null);let o={module:"",type:"",routerLink:"",page:[],action:[]};const a=this.operationBaseByType(e,r);return a.type?(o=Object.assign({},a),t.next(o)):this.dwOperationInfoListService.operationListMap$.subscribe(e=>{if(null!==e&&e[r]&&(o=e[r]),"externalUrl"===o.type){const e=this.operationBaseByType(o.type,r);e.type&&(o.type=e.type,o.routerLink=e.routerLink)}t.next(o)},r=>{t.next(o)}),t.asObservable().pipe((0,i.filter)(r=>null!==r),(0,i.distinctUntilChanged)())}operationBaseByType(r,e){let t={module:"",type:"",routerLink:"",page:[],action:[]};if(r){const o=this.dwProgramInfoListJsonService.dwProgramInfoFrameworkJson.length;for(let n=0;n<o;n++)if(this.dwProgramInfoListJsonService.dwProgramInfoFrameworkJson[n].type===r){t=Object.assign({},this.dwProgramInfoListJsonService.dwProgramInfoFrameworkJson[n]),t.routerLink=t.routerLink+"/"+e;break}}return t}operationBaseByRouterLink(r,e){0!==r.indexOf("/")&&(r="/"+r);let t={module:"",type:"",routerLink:"",page:[],action:[]};const o=this.dwProgramInfoListJsonService.dwProgramInfoFrameworkJson.length;for(let n=0;n<o;n++)if(this.dwProgramInfoListJsonService.dwProgramInfoFrameworkJson[n].routerLink===r){t=Object.assign({},this.dwProgramInfoListJsonService.dwProgramInfoFrameworkJson[n]),t.routerLink=t.routerLink+"/"+e;break}return t}routerOperationInfo(r){let e="";const t={id:e,module:"",type:"",routerLink:"",page:[],action:[]},o=r.params;if(o.hasOwnProperty("programId")){e=o.programId;const i=[];let a=r;for(;a;)a.url.length>0&&i.unshift(a.url[0].path),a=a.parent;if(i.length>0){const r=i.join("/"),o=this.operationBaseByRouterLink(r,e);t.id=e,t.module=o.module,t.type=o.type,t.routerLink=o.routerLink}return n.Observable.create(r=>{r.next(t),r.complete()})}return e=this.dwRouterInfoService.routeSnapshotProgramId(r),this.operationInfo$(e).pipe((0,i.map)(r=>(t.id=e,t.module=r.module,t.type=r.type,t.routerLink=r.routerLink,t)))}isParamEqual(r,e){let t=!1;const o=r,n=e,i=Object.keys(o).length;if(i===Object.keys(n).length)if(0===i)t=!0;else{let r=i;Object.keys(o).forEach(e=>{const t=n[e];void 0!==t&&t===o[e]&&(r-=1)}),0===r&&(t=!0)}return t}}return r.\u0275fac=function(e){return new(e||r)(o.\u0275\u0275inject(g),o.\u0275\u0275inject(u),o.\u0275\u0275inject(f))},r.\u0275prov=o.\u0275\u0275defineInjectable({factory:function(){return new r(o.\u0275\u0275inject(g),o.\u0275\u0275inject(u),o.\u0275\u0275inject(f))},token:r,providedIn:p}),r})()}}]);