!function(){"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkassc_crs=self.webpackChunkassc_crs||[]).push([[3748],{93599:function(n,i,r){r.r(i),r.d(i,{DwAnnouncementModalComponent:function(){return b},DwAnnouncementModalService:function(){return C},DwAnnouncementModule:function(){return S},DwAnnouncementRepository:function(){return A},DwAnnouncementService:function(){return j}});var o,c=r(31441),u=r(42746),s=r(59083),a=r(30469),d=r(96709),l=r(55245),f=r(83522),p=r(74591),m=r(93761),h=r(1020),v=r(71049),w=r(62481),g=r(96670),y=r(8852),b=((o=function(){function n(t,i){e(this,n),this._sanitizer=t,this.modalSubject=i,this.isIgnore=!1}return t(n,[{key:"description",get:function(){return this._description},set:function(e){this._description=this._sanitizer.bypassSecurityTrustHtml(e)}},{key:"close",value:function(){this.modalSubject.destroy(this.isIgnore)}},{key:"ngOnInit",value:function(){}}]),n}()).\u0275fac=function(e){return new(e||o)(u.\u0275\u0275directiveInject(s.DomSanitizer),u.\u0275\u0275directiveInject(c.DwModalRef))},o.\u0275cmp=u.\u0275\u0275defineComponent({type:o,selectors:[["dw-announcement-modal"]],inputs:{description:"description"},decls:10,vars:8,consts:[[3,"innerHtml"],[2,"padding-top","20px"],["dw-button","","dwType","primary",3,"click"],["dw-checkbox","",3,"ngModel","ngModelChange"]],template:function(e,n){1&e&&(u.\u0275\u0275elementStart(0,"div"),u.\u0275\u0275element(1,"div",0),u.\u0275\u0275elementStart(2,"div",1),u.\u0275\u0275elementStart(3,"button",2),u.\u0275\u0275listener("click",function(){return n.close()}),u.\u0275\u0275text(4),u.\u0275\u0275pipe(5,"translate"),u.\u0275\u0275elementEnd(),u.\u0275\u0275text(6," \xa0\xa0"),u.\u0275\u0275elementStart(7,"label",3),u.\u0275\u0275listener("ngModelChange",function(e){return n.isIgnore=e}),u.\u0275\u0275text(8),u.\u0275\u0275pipe(9,"translate"),u.\u0275\u0275elementEnd(),u.\u0275\u0275elementEnd(),u.\u0275\u0275elementEnd()),2&e&&(u.\u0275\u0275advance(1),u.\u0275\u0275property("innerHtml",n.description,u.\u0275\u0275sanitizeHtml),u.\u0275\u0275advance(3),u.\u0275\u0275textInterpolate(u.\u0275\u0275pipeBind1(5,4,"dw-announcement-got-it")),u.\u0275\u0275advance(3),u.\u0275\u0275property("ngModel",n.isIgnore),u.\u0275\u0275advance(1),u.\u0275\u0275textInterpolate(u.\u0275\u0275pipeBind1(9,6,"dw-announcement-never-show-again")))},directives:[m.DwButtonComponent,g.uG,y.u,p.DwCheckboxComponent,h.NgControlStatus,h.NgModel],pipes:[f.TranslatePipe],styles:[""]}),o),I=[],S=function(){var n=t(function n(){e(this,n)});return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=u.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=u.\u0275\u0275defineInjector({providers:[].concat(I),imports:[[l.CommonModule,f.TranslateModule,p.DwCheckboxModule,c.DwModalModule,m.DwButtonModule,h.FormsModule]]}),n}(),A=function(){var n=function(){function n(t,i){e(this,n),this.dwAppId=t,this.http=i}return t(n,[{key:"getActiveAnnouncement",value:function(e){return this.http.get("restful/service/DWSysManagement/Announcement/ActiveAnnouncement",{params:{goodsCode:this.dwAppId,displayId:e}})}}]),n}();return n.\u0275fac=function(e){return new(e||n)(u.\u0275\u0275inject(a.DW_APP_ID),u.\u0275\u0275inject(d.DwOmHttpClient))},n.\u0275prov=u.\u0275\u0275defineInjectable({factory:function(){return new n(u.\u0275\u0275inject(a.DW_APP_ID),u.\u0275\u0275inject(d.DwOmHttpClient))},token:n,providedIn:S}),n}(),j=function(){var n=function(){function n(t,i,r){e(this,n),this.systemConfigService=t,this.localStorage=i,this.announcementRepository=r}return t(n,[{key:"getAnnouncement",value:function(e){var n=this;return v.Observable.create(function(t){n.systemConfigService.get("multiTenant").subscribe(function(i){!0===i?n.announcementRepository.getActiveAnnouncement(e).subscribe(function(e){if(e.data&&e.data.length){var i=e.data[0];n.getIgnoreList().filter(function(e){return e.id===i.id}).length?t.next(null):t.next(i)}else t.next(null)}):t.next(null)},function(e){t.next(null)})})}},{key:"getIgnoreList",value:function(){var e=[],n=this.localStorage.get("dwAnnouncementIgnore");return n&&(n=JSON.parse(n),Array.isArray(n)&&(e=n)),e}},{key:"setIgnore",value:function(e){var n=this.getIgnoreList(),t=n.findIndex(function(n){return n.displayId===e.displayId});-1!==t?n[t]=e:n.push(e),n=n.filter(function(e){return new Date(e.expires)>new Date}),this.localStorage.set("dwAnnouncementIgnore",JSON.stringify(n))}}]),n}();return n.\u0275fac=function(e){return new(e||n)(u.\u0275\u0275inject(a.DwSystemConfigService),u.\u0275\u0275inject(w.LocalStorage),u.\u0275\u0275inject(A))},n.\u0275prov=u.\u0275\u0275defineInjectable({factory:function(){return new n(u.\u0275\u0275inject(a.DwSystemConfigService),u.\u0275\u0275inject(w.LocalStorage),u.\u0275\u0275inject(A))},token:n,providedIn:S}),n}(),C=function(){var n=function(){function n(t,i){e(this,n),this.dwModalService=t,this.announcementService=i}return t(n,[{key:"displayAnnouncement",value:function(e){var n=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"730";return v.Observable.create(function(i){n.announcementService.getAnnouncement(e).subscribe(function(r){r?(n._postModal=n.dwModalService.create({dwContent:b,dwWidth:t,dwFooter:null,dwClosable:!1,dwMaskClosable:!1,dwOnOk:function(e){},dwOnCancel:function(){},dwComponentParams:{description:r.description}}),n._postModal.afterClose.subscribe(function(t){t&&n.announcementService.setIgnore({displayId:e,id:r.id,expires:r.endDate}),i.next(!0)})):i.next(!0)})})}}]),n}();return n.\u0275fac=function(e){return new(e||n)(u.\u0275\u0275inject(c.DwModalService),u.\u0275\u0275inject(j))},n.\u0275prov=u.\u0275\u0275defineInjectable({factory:function(){return new n(u.\u0275\u0275inject(c.DwModalService),u.\u0275\u0275inject(j))},token:n,providedIn:S}),n}()},8852:function(n,i,r){r.d(i,{u:function(){return s},f:function(){return a}});var o,c=r(36535),u=r(42746),s=((o=function(){function n(t,i){e(this,n),this.elementRef=t,this.renderer=i,this.hidden=null,this.renderer.setAttribute(this.elementRef.nativeElement,"hidden","")}return t(n,[{key:"setHiddenAttribute",value:function(){this.hidden?this.renderer.setAttribute(this.elementRef.nativeElement,"hidden","string"==typeof this.hidden?this.hidden:""):this.renderer.removeAttribute(this.elementRef.nativeElement,"hidden")}},{key:"ngOnChanges",value:function(){this.setHiddenAttribute()}},{key:"ngAfterViewInit",value:function(){this.setHiddenAttribute()}}]),n}()).\u0275fac=function(e){return new(e||o)(u.\u0275\u0275directiveInject(u.ElementRef),u.\u0275\u0275directiveInject(u.Renderer2))},o.\u0275dir=u.\u0275\u0275defineDirective({type:o,selectors:[["","dw-button",""],["dw-button-group"],["","dw-icon",""],["","dw-menu-item",""],["","dw-submenu",""],["dw-select-top-control"],["dw-select-placeholder"],["dw-input-group"]],inputs:{hidden:"hidden"},features:[u.\u0275\u0275NgOnChangesFeature]}),o),a=function(){var n=t(function n(){e(this,n)});return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=u.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=u.\u0275\u0275defineInjector({imports:[[c.PlatformModule]]}),n}()}}])}();