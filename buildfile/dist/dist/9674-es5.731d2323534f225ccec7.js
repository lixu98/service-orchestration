!function(){"use strict";function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(!e)return;if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,r)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(self.webpackChunkassc_crs=self.webpackChunkassc_crs||[]).push([[9674,8764],{69674:function(t,r,o){o.r(r),o.d(r,{DW_ORGTREE_MODAL_DEFAULT:function(){return c},DwOrganizeTreeCoreModule:function(){return u},DwOrganizeTreeService:function(){return p}});var a,l=o(42746),d=o(71049),s=o(55245),c=new l.InjectionToken("dwSystemConfig.dwOrgTreeModalDefault",{providedIn:"root",factory:function(){return{}}}),u=((a=n(function e(){i(this,e)})).\u0275fac=function(e){return new(e||a)},a.\u0275mod=l.\u0275\u0275defineNgModule({type:a}),a.\u0275inj=l.\u0275\u0275defineInjector({imports:[[s.CommonModule]]}),a),p=function(){var t=function(){function t(e){i(this,t),this.openOrgTreeModalDefault=e,this._cache={},this._fullNodesRoot=[{type:"org",id:"A00001",sid:100001,title:"\u9f0e\u6377\uff08\u5357\u4eac\uff09",children:[{type:"org",id:"AA0001",title:"\u670d\u52d9\u90e8",sid:100002},{type:"org",id:"AB0001",title:"\u958b\u767c\u90e8",sid:100003,children:[{type:"org",id:"ABA001",title:"\u958b\u767c\u7d44",sid:100011,children:[{type:"user",id:"ABA001",title:"\u6c88\u6d77",sid:100001},{type:"user",id:"ABA002",title:"\u6c5f\u6cb3",sid:100006}]},{type:"org",id:"ABA002",title:"\u6e2c\u8a66\u7d44",sid:100012,children:[{type:"user",key:"ABA005",title:"\u6e56\u6708",sid:100007}]},{type:"user",id:"ABA003",title:"\u6c6a\u6d0b",sid:100005}]},{type:"org",id:"AC0002",title:"\u61c9\u7528\u90e8",sid:100004,children:[{type:"user",id:"AC0001",title:"\u674e\u5fd7\u6c5f",sid:100002},{type:"user",id:"AC0002",title:"\u674e\u658c",sid:100003},{type:"user",id:"AC0003",title:"\u738b\u6b23",sid:100004}]}]}],this._fullNodes=[{type:"org",id:"AA0001",title:"\u670d\u52d9\u90e8",sid:100002},{type:"org",id:"AB0001",title:"\u958b\u767c\u90e8",sid:100003,children:[{type:"org",id:"ABA001",title:"\u958b\u767c\u7d44",sid:100011,children:[{type:"user",id:"ABA001",title:"\u6c88\u6d77",sid:100001},{type:"user",id:"ABA002",title:"\u6c5f\u6cb3",sid:100006}]},{type:"org",id:"ABA002",title:"\u6e2c\u8a66\u7d44",sid:100012,children:[{type:"user",id:"ABA005",title:"\u6e56\u6708",sid:100007}]},{type:"user",id:"ABA003",title:"\u6c6a\u6d0b",sid:100005}]},{type:"org",id:"AC0002",title:"\u61c9\u7528\u90e8",sid:100004,children:[{type:"user",id:"AC0001",title:"\u674e\u5fd7\u6c5f",sid:100002},{type:"user",id:"AC0002",title:"\u674e\u658c",sid:100003},{type:"user",id:"AC0003",title:"\u738b\u6b23",sid:100004}]}],this._orgNodes=[{type:"org",id:"A00001",sid:100001,title:"\u9f0e\u6377\uff08\u5357\u4eac\uff09",children:[{type:"org",id:"AA0001",title:"\u670d\u52d9\u90e8",sid:100002},{type:"org",id:"AB0001",title:"\u958b\u767c\u90e8",sid:100003,children:[{type:"org",id:"ABA001",title:"\u958b\u767c\u7d44",sid:100011,children:[]},{type:"org",id:"ABA002",title:"\u6e2c\u8a66\u7d44",sid:100012}]},{type:"org",id:"AC0002",title:"\u61c9\u7528\u90e8",sid:100004,children:[]}]}],this.sortFn=function(e,t,r){return e.type===r&&t.type!==r?-1:e.type!==r&&t.type===r?1:0}}return n(t,[{key:"getVirtualRootnode",value:function(){return Object.assign({},{type:"root",key:null,title:null,sid:null,parentKey:null,parentTitle:null,parentSid:null,children:[]})}},{key:"initTreeDatas",value:function(t,r){var n,i=this,o=JSON.parse(JSON.stringify(r)),a=this.getVirtualRootnode();return(n=a.children).push.apply(n,e(o)),a.children.sort(function(e,r){return i.sortFn(e,r,t.sortType)}),a.children.forEach(function(e){i.initNode(t,e,a)}),a.children}},{key:"initNode",value:function(e,t,r){var n=this;if(Object.assign(t,{sid:t.sid.toString(),key:this.initNodeKey(e,t,r),parentKey:r.key,parentTitle:r.title,parentSid:r.sid?r.sid.toString():r.sid,expanded:t.hasOwnProperty("expanded")?t.expanded:e.expandAll,isLeaf:!1}),"org"===t.type&&"full"===e.dataType&&"user"===e.selectType&&Object.assign(t,{disabled:!0}),"org"===t.type&&(!t.hasOwnProperty("children")||0===t.children.length)&&Object.assign(t,{expanded:!1,isLeaf:!0}),"user"===t.type&&Object.assign(t,{expanded:!1,icon:"user",isLeaf:!0}),t.hasOwnProperty("children")&&t.children.length>0){t.children.sort(function(t,r){return n.sortFn(t,r,e.sortType)});for(var i=0;i<t.children.length;i++)this.initNode(e,t.children[i],t)}}},{key:"initNodeKey",value:function(e,t,r){return t.type+("org"===t.type?t.sid:r.sid)+"-"+("id"===e.keyType?t.id:t.sid)}},{key:"setCache",value:function(e,t){var r=this.getTreeDataMode(e),n=this.initTreeDatas(r,t),i=this.getCacheKeys(r);this._cache[i]=n}},{key:"getCache",value:function(e){var t=this.getTreeDataMode(e),r=this.getCacheKeys(t);return this._cache[r]?this._cache[r]:[]}},{key:"getOrganizeTree",value:function(e){var t=this;return new d.Observable(function(r){var n=t.getCache(e);if(n.length>0)return r.next(n),void r.complete();t.setCache(e,"full"===e.dataType?t._fullNodes:t._orgNodes),r.next(t.getCache(e)),r.complete()})}},{key:"getCombinedKey",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.key,n=e.type,i="org"===n?e.sid:e.parentSid;return t&&(r=e.parentKey,i=e.parentSid,n="org"),r&&n+i+"-"+r}},{key:"replaceKey",value:function(e){return e&&e.split("-")[1]}},{key:"getKeys",value:function(e){var t=this,r=[];return 0===e.length||e.forEach(function(e){r.push(t.getCombinedKey(e))}),r}},{key:"getTreeDataMode",value:function(e){return Object.assign({},{dataType:this.openOrgTreeModalDefault.treeDataType,keyType:this.openOrgTreeModalDefault.treeKeyType,selectType:this.openOrgTreeModalDefault.treeSelectType,expandAll:this.openOrgTreeModalDefault.treeExpandAll},e)}},{key:"getNodeLists",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getTreeDataMode(r);return new d.Observable(function(r){if(!e||0===e.length)return r.next([]),void r.complete();t.getOrganizeTree(n).subscribe(function(n){var i=t.getMatchNodes(e,n);r.next(t.convertToList(i)),r.complete()})})}},{key:"getMatchNodes",value:function(t,r){var n=[],i=[],o=JSON.parse(JSON.stringify(r)),a=this.getKeys(t);for(n.push.apply(n,e(o));0!==n.length;){var l=n.pop();if(a.indexOf(l.key)>=0&&i.push(l),l.hasOwnProperty("children")&&l.children.length>0)for(var d=l.children.length-1;d>=0;d--)n.push(l.children[d])}return i}},{key:"convertToList",value:function(t){var r=[],n=[];for(r.push.apply(r,e(t));0!==r.length;){var i=r.pop();if(n.push(this.getNodeOriginValue(i)),i.hasOwnProperty("children")&&i.children.length>0)for(var o=i.children.length-1;o>=0;o--)r.push(i.children[o])}return n}},{key:"convertedTotree",value:function(e){var t=this,r=JSON.parse(JSON.stringify(e));r.forEach(function(e){Object.assign(e,{key:t.getCombinedKey(e),parentKey:t.getCombinedKey(e,!0)})});for(var n=[],i=[],o=0;o<r.length;o++)n[r[o].key]=o,"org"===r[o].type&&(r[o].children=[]);for(var a=0;a<r.length;a++){var l=r[a];l.parentKey&&void 0!==n[l.parentKey]&&l.parentKey!==l.key?r[n[l.parentKey]].children.push(l):i.push(l)}return this.convertedtreeDatas(i)}},{key:"convertedtreeDatas",value:function(t){var r,n=this,i=this.getVirtualRootnode();return(r=i.children).push.apply(r,e(t)),i.children.forEach(function(e){n.convertedtreeNode(e)}),i.children}},{key:"convertedtreeNode",value:function(e){if(Object.assign(e,{key:this.replaceKey(e.key),parentKey:this.replaceKey(e.parentKey)}),e.hasOwnProperty("children")&&e.children.length>0)for(var t=0;t<e.children.length;t++)this.convertedtreeNode(e.children[t])}},{key:"getNodeOriginValue",value:function(e){return Object.assign({},{type:e.type,key:this.replaceKey(e.key),title:e.title,id:e.id,sid:e.sid,parentKey:this.replaceKey(e.parentKey),parentTitle:e.parentTitle,parentSid:e.parentSid})}},{key:"resetCache",value:function(){this._cache={}}},{key:"reloadCache",value:function(e){return this.resetCache(),this._fullNodes=this._fullNodesRoot,this.getOrganizeTree(e)}},{key:"getCacheKeys",value:function(e){return e.dataType+"-"+e.keyType+"-"+e.selectType+"-"+e.expandAll.toString()}},{key:"setExpandTreeNodes",value:function(t,r){var n=[];for(n.push.apply(n,e(t));0!==n.length;){var i=n.pop();if(+i.level<=+r&&(i.isExpanded=!0),i.hasOwnProperty("children")&&i.children.length>0)for(var o=i.children.length-1;o>=0;o--)n.push(i.children[o])}}}]),t}();return t.\u0275fac=function(e){return new(e||t)(l.\u0275\u0275inject(c))},t.\u0275prov=l.\u0275\u0275defineInjectable({factory:function(){return new t(l.\u0275\u0275inject(c))},token:t,providedIn:u}),t}()}}])}();