"use strict";(self.webpackChunkassc_crs=self.webpackChunkassc_crs||[]).push([[122],{87017:function(e,t,r){r.r(t),r.d(t,{DwDefaultAppGuardService:function(){return j},DwDefaultAppModule:function(){return g},DwDefaultAppRepository:function(){return b},DwDefaultAppRouterService:function(){return h},DwLanguagePreService:function(){return w},DwProgramExecuteService:function(){return I},DwProgramInfoLangLoaderService:function(){return m},DwProgramInfoModule:function(){return v}});var n=r(42746),i=r(87974),o=r(71049),c=r(20033),u=r(30469),a=r(47372),s=r(66800),p=r(55245),f=r(83522),l=r(32276),d=r(32245);let g=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=n.\u0275\u0275defineInjector({imports:[[p.CommonModule,f.TranslateModule]]}),e})(),b=(()=>{class e{constructor(){}createInfo(){return{execType:null,programId:"",queryParams:{},routerLink:null}}getMyHomeInfo(e){return this.getMyHomeInfoNull()}getMyHomeInfoNull(){return o.Observable.create(e=>{const t=this.createInfo();e.next(t),e.complete()})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=n.\u0275\u0275defineInjectable({factory:function(){return new e},token:e,providedIn:g}),e})(),h=(()=>{class e{constructor(e,t,r,n){this.DEFAULT_APP=e,this.dwDefaultAppRepository=t,this.dwOperationInfoService=r,this.dwTenantService=n,this.defaultAppRouterLinkSubject=new o.BehaviorSubject(null),this.dwTenantService.isTokenValid$.pipe((0,a.switchMap)(e=>e?this.dwDefaultAppRepository.getMyHomeInfo(""):o.Observable.create(e=>{e.next(null),e.complete()}),(e,t)=>t)).subscribe(e=>{this.defaultAppRouterLinkSubject.next(e)})}get defaultAppRouterLink$(){return o.Observable.create(e=>{this.defaultAppInfo$.subscribe(t=>{let r=t.routerLink;t.execType?this.dwOperationInfoService.operationInfo$(t.programId,t.execType).subscribe(n=>{if(n.routerLink){r=n.routerLink;const e=t.queryParams;let i="";Object.keys(e).forEach(t=>{i=i+"&"+t+"="+e[t]}),r&&i&&(r=r+"?"+i.substr(1,i.length))}e.next(r),e.complete()}):(e.next(r),e.complete())})})}get defaultAppInfo$(){return o.Observable.create(e=>{let t=null;t=this.defaultAppRouterLinkSubject.subscribe(r=>{if(r){const n=JSON.parse(JSON.stringify(r));r.execType||(n.routerLink=this.DEFAULT_APP),e.next(n),e.complete(),t&&t.unsubscribe()}})})}}return e.\u0275fac=function(t){return new(t||e)(n.\u0275\u0275inject(u.APP_DEFAULT),n.\u0275\u0275inject(b),n.\u0275\u0275inject(c.DwOperationInfoService),n.\u0275\u0275inject(s.DwTenantService))},e.\u0275prov=n.\u0275\u0275defineInjectable({factory:function(){return new e(n.\u0275\u0275inject(u.APP_DEFAULT),n.\u0275\u0275inject(b),n.\u0275\u0275inject(c.DwOperationInfoService),n.\u0275\u0275inject(s.DwTenantService))},token:e,providedIn:g}),e})(),v=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=n.\u0275\u0275defineInjector({imports:[[p.CommonModule],g]}),e})(),w=(()=>{class e{constructor(){this.languagePre={menu:"menu.",program:"prog.",page:"page."}}get menu(){return this.languagePre.menu}get program(){return this.languagePre.program}get page(){return this.languagePre.page}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=n.\u0275\u0275defineInjectable({factory:function(){return new e},token:e,providedIn:v}),e})(),I=(()=>{class e{constructor(e,t,r,n,i,c){this.router=e,this.activatedRoute=t,this._usingTab=r,this.dwLanguagePreService=n,this.dwOperationInfoService=i,this.dwDefaultAppRouterService=c,this.executeTabProgram$=new o.Subject}byId(e,t){""!==e&&this.dwOperationInfoService.operationInfo$(e).subscribe(r=>{this.exec("",e,r.type,r.routerLink,t)}).unsubscribe()}byMenu(e,t,r,n){""!==t&&(r||(r=t),""!==r&&this.dwOperationInfoService.operationInfo$(r,e).subscribe(i=>{i.routerLink&&this.exec(e,r,i.type,i.routerLink,n,this.dwLanguagePreService.menu+t,t)}).unsubscribe())}exec(e,t,r,n,i,o,c){return""!==t&&(this._usingTab?(c||(c=""),"externalUrl"===r&&(e=r),this.executeTabProgram$.next({type:e,id:t,title:o,menuId:c,routerLink:n,queryParams:i})):this.router.navigate([n],{relativeTo:this.activatedRoute,queryParams:i}),!0)}goHome(e){this.dwDefaultAppRouterService.defaultAppInfo$.subscribe(t=>{if(t.programId){const r=t.programId,n=t.execType,i=Object.assign({},t.queryParams);e&&Object.keys(e).forEach(r=>{let n=!1;Object.keys(t.queryParams).forEach(e=>{e===r&&(n=!0)}),n||(i[r]=e[r])}),""!==r&&this.dwOperationInfoService.operationInfo$(r,n).subscribe(e=>{e.routerLink&&this.router.navigate([e.routerLink],{relativeTo:this.activatedRoute,queryParams:i})}).unsubscribe()}else this.router.navigateByUrl(t.routerLink)})}}return e.\u0275fac=function(t){return new(t||e)(n.\u0275\u0275inject(i.Router),n.\u0275\u0275inject(i.ActivatedRoute),n.\u0275\u0275inject(u.DW_USING_TAB),n.\u0275\u0275inject(w),n.\u0275\u0275inject(c.DwOperationInfoService),n.\u0275\u0275inject(h))},e.\u0275prov=n.\u0275\u0275defineInjectable({factory:function(){return new e(n.\u0275\u0275inject(i.Router),n.\u0275\u0275inject(i.ActivatedRoute),n.\u0275\u0275inject(u.DW_USING_TAB),n.\u0275\u0275inject(w),n.\u0275\u0275inject(c.DwOperationInfoService),n.\u0275\u0275inject(h))},token:e,providedIn:v}),e})(),m=(()=>{class e{constructor(e,t){this.languageI18nRepository=e,this.authService=t}getTranslation(e){const t=this.authService.isLoggedIn,r=new o.Subject;return t?this.languageI18nRepository.basic(e).subscribe(e=>{r.next(e.prog?e.prog:{}),r.complete()}):r.complete(),r.asObservable()}}return e.\u0275fac=function(t){return new(t||e)(n.\u0275\u0275inject(d.DwLanguageI18nRepository),n.\u0275\u0275inject(l.DwAuthService))},e.\u0275prov=n.\u0275\u0275defineInjectable({factory:function(){return new e(n.\u0275\u0275inject(d.DwLanguageI18nRepository),n.\u0275\u0275inject(l.DwAuthService))},token:e,providedIn:v}),e})(),j=(()=>{class e{constructor(e,t){this.defaultAppRouterService=e,this.dwProgramExecuteService=t}canActivate(e,t){return o.Observable.create(e=>{this.defaultAppRouterService.defaultAppRouterLink$.subscribe(r=>{const n=t.url.split("?"),i=n[0],o={};2===n.length&&n[1].split("&").forEach(e=>{const t=e.split("=");2===t.length?o[t[0]]=t[1]:1===t.length&&(o[t[0]]="")}),i===r?e.next(!0):(this.dwProgramExecuteService.goHome(o),e.next(!1)),e.complete()})})}}return e.\u0275fac=function(t){return new(t||e)(n.\u0275\u0275inject(h),n.\u0275\u0275inject(I))},e.\u0275prov=n.\u0275\u0275defineInjectable({factory:function(){return new e(n.\u0275\u0275inject(h),n.\u0275\u0275inject(I))},token:e,providedIn:g}),e})()}}]);