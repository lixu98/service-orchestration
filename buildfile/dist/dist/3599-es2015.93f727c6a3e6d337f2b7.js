"use strict";(self.webpackChunkassc_crs=self.webpackChunkassc_crs||[]).push([[3599,3748],{93599:function(e,t,n){n.r(t),n.d(t,{DwAnnouncementModalComponent:function(){return f},DwAnnouncementModalService:function(){return E},DwAnnouncementModule:function(){return b},DwAnnouncementRepository:function(){return y},DwAnnouncementService:function(){return I}});var i=n(31441),r=n(42746),o=n(59083),s=n(30469),d=n(96709),a=n(55245),l=n(83522),c=n(74591),u=n(93761),h=n(1020),m=n(71049),g=n(62481),p=n(96670),v=n(8852);let f=(()=>{class e{constructor(e,t){this._sanitizer=e,this.modalSubject=t,this.isIgnore=!1}set description(e){this._description=this._sanitizer.bypassSecurityTrustHtml(e)}get description(){return this._description}close(){this.modalSubject.destroy(this.isIgnore)}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275directiveInject(o.DomSanitizer),r.\u0275\u0275directiveInject(i.DwModalRef))},e.\u0275cmp=r.\u0275\u0275defineComponent({type:e,selectors:[["dw-announcement-modal"]],inputs:{description:"description"},decls:10,vars:8,consts:[[3,"innerHtml"],[2,"padding-top","20px"],["dw-button","","dwType","primary",3,"click"],["dw-checkbox","",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(r.\u0275\u0275elementStart(0,"div"),r.\u0275\u0275element(1,"div",0),r.\u0275\u0275elementStart(2,"div",1),r.\u0275\u0275elementStart(3,"button",2),r.\u0275\u0275listener("click",function(){return t.close()}),r.\u0275\u0275text(4),r.\u0275\u0275pipe(5,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275text(6," \xa0\xa0"),r.\u0275\u0275elementStart(7,"label",3),r.\u0275\u0275listener("ngModelChange",function(e){return t.isIgnore=e}),r.\u0275\u0275text(8),r.\u0275\u0275pipe(9,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd()),2&e&&(r.\u0275\u0275advance(1),r.\u0275\u0275property("innerHtml",t.description,r.\u0275\u0275sanitizeHtml),r.\u0275\u0275advance(3),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(5,4,"dw-announcement-got-it")),r.\u0275\u0275advance(3),r.\u0275\u0275property("ngModel",t.isIgnore),r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(9,6,"dw-announcement-never-show-again")))},directives:[u.DwButtonComponent,p.uG,v.u,c.DwCheckboxComponent,h.NgControlStatus,h.NgModel],pipes:[l.TranslatePipe],styles:[""]}),e})();const w=[];let b=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=r.\u0275\u0275defineInjector({providers:[...w],imports:[[a.CommonModule,l.TranslateModule,c.DwCheckboxModule,i.DwModalModule,u.DwButtonModule,h.FormsModule]]}),e})(),y=(()=>{class e{constructor(e,t){this.dwAppId=e,this.http=t}getActiveAnnouncement(e){return this.http.get("restful/service/DWSysManagement/Announcement/ActiveAnnouncement",{params:{goodsCode:this.dwAppId,displayId:e}})}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275inject(s.DW_APP_ID),r.\u0275\u0275inject(d.DwOmHttpClient))},e.\u0275prov=r.\u0275\u0275defineInjectable({factory:function(){return new e(r.\u0275\u0275inject(s.DW_APP_ID),r.\u0275\u0275inject(d.DwOmHttpClient))},token:e,providedIn:b}),e})(),I=(()=>{class e{constructor(e,t,n){this.systemConfigService=e,this.localStorage=t,this.announcementRepository=n}getAnnouncement(e){return m.Observable.create(t=>{this.systemConfigService.get("multiTenant").subscribe(n=>{!0===n?this.announcementRepository.getActiveAnnouncement(e).subscribe(e=>{if(e.data&&e.data.length){const n=e.data[0];this.getIgnoreList().filter(e=>e.id===n.id).length?t.next(null):t.next(n)}else t.next(null)}):t.next(null)},e=>{t.next(null)})})}getIgnoreList(){let e=[],t=this.localStorage.get("dwAnnouncementIgnore");return t&&(t=JSON.parse(t),Array.isArray(t)&&(e=t)),e}setIgnore(e){let t=this.getIgnoreList();const n=t.findIndex(t=>t.displayId===e.displayId);-1!==n?t[n]=e:t.push(e),t=t.filter(e=>new Date(e.expires)>new Date),this.localStorage.set("dwAnnouncementIgnore",JSON.stringify(t))}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275inject(s.DwSystemConfigService),r.\u0275\u0275inject(g.LocalStorage),r.\u0275\u0275inject(y))},e.\u0275prov=r.\u0275\u0275defineInjectable({factory:function(){return new e(r.\u0275\u0275inject(s.DwSystemConfigService),r.\u0275\u0275inject(g.LocalStorage),r.\u0275\u0275inject(y))},token:e,providedIn:b}),e})(),E=(()=>{class e{constructor(e,t){this.dwModalService=e,this.announcementService=t}displayAnnouncement(e,t="730"){return m.Observable.create(n=>{this.announcementService.getAnnouncement(e).subscribe(i=>{i?(this._postModal=this.dwModalService.create({dwContent:f,dwWidth:t,dwFooter:null,dwClosable:!1,dwMaskClosable:!1,dwOnOk:e=>{},dwOnCancel(){},dwComponentParams:{description:i.description}}),this._postModal.afterClose.subscribe(t=>{t&&this.announcementService.setIgnore({displayId:e,id:i.id,expires:i.endDate}),n.next(!0)})):n.next(!0)})})}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275inject(i.DwModalService),r.\u0275\u0275inject(I))},e.\u0275prov=r.\u0275\u0275defineInjectable({factory:function(){return new e(r.\u0275\u0275inject(i.DwModalService),r.\u0275\u0275inject(I))},token:e,providedIn:b}),e})()},8852:function(e,t,n){n.d(t,{u:function(){return o},f:function(){return s}});var i=n(36535),r=n(42746);let o=(()=>{class e{constructor(e,t){this.elementRef=e,this.renderer=t,this.hidden=null,this.renderer.setAttribute(this.elementRef.nativeElement,"hidden","")}setHiddenAttribute(){this.hidden?this.renderer.setAttribute(this.elementRef.nativeElement,"hidden","string"==typeof this.hidden?this.hidden:""):this.renderer.removeAttribute(this.elementRef.nativeElement,"hidden")}ngOnChanges(){this.setHiddenAttribute()}ngAfterViewInit(){this.setHiddenAttribute()}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275directiveInject(r.ElementRef),r.\u0275\u0275directiveInject(r.Renderer2))},e.\u0275dir=r.\u0275\u0275defineDirective({type:e,selectors:[["","dw-button",""],["dw-button-group"],["","dw-icon",""],["","dw-menu-item",""],["","dw-submenu",""],["dw-select-top-control"],["dw-select-placeholder"],["dw-input-group"]],inputs:{hidden:"hidden"},features:[r.\u0275\u0275NgOnChangesFeature]}),e})(),s=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=r.\u0275\u0275defineInjector({imports:[[i.PlatformModule]]}),e})()},96670:function(e,t,n){n.d(t,{uG:function(){return l},ln:function(){return c}});var i=n(36535),r=n(42746),o=n(88065);class s{constructor(e,t,n,r){this.triggerElement=e,this.ngZone=t,this.insertExtraNode=n,this.platformId=r,this.waveTransitionDuration=400,this.styleForPseudo=null,this.extraNode=null,this.lastTime=0,this.onClick=e=>{!this.triggerElement||!this.triggerElement.getAttribute||this.triggerElement.getAttribute("disabled")||"INPUT"===e.target.tagName||this.triggerElement.className.indexOf("disabled")>=0||this.fadeOutWave()},this.platform=new i.Platform(this.platformId),this.clickHandler=this.onClick.bind(this),this.bindTriggerEvent()}get waveAttributeName(){return this.insertExtraNode?"ant-click-animating":"ant-click-animating-without-extra-node"}bindTriggerEvent(){this.platform.isBrowser&&this.ngZone.runOutsideAngular(()=>{this.removeTriggerEvent(),this.triggerElement&&this.triggerElement.addEventListener("click",this.clickHandler,!0)})}removeTriggerEvent(){this.triggerElement&&this.triggerElement.removeEventListener("click",this.clickHandler,!0)}removeStyleAndExtraNode(){this.styleForPseudo&&document.body.contains(this.styleForPseudo)&&(document.body.removeChild(this.styleForPseudo),this.styleForPseudo=null),this.insertExtraNode&&this.triggerElement.contains(this.extraNode)&&this.triggerElement.removeChild(this.extraNode)}destroy(){this.removeTriggerEvent(),this.removeStyleAndExtraNode()}fadeOutWave(){const e=this.triggerElement,t=this.getWaveColor(e);e.setAttribute(this.waveAttributeName,"true"),!(Date.now()<this.lastTime+this.waveTransitionDuration)&&(this.isValidColor(t)&&(this.styleForPseudo||(this.styleForPseudo=document.createElement("style")),this.styleForPseudo.innerHTML=`\n      [ant-click-animating-without-extra-node='true']::after, .ant-click-animating-node {\n        --antd-wave-shadow-color: ${t};\n      }`,document.body.appendChild(this.styleForPseudo)),this.insertExtraNode&&(this.extraNode||(this.extraNode=document.createElement("div")),this.extraNode.className="ant-click-animating-node",e.appendChild(this.extraNode)),this.lastTime=Date.now(),this.runTimeoutOutsideZone(()=>{e.removeAttribute(this.waveAttributeName),this.removeStyleAndExtraNode()},this.waveTransitionDuration))}isValidColor(e){return!!e&&"#ffffff"!==e&&"rgb(255, 255, 255)"!==e&&this.isNotGrey(e)&&!/rgba\(\d*, \d*, \d*, 0\)/.test(e)&&"transparent"!==e}isNotGrey(e){const t=e.match(/rgba?\((\d*), (\d*), (\d*)(, [\.\d]*)?\)/);return!(t&&t[1]&&t[2]&&t[3]&&t[1]===t[2]&&t[2]===t[3])}getWaveColor(e){const t=getComputedStyle(e);return t.getPropertyValue("border-top-color")||t.getPropertyValue("border-color")||t.getPropertyValue("background-color")}runTimeoutOutsideZone(e,t){this.ngZone.runOutsideAngular(()=>setTimeout(e,t))}}const d={disabled:!1},a=new r.InjectionToken("dw-wave-global-options",{providedIn:"root",factory:function(){return d}});let l=(()=>{class e{constructor(e,t,n,i,r){this.ngZone=e,this.elementRef=t,this.config=n,this.animationType=i,this.platformId=r,this.dwWaveExtraNode=!1,this.waveDisabled=!1,this.waveDisabled=this.isConfigDisabled()}get disabled(){return this.waveDisabled}get rendererRef(){return this.waveRenderer}isConfigDisabled(){let e=!1;return this.config&&"boolean"==typeof this.config.disabled&&(e=this.config.disabled),"NoopAnimations"===this.animationType&&(e=!0),e}ngOnDestroy(){this.waveRenderer&&this.waveRenderer.destroy()}ngOnInit(){this.renderWaveIfEnabled()}renderWaveIfEnabled(){!this.waveDisabled&&this.elementRef.nativeElement&&(this.waveRenderer=new s(this.elementRef.nativeElement,this.ngZone,this.dwWaveExtraNode,this.platformId))}disable(){this.waveDisabled=!0,this.waveRenderer&&(this.waveRenderer.removeTriggerEvent(),this.waveRenderer.removeStyleAndExtraNode())}enable(){this.waveDisabled=this.isConfigDisabled()||!1,this.waveRenderer&&this.waveRenderer.bindTriggerEvent()}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275directiveInject(r.NgZone),r.\u0275\u0275directiveInject(r.ElementRef),r.\u0275\u0275directiveInject(a,8),r.\u0275\u0275directiveInject(o.ANIMATION_MODULE_TYPE,8),r.\u0275\u0275directiveInject(r.PLATFORM_ID))},e.\u0275dir=r.\u0275\u0275defineDirective({type:e,selectors:[["","dw-wave",""],["button","dw-button","",3,"dwType","link",3,"dwType","text"]],inputs:{dwWaveExtraNode:"dwWaveExtraNode"},exportAs:["dwWave"]}),e})(),c=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=r.\u0275\u0275defineInjector({imports:[[i.PlatformModule]]}),e})()}}]);