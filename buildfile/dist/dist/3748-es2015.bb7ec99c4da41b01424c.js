"use strict";(self.webpackChunkassc_crs=self.webpackChunkassc_crs||[]).push([[3748],{93599:function(e,t,n){n.r(t),n.d(t,{DwAnnouncementModalComponent:function(){return g},DwAnnouncementModalService:function(){return S},DwAnnouncementModule:function(){return b},DwAnnouncementRepository:function(){return I},DwAnnouncementService:function(){return y}});var i=n(31441),r=n(42746),o=n(59083),s=n(30469),c=n(96709),d=n(55245),a=n(83522),u=n(74591),l=n(93761),p=n(1020),m=n(71049),h=n(62481),f=n(96670),w=n(8852);let g=(()=>{class e{constructor(e,t){this._sanitizer=e,this.modalSubject=t,this.isIgnore=!1}set description(e){this._description=this._sanitizer.bypassSecurityTrustHtml(e)}get description(){return this._description}close(){this.modalSubject.destroy(this.isIgnore)}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275directiveInject(o.DomSanitizer),r.\u0275\u0275directiveInject(i.DwModalRef))},e.\u0275cmp=r.\u0275\u0275defineComponent({type:e,selectors:[["dw-announcement-modal"]],inputs:{description:"description"},decls:10,vars:8,consts:[[3,"innerHtml"],[2,"padding-top","20px"],["dw-button","","dwType","primary",3,"click"],["dw-checkbox","",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(r.\u0275\u0275elementStart(0,"div"),r.\u0275\u0275element(1,"div",0),r.\u0275\u0275elementStart(2,"div",1),r.\u0275\u0275elementStart(3,"button",2),r.\u0275\u0275listener("click",function(){return t.close()}),r.\u0275\u0275text(4),r.\u0275\u0275pipe(5,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275text(6," \xa0\xa0"),r.\u0275\u0275elementStart(7,"label",3),r.\u0275\u0275listener("ngModelChange",function(e){return t.isIgnore=e}),r.\u0275\u0275text(8),r.\u0275\u0275pipe(9,"translate"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementEnd()),2&e&&(r.\u0275\u0275advance(1),r.\u0275\u0275property("innerHtml",t.description,r.\u0275\u0275sanitizeHtml),r.\u0275\u0275advance(3),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(5,4,"dw-announcement-got-it")),r.\u0275\u0275advance(3),r.\u0275\u0275property("ngModel",t.isIgnore),r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(9,6,"dw-announcement-never-show-again")))},directives:[l.DwButtonComponent,f.uG,w.u,u.DwCheckboxComponent,p.NgControlStatus,p.NgModel],pipes:[a.TranslatePipe],styles:[""]}),e})();const v=[];let b=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=r.\u0275\u0275defineInjector({providers:[...v],imports:[[d.CommonModule,a.TranslateModule,u.DwCheckboxModule,i.DwModalModule,l.DwButtonModule,p.FormsModule]]}),e})(),I=(()=>{class e{constructor(e,t){this.dwAppId=e,this.http=t}getActiveAnnouncement(e){return this.http.get("restful/service/DWSysManagement/Announcement/ActiveAnnouncement",{params:{goodsCode:this.dwAppId,displayId:e}})}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275inject(s.DW_APP_ID),r.\u0275\u0275inject(c.DwOmHttpClient))},e.\u0275prov=r.\u0275\u0275defineInjectable({factory:function(){return new e(r.\u0275\u0275inject(s.DW_APP_ID),r.\u0275\u0275inject(c.DwOmHttpClient))},token:e,providedIn:b}),e})(),y=(()=>{class e{constructor(e,t,n){this.systemConfigService=e,this.localStorage=t,this.announcementRepository=n}getAnnouncement(e){return m.Observable.create(t=>{this.systemConfigService.get("multiTenant").subscribe(n=>{!0===n?this.announcementRepository.getActiveAnnouncement(e).subscribe(e=>{if(e.data&&e.data.length){const n=e.data[0];this.getIgnoreList().filter(e=>e.id===n.id).length?t.next(null):t.next(n)}else t.next(null)}):t.next(null)},e=>{t.next(null)})})}getIgnoreList(){let e=[],t=this.localStorage.get("dwAnnouncementIgnore");return t&&(t=JSON.parse(t),Array.isArray(t)&&(e=t)),e}setIgnore(e){let t=this.getIgnoreList();const n=t.findIndex(t=>t.displayId===e.displayId);-1!==n?t[n]=e:t.push(e),t=t.filter(e=>new Date(e.expires)>new Date),this.localStorage.set("dwAnnouncementIgnore",JSON.stringify(t))}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275inject(s.DwSystemConfigService),r.\u0275\u0275inject(h.LocalStorage),r.\u0275\u0275inject(I))},e.\u0275prov=r.\u0275\u0275defineInjectable({factory:function(){return new e(r.\u0275\u0275inject(s.DwSystemConfigService),r.\u0275\u0275inject(h.LocalStorage),r.\u0275\u0275inject(I))},token:e,providedIn:b}),e})(),S=(()=>{class e{constructor(e,t){this.dwModalService=e,this.announcementService=t}displayAnnouncement(e,t="730"){return m.Observable.create(n=>{this.announcementService.getAnnouncement(e).subscribe(i=>{i?(this._postModal=this.dwModalService.create({dwContent:g,dwWidth:t,dwFooter:null,dwClosable:!1,dwMaskClosable:!1,dwOnOk:e=>{},dwOnCancel(){},dwComponentParams:{description:i.description}}),this._postModal.afterClose.subscribe(t=>{t&&this.announcementService.setIgnore({displayId:e,id:i.id,expires:i.endDate}),n.next(!0)})):n.next(!0)})})}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275inject(i.DwModalService),r.\u0275\u0275inject(y))},e.\u0275prov=r.\u0275\u0275defineInjectable({factory:function(){return new e(r.\u0275\u0275inject(i.DwModalService),r.\u0275\u0275inject(y))},token:e,providedIn:b}),e})()},8852:function(e,t,n){n.d(t,{u:function(){return o},f:function(){return s}});var i=n(36535),r=n(42746);let o=(()=>{class e{constructor(e,t){this.elementRef=e,this.renderer=t,this.hidden=null,this.renderer.setAttribute(this.elementRef.nativeElement,"hidden","")}setHiddenAttribute(){this.hidden?this.renderer.setAttribute(this.elementRef.nativeElement,"hidden","string"==typeof this.hidden?this.hidden:""):this.renderer.removeAttribute(this.elementRef.nativeElement,"hidden")}ngOnChanges(){this.setHiddenAttribute()}ngAfterViewInit(){this.setHiddenAttribute()}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275directiveInject(r.ElementRef),r.\u0275\u0275directiveInject(r.Renderer2))},e.\u0275dir=r.\u0275\u0275defineDirective({type:e,selectors:[["","dw-button",""],["dw-button-group"],["","dw-icon",""],["","dw-menu-item",""],["","dw-submenu",""],["dw-select-top-control"],["dw-select-placeholder"],["dw-input-group"]],inputs:{hidden:"hidden"},features:[r.\u0275\u0275NgOnChangesFeature]}),e})(),s=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=r.\u0275\u0275defineInjector({imports:[[i.PlatformModule]]}),e})()}}]);