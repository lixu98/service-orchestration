"use strict";(self.webpackChunkassc_crs=self.webpackChunkassc_crs||[]).push([[8423],{8852:function(e,t,n){n.d(t,{u:function(){return a},f:function(){return o}});var r=n(36535),i=n(42746);let a=(()=>{class e{constructor(e,t){this.elementRef=e,this.renderer=t,this.hidden=null,this.renderer.setAttribute(this.elementRef.nativeElement,"hidden","")}setHiddenAttribute(){this.hidden?this.renderer.setAttribute(this.elementRef.nativeElement,"hidden","string"==typeof this.hidden?this.hidden:""):this.renderer.removeAttribute(this.elementRef.nativeElement,"hidden")}ngOnChanges(){this.setHiddenAttribute()}ngAfterViewInit(){this.setHiddenAttribute()}}return e.\u0275fac=function(t){return new(t||e)(i.\u0275\u0275directiveInject(i.ElementRef),i.\u0275\u0275directiveInject(i.Renderer2))},e.\u0275dir=i.\u0275\u0275defineDirective({type:e,selectors:[["","dw-button",""],["dw-button-group"],["","dw-icon",""],["","dw-menu-item",""],["","dw-submenu",""],["dw-select-top-control"],["dw-select-placeholder"],["dw-input-group"]],inputs:{hidden:"hidden"},features:[i.\u0275\u0275NgOnChangesFeature]}),e})(),o=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=i.\u0275\u0275defineInjector({imports:[[r.PlatformModule]]}),e})()},96670:function(e,t,n){n.d(t,{uG:function(){return d},ln:function(){return c}});var r=n(36535),i=n(42746),a=n(88065);class o{constructor(e,t,n,i){this.triggerElement=e,this.ngZone=t,this.insertExtraNode=n,this.platformId=i,this.waveTransitionDuration=400,this.styleForPseudo=null,this.extraNode=null,this.lastTime=0,this.onClick=e=>{!this.triggerElement||!this.triggerElement.getAttribute||this.triggerElement.getAttribute("disabled")||"INPUT"===e.target.tagName||this.triggerElement.className.indexOf("disabled")>=0||this.fadeOutWave()},this.platform=new r.Platform(this.platformId),this.clickHandler=this.onClick.bind(this),this.bindTriggerEvent()}get waveAttributeName(){return this.insertExtraNode?"ant-click-animating":"ant-click-animating-without-extra-node"}bindTriggerEvent(){this.platform.isBrowser&&this.ngZone.runOutsideAngular(()=>{this.removeTriggerEvent(),this.triggerElement&&this.triggerElement.addEventListener("click",this.clickHandler,!0)})}removeTriggerEvent(){this.triggerElement&&this.triggerElement.removeEventListener("click",this.clickHandler,!0)}removeStyleAndExtraNode(){this.styleForPseudo&&document.body.contains(this.styleForPseudo)&&(document.body.removeChild(this.styleForPseudo),this.styleForPseudo=null),this.insertExtraNode&&this.triggerElement.contains(this.extraNode)&&this.triggerElement.removeChild(this.extraNode)}destroy(){this.removeTriggerEvent(),this.removeStyleAndExtraNode()}fadeOutWave(){const e=this.triggerElement,t=this.getWaveColor(e);e.setAttribute(this.waveAttributeName,"true"),!(Date.now()<this.lastTime+this.waveTransitionDuration)&&(this.isValidColor(t)&&(this.styleForPseudo||(this.styleForPseudo=document.createElement("style")),this.styleForPseudo.innerHTML=`\n      [ant-click-animating-without-extra-node='true']::after, .ant-click-animating-node {\n        --antd-wave-shadow-color: ${t};\n      }`,document.body.appendChild(this.styleForPseudo)),this.insertExtraNode&&(this.extraNode||(this.extraNode=document.createElement("div")),this.extraNode.className="ant-click-animating-node",e.appendChild(this.extraNode)),this.lastTime=Date.now(),this.runTimeoutOutsideZone(()=>{e.removeAttribute(this.waveAttributeName),this.removeStyleAndExtraNode()},this.waveTransitionDuration))}isValidColor(e){return!!e&&"#ffffff"!==e&&"rgb(255, 255, 255)"!==e&&this.isNotGrey(e)&&!/rgba\(\d*, \d*, \d*, 0\)/.test(e)&&"transparent"!==e}isNotGrey(e){const t=e.match(/rgba?\((\d*), (\d*), (\d*)(, [\.\d]*)?\)/);return!(t&&t[1]&&t[2]&&t[3]&&t[1]===t[2]&&t[2]===t[3])}getWaveColor(e){const t=getComputedStyle(e);return t.getPropertyValue("border-top-color")||t.getPropertyValue("border-color")||t.getPropertyValue("background-color")}runTimeoutOutsideZone(e,t){this.ngZone.runOutsideAngular(()=>setTimeout(e,t))}}const s={disabled:!1},l=new i.InjectionToken("dw-wave-global-options",{providedIn:"root",factory:function(){return s}});let d=(()=>{class e{constructor(e,t,n,r,i){this.ngZone=e,this.elementRef=t,this.config=n,this.animationType=r,this.platformId=i,this.dwWaveExtraNode=!1,this.waveDisabled=!1,this.waveDisabled=this.isConfigDisabled()}get disabled(){return this.waveDisabled}get rendererRef(){return this.waveRenderer}isConfigDisabled(){let e=!1;return this.config&&"boolean"==typeof this.config.disabled&&(e=this.config.disabled),"NoopAnimations"===this.animationType&&(e=!0),e}ngOnDestroy(){this.waveRenderer&&this.waveRenderer.destroy()}ngOnInit(){this.renderWaveIfEnabled()}renderWaveIfEnabled(){!this.waveDisabled&&this.elementRef.nativeElement&&(this.waveRenderer=new o(this.elementRef.nativeElement,this.ngZone,this.dwWaveExtraNode,this.platformId))}disable(){this.waveDisabled=!0,this.waveRenderer&&(this.waveRenderer.removeTriggerEvent(),this.waveRenderer.removeStyleAndExtraNode())}enable(){this.waveDisabled=this.isConfigDisabled()||!1,this.waveRenderer&&this.waveRenderer.bindTriggerEvent()}}return e.\u0275fac=function(t){return new(t||e)(i.\u0275\u0275directiveInject(i.NgZone),i.\u0275\u0275directiveInject(i.ElementRef),i.\u0275\u0275directiveInject(l,8),i.\u0275\u0275directiveInject(a.ANIMATION_MODULE_TYPE,8),i.\u0275\u0275directiveInject(i.PLATFORM_ID))},e.\u0275dir=i.\u0275\u0275defineDirective({type:e,selectors:[["","dw-wave",""],["button","dw-button","",3,"dwType","link",3,"dwType","text"]],inputs:{dwWaveExtraNode:"dwWaveExtraNode"},exportAs:["dwWave"]}),e})(),c=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=i.\u0275\u0275defineInjector({imports:[[r.PlatformModule]]}),e})()},53771:function(e,t,n){n.d(t,{v:function(){return s}});var r=n(51156),i=n(47372),a=n(65134),o=n(42746);let s=(()=>{class e{constructor(e,t){this.http=e,this.pctHttp=t}getCustomerList(e,t){return this.http.get(`restful/service/customer/Customer/Customer?code=${e}&name=${t}`).pipe((0,i.map)(e=>e))}deleteCustomer(e){return this.http.delete("restful/service/customer/Customer/BathRemove",{body:{ids:e.join(",")}})}getQuery(e){return this.http.get(`restful/service/customer/Customer/CustomerSearch?param=${e}`).pipe((0,i.map)(e=>e))}getIntegratedEnableStatus(){return this.pctHttp.get("restful/service/integratedSettings/IntegratedSettings/IntegratedEnableStatus")}}return e.\u0275fac=function(t){return new(t||e)(o.\u0275\u0275inject(r.DwDapHttpClient),o.\u0275\u0275inject(a.k))},e.\u0275prov=o.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},98423:function(e,t,n){n.r(t),n.d(t,{QuotationModule:function(){return on}});var r=n(55245),i=n(23938),a=n(87974),o=n(32276),s=n(42746);let l=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.\u0275\u0275defineComponent({type:e,selectors:[["app-quotation"]],decls:1,vars:0,template:function(e,t){1&e&&s.\u0275\u0275element(0,"router-outlet")},directives:[a.RouterOutlet],styles:[""]}),e})();var d=n(83237),c=n(31441),m=n(1020),p=n(51156),u=n(65134);let h=(()=>{class e{constructor(e,t,n){this.dapHttp=e,this.pctHttp=t,this.datePipe=n}getQuotationList(e){const t=encodeURIComponent(JSON.stringify(e));return this.dapHttp.get(`restful/service/quotation/Quotation/QuotationListForBackendPaging?params=${t}`)}getQuotationDocNo(){return this.dapHttp.get("restful/service/quotation/Quotation/QuotationDocNo")}approveQuotation(e){return this.dapHttp.get("restful/service/quotation/Quotation/ApproveQuotation?id="+e)}deleteQuotation(e){return this.dapHttp.delete("restful/service/quotation/Quotation/Quotation",{body:{id:e[0]}})}getQuotationDetail(e){return this.dapHttp.get(`restful/service/quotation/Quotation/Quotation?id=${e}`)}getMaterialGroups(e){return this.dapHttp.get(`restful/service/itemGroup/ItemGroup/${e}`)}getMaterialList(e){return this.dapHttp.get(`restful/service/material/Material/${e}`)}create(e){return this.dapHttp.post("restful/service/quotation/Quotation/Create",{params:e})}getTransactionType(){return this.dapHttp.get("restful/service/quoteType/QuoteType/QuoteTypeListOpen")}getWarehouseList(){return this.pctHttp.get("restful/service/warehouse/Warehouse/UserWarehouse?selected_warehouse_ids=&zbSearchSelf=true")}getQuotationInfo(e){return this.dapHttp.get(`restful/service/quotation/Quotation/QuotationDetail?id=${e}`)}modify(e,t){const n=this.createDwDataSet(e,t,"U");return this.dapHttp.put("restful/service/quotation/Quotation/Modify",n)}quote(e,t){const n=this.createDwDataSet(e,t,"U");return this.dapHttp.post("restful/service/quotation/QuickWearPart/QuickWearPartsQuotation",n)}disapprove(e){return this.dapHttp.put("restful/service/quotation/Quotation/QuotationDisApprove",{quotationId:e})}getServiceOrderListForQuotation(e){const t=encodeURIComponent(JSON.stringify(e));return this.dapHttp.get(`restful/service/serviceOrder/ServiceOrder/ServiceOrderListForQuotation?params=${t}`)}getServiceOrderByIdForOpener(e){return this.dapHttp.get(`restful/service/serviceOrder/ServiceOrder/ServiceOrderByIdForOpener?id=${e}`)}getQuotationStatus(e){return this.dapHttp.get(`restful/service/quotation/QuickWearPart/QuotationStatus?quotationId=${e}`)}createDwDataSet(e,t,n){const r={};return Object.assign(r,e),r.$state=n,r.quotation_id=t,{dataSet:{quotation:r}}}}return e.\u0275fac=function(t){return new(t||e)(s.\u0275\u0275inject(p.DwDapHttpClient),s.\u0275\u0275inject(u.k),s.\u0275\u0275inject(r.DatePipe))},e.\u0275prov=s.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var g=n(9682);let f=(()=>{class e{constructor(e,t){this.dwHttp=e,this.selectModalService=t,this.config={modalTitle:"\u9009\u62e9\u5ba2\u6237",modalWidth:"40%",tableMultiSelect:!0,tableIdField:"customer_id",tableNameField:"customer_name",returnFields:["customer_code","customer_name"],tablePageSize:10,tableColDefs:[{title:"\u5ba2\u6237\u7f16\u53f7",field:"customer_code"},{title:"\u5ba2\u6237\u540d\u79f0",field:"customer_name"}],tableCustomTag:e=>"("+e.customer_code+")"+e.customer_name,dataSource:new g.ApiServerPagingService(this.dwHttp,"restful/service/customer/Customer/List","customer",["customer_code","customer_name"])}}open(e){return this.selectModalService.open(this.config,e)}}return e.\u0275fac=function(t){return new(t||e)(s.\u0275\u0275inject(p.DwDapHttpClient),s.\u0275\u0275inject(g.DwSelectModalService))},e.\u0275prov=s.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac}),e})();var v=n(53771),w=n(29872),S=n(62695),_=n(83522);function x(e,t){1&e&&(s.\u0275\u0275elementStart(0,"div",6),s.\u0275\u0275text(1,"\u586b\u5355\u4eba\u5458\uff1a"),s.\u0275\u0275elementEnd())}function y(e,t){1&e&&(s.\u0275\u0275elementStart(0,"div",6),s.\u0275\u0275text(1,"\u62a5\u4ef7\u4eba\u5458\uff1a"),s.\u0275\u0275elementEnd())}function E(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"div",3),s.\u0275\u0275elementStart(1,"div",6),s.\u0275\u0275text(2,"\u8054\u7cfb\u4eba\uff1a"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(3,"div",5),s.\u0275\u0275text(4),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()),2&e){const e=s.\u0275\u0275nextContext();s.\u0275\u0275advance(4),s.\u0275\u0275textInterpolate(e.quotationInfo.contact)}}function C(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"div",3),s.\u0275\u0275elementStart(1,"div",6),s.\u0275\u0275text(2,"\u670d\u52a1\u5de5\u5355\uff1a"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(3,"div",5),s.\u0275\u0275text(4),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()),2&e){const e=s.\u0275\u0275nextContext();s.\u0275\u0275advance(4),s.\u0275\u0275textInterpolate(e.quotationInfo.service_order_no)}}function b(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"div",3),s.\u0275\u0275elementStart(1,"div",6),s.\u0275\u0275text(2,"\u8054\u7cfb\u7535\u8bdd\uff1a"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(3,"div",5),s.\u0275\u0275text(4),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()),2&e){const e=s.\u0275\u0275nextContext();s.\u0275\u0275advance(4),s.\u0275\u0275textInterpolate(e.quotationInfo.contact_number)}}function I(e,t){1&e&&(s.\u0275\u0275elementStart(0,"div",6),s.\u0275\u0275text(1,"\u5e8f\u5217\u53f7\uff1a"),s.\u0275\u0275elementEnd())}function D(e,t){1&e&&(s.\u0275\u0275elementStart(0,"div",6),s.\u0275\u0275text(1,"\u9879\u76ee\u53f7\uff1a"),s.\u0275\u0275elementEnd())}function O(e,t){1&e&&(s.\u0275\u0275elementStart(0,"div",5),s.\u0275\u0275text(1,"\u5df2\u6536\u6b3e"),s.\u0275\u0275elementEnd())}function P(e,t){1&e&&(s.\u0275\u0275elementStart(0,"div",5),s.\u0275\u0275text(1,"\u672a\u6536\u6b3e"),s.\u0275\u0275elementEnd())}function M(e,t){1&e&&(s.\u0275\u0275elementStart(0,"div",5),s.\u0275\u0275text(1,"\u5df2\u5f00\u7968"),s.\u0275\u0275elementEnd())}function T(e,t){1&e&&(s.\u0275\u0275elementStart(0,"div",5),s.\u0275\u0275text(1,"\u672a\u5f00\u7968"),s.\u0275\u0275elementEnd())}function V(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"div",1),s.\u0275\u0275element(1,"div",2),s.\u0275\u0275elementStart(2,"div",3),s.\u0275\u0275elementStart(3,"div",6),s.\u0275\u0275text(4,"ERP\u9500\u552e\u8ba2\u5355\u5355\u53f7\uff1a"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(5,"div",5),s.\u0275\u0275text(6),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(7,"div",3),s.\u0275\u0275elementStart(8,"div",6),s.\u0275\u0275text(9,"\u6536\u6b3e\u72b6\u6001\uff1a"),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(10,O,2,0,"div",20),s.\u0275\u0275template(11,P,2,0,"div",20),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(12,"div",3),s.\u0275\u0275elementStart(13,"div",6),s.\u0275\u0275text(14,"\u5f00\u7968\u72b6\u6001\uff1a"),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(15,M,2,0,"div",20),s.\u0275\u0275template(16,T,2,0,"div",20),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()),2&e){const e=s.\u0275\u0275nextContext();s.\u0275\u0275advance(6),s.\u0275\u0275textInterpolate(e.quotationInfo.erp_so_no),s.\u0275\u0275advance(4),s.\u0275\u0275property("ngIf",e.quotationInfo.erp_collection_status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",!e.quotationInfo.erp_collection_status),s.\u0275\u0275advance(4),s.\u0275\u0275property("ngIf",e.quotationInfo.erp_invoicing_status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",!e.quotationInfo.erp_invoicing_status)}}function k(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"div",21),s.\u0275\u0275text(1," \u8d39\u7528\u5408\u8ba1\uff1a"),s.\u0275\u0275elementStart(2,"span"),s.\u0275\u0275text(3),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()),2&e){const e=s.\u0275\u0275nextContext();s.\u0275\u0275advance(3),s.\u0275\u0275textInterpolate1("\uffe5",e.totalAmount,"")}}function A(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"tr"),s.\u0275\u0275elementStart(1,"td"),s.\u0275\u0275text(2),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(3,"td"),s.\u0275\u0275text(4),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(5,"td"),s.\u0275\u0275text(6),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(7,"td"),s.\u0275\u0275text(8),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(9,"td"),s.\u0275\u0275text(10),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(11,"td",22),s.\u0275\u0275text(12),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(13,"td",22),s.\u0275\u0275text(14),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(15,"td",22),s.\u0275\u0275text(16),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(17,"td"),s.\u0275\u0275text(18),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.item_code," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.item_name," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.item_spec," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.item_model," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.item_unit," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.price," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.quality," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",(e.price*e.quality).toFixed(2)," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.remark," ")}}function F(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"tr"),s.\u0275\u0275elementStart(1,"td"),s.\u0275\u0275text(2),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(3,"td"),s.\u0275\u0275text(4),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(5,"td",22),s.\u0275\u0275text(6),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(7,"td"),s.\u0275\u0275text(8),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.item_code," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.item_name," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.price," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.remark," ")}}function q(e,t){if(1&e&&(s.\u0275\u0275elementContainerStart(0),s.\u0275\u0275elementStart(1,"div",11),s.\u0275\u0275text(2," \u670d\u52a1\u8d39\uff1a\uff08 \u5408\u8ba1\uff1a"),s.\u0275\u0275elementStart(3,"span"),s.\u0275\u0275text(4),s.\u0275\u0275elementEnd(),s.\u0275\u0275text(5," \uff09 "),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(6,"dw-table",23,24),s.\u0275\u0275elementStart(8,"thead"),s.\u0275\u0275elementStart(9,"tr",14),s.\u0275\u0275elementStart(10,"th",25),s.\u0275\u0275elementStart(11,"span",16),s.\u0275\u0275text(12,"\u9879\u76ee\u7f16\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(13,"th",26),s.\u0275\u0275elementStart(14,"span",16),s.\u0275\u0275text(15,"\u9879\u76ee\u540d\u79f0"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(16,"th",27),s.\u0275\u0275elementStart(17,"span",16),s.\u0275\u0275text(18,"\u4ef7\u683c"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(19,"th",28),s.\u0275\u0275elementStart(20,"span",16),s.\u0275\u0275text(21,"\u5907\u6ce8"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(22,"tbody"),s.\u0275\u0275template(23,F,9,4,"tr",18),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementContainerEnd()),2&e){const e=s.\u0275\u0275reference(7),t=s.\u0275\u0275nextContext();s.\u0275\u0275advance(4),s.\u0275\u0275textInterpolate1("\uffe5",t.itemAmountTotal,""),s.\u0275\u0275advance(2),s.\u0275\u0275property("dwData",t.serviceItems)("dwFrontPagination",!1)("dwShowPagination",!1),s.\u0275\u0275advance(17),s.\u0275\u0275property("ngForOf",e.data)}}const N=function(){return{x:"1100px"}};let $=(()=>{class e{constructor(e,t){this.quotationService=e,this.message=t,this.quotationInfo={type:"1",buy_quickwear_part:!1,employee_name:"",doc_date:"",quote_type:"",quote_type_name:"",service_order_no:"",customer_name:"",product_file_name:"",sn:"",specification:"",model:"",remark:"",warehouse_name:""},this.spareParts=[],this.serviceItems=[],this.partAmountTotal="0.00",this.itemAmountTotal="0.00",this.totalAmount="0.00",this.isIntegrated=!1}initData(e,t){this.isIntegrated=t,this.quotationService.getQuotationInfo(e).subscribe(e=>{if(e.success){const t=e.data.quotation[0];t.type=t.type||t.file_type,this.quotationInfo=t,this.spareParts=t.child.quotation_details.filter(e=>"1"===e.expense_type),this.serviceItems=t.child.quotation_details.filter(e=>"2"===e.expense_type),this.partPriceChange(),this.itemPriceChange()}else this.message.create("error",e.message)},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)})}ngOnInit(){}partPriceChange(){this.partAmountTotal="0.00",this.spareParts.forEach(e=>{this.partAmountTotal=(parseFloat(this.partAmountTotal)+e.price*e.quality).toFixed(2)}),this.totalAmount=(parseFloat(this.partAmountTotal)+parseFloat(this.itemAmountTotal)).toFixed(2)}itemPriceChange(){this.itemAmountTotal="0.00",this.serviceItems.forEach(e=>{this.itemAmountTotal=(parseFloat(this.itemAmountTotal)+e.price).toFixed(2)}),this.totalAmount=(parseFloat(this.partAmountTotal)+parseFloat(this.itemAmountTotal)).toFixed(2)}}return e.\u0275fac=function(t){return new(t||e)(s.\u0275\u0275directiveInject(h),s.\u0275\u0275directiveInject(d.DwMessageService))},e.\u0275cmp=s.\u0275\u0275defineComponent({type:e,selectors:[["app-quotation-detail"]],decls:109,vars:30,consts:[[1,"sub-title"],["dw-row",""],[2,"width","20px"],["dw-col","","dwSpan","7",1,"flex-box"],["class","label",4,"ngIf"],[1,"info"],[1,"label"],["dw-col","","dwSpan","7","class","flex-box",4,"ngIf"],["dw-row","",4,"ngIf"],["dw-col","","dwSpan","21",1,"flex-box"],["class","total",4,"ngIf"],[1,"total-amount"],[3,"dwData","dwFrontPagination","dwShowPagination","dwScroll"],["dwTable2",""],["dw-tr",""],["dw-th",""],["translate",""],["dw-th","","dwAlign","right"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","info",4,"ngIf"],[1,"total"],["dwAlign","right"],[3,"dwData","dwFrontPagination","dwShowPagination"],["dwTable3",""],["dw-th","","width","144"],["dw-th","","width","160"],["dw-th","","width","136","dwAlign","right"],["dw-th","","width","264"]],template:function(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"div",0),s.\u0275\u0275text(1,"\u57fa\u672c\u4fe1\u606f"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(2,"div",1),s.\u0275\u0275element(3,"div",2),s.\u0275\u0275elementStart(4,"div",3),s.\u0275\u0275template(5,x,2,0,"div",4),s.\u0275\u0275template(6,y,2,0,"div",4),s.\u0275\u0275elementStart(7,"div",5),s.\u0275\u0275text(8),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(9,"div",3),s.\u0275\u0275elementStart(10,"div",6),s.\u0275\u0275text(11,"\u586b\u5355\u65e5\u671f\uff1a"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(12,"div",5),s.\u0275\u0275text(13),s.\u0275\u0275pipe(14,"date"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(15,E,5,1,"div",7),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(16,"div",1),s.\u0275\u0275element(17,"div",2),s.\u0275\u0275elementStart(18,"div",3),s.\u0275\u0275elementStart(19,"div",6),s.\u0275\u0275text(20,"\u62a5\u4ef7\u7c7b\u578b\uff1a"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(21,"div",5),s.\u0275\u0275text(22),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(23,C,5,1,"div",7),s.\u0275\u0275elementStart(24,"div",3),s.\u0275\u0275elementStart(25,"div",6),s.\u0275\u0275text(26,"\u4ed3\u5e93\uff1a"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(27,"div",5),s.\u0275\u0275text(28),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(29,b,5,1,"div",7),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(30,"div",1),s.\u0275\u0275element(31,"div",2),s.\u0275\u0275elementStart(32,"div",3),s.\u0275\u0275elementStart(33,"div",6),s.\u0275\u0275text(34,"\u5ba2\u6237\uff1a"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(35,"div",5),s.\u0275\u0275text(36),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(37,"div",3),s.\u0275\u0275elementStart(38,"div",6),s.\u0275\u0275text(39,"\u4ea7\u54c1\uff1a"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(40,"div",5),s.\u0275\u0275text(41),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(42,"div",3),s.\u0275\u0275template(43,I,2,0,"div",4),s.\u0275\u0275template(44,D,2,0,"div",4),s.\u0275\u0275elementStart(45,"div",5),s.\u0275\u0275text(46),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(47,"div",1),s.\u0275\u0275element(48,"div",2),s.\u0275\u0275elementStart(49,"div",3),s.\u0275\u0275elementStart(50,"div",6),s.\u0275\u0275text(51,"\u89c4\u683c\uff1a"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(52,"div",5),s.\u0275\u0275text(53),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(54,"div",3),s.\u0275\u0275elementStart(55,"div",6),s.\u0275\u0275text(56,"\u578b\u53f7\uff1a"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(57,"div",5),s.\u0275\u0275text(58),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(59,V,17,5,"div",8),s.\u0275\u0275elementStart(60,"div",1),s.\u0275\u0275element(61,"div",2),s.\u0275\u0275elementStart(62,"div",9),s.\u0275\u0275elementStart(63,"div",6),s.\u0275\u0275text(64,"\u5907\u6ce8\uff1a"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(65,"div",5),s.\u0275\u0275text(66),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(67,"div",0),s.\u0275\u0275text(68,"\u62a5\u4ef7\u660e\u7ec6"),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(69,k,4,1,"div",10),s.\u0275\u0275elementStart(70,"div",11),s.\u0275\u0275text(71," \u6750\u6599\u8d39\uff1a\uff08 \u5408\u8ba1\uff1a"),s.\u0275\u0275elementStart(72,"span"),s.\u0275\u0275text(73),s.\u0275\u0275elementEnd(),s.\u0275\u0275text(74," \uff09\n"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(75,"dw-table",12,13),s.\u0275\u0275elementStart(77,"thead"),s.\u0275\u0275elementStart(78,"tr",14),s.\u0275\u0275elementStart(79,"th",15),s.\u0275\u0275elementStart(80,"span",16),s.\u0275\u0275text(81,"\u7f16\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(82,"th",15),s.\u0275\u0275elementStart(83,"span",16),s.\u0275\u0275text(84,"\u540d\u79f0"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(85,"th",15),s.\u0275\u0275elementStart(86,"span",16),s.\u0275\u0275text(87,"\u89c4\u683c"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(88,"th",15),s.\u0275\u0275elementStart(89,"span",16),s.\u0275\u0275text(90,"\u578b\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(91,"th",15),s.\u0275\u0275elementStart(92,"span",16),s.\u0275\u0275text(93,"\u5355\u4f4d"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(94,"th",17),s.\u0275\u0275elementStart(95,"span",16),s.\u0275\u0275text(96,"\u5355\u4ef7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(97,"th",17),s.\u0275\u0275elementStart(98,"span",16),s.\u0275\u0275text(99,"\u6570\u91cf"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(100,"th",17),s.\u0275\u0275elementStart(101,"span",16),s.\u0275\u0275text(102,"\u91d1\u989d"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(103,"th",15),s.\u0275\u0275elementStart(104,"span",16),s.\u0275\u0275text(105,"\u5907\u6ce8"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(106,"tbody"),s.\u0275\u0275template(107,A,19,9,"tr",18),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(108,q,24,5,"ng-container",19)),2&e){const e=s.\u0275\u0275reference(76);s.\u0275\u0275advance(5),s.\u0275\u0275property("ngIf",!t.quotationInfo.buy_quickwear_part),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",t.quotationInfo.buy_quickwear_part),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate(t.quotationInfo.employee_name),s.\u0275\u0275advance(5),s.\u0275\u0275textInterpolate(s.\u0275\u0275pipeBind2(14,26,t.quotationInfo.doc_date,"yyyy-MM-dd")),s.\u0275\u0275advance(2),s.\u0275\u0275property("ngIf",t.quotationInfo.buy_quickwear_part),s.\u0275\u0275advance(7),s.\u0275\u0275textInterpolate(t.quotationInfo.quote_type_name),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",!t.quotationInfo.buy_quickwear_part),s.\u0275\u0275advance(5),s.\u0275\u0275textInterpolate(t.quotationInfo.warehouse_name),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",t.quotationInfo.buy_quickwear_part),s.\u0275\u0275advance(7),s.\u0275\u0275textInterpolate(t.quotationInfo.customer_name),s.\u0275\u0275advance(5),s.\u0275\u0275textInterpolate(t.quotationInfo.product_file_name),s.\u0275\u0275advance(2),s.\u0275\u0275property("ngIf","1"===t.quotationInfo.type),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","2"===t.quotationInfo.type),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate(t.quotationInfo.sn),s.\u0275\u0275advance(7),s.\u0275\u0275textInterpolate(t.quotationInfo.specification),s.\u0275\u0275advance(5),s.\u0275\u0275textInterpolate(t.quotationInfo.model),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",t.isIntegrated),s.\u0275\u0275advance(7),s.\u0275\u0275textInterpolate(t.quotationInfo.remark),s.\u0275\u0275advance(3),s.\u0275\u0275property("ngIf",!t.quotationInfo.buy_quickwear_part),s.\u0275\u0275advance(4),s.\u0275\u0275textInterpolate1("\uffe5",t.partAmountTotal,""),s.\u0275\u0275advance(2),s.\u0275\u0275property("dwData",t.spareParts)("dwFrontPagination",!1)("dwShowPagination",!1)("dwScroll",s.\u0275\u0275pureFunction0(29,N)),s.\u0275\u0275advance(32),s.\u0275\u0275property("ngForOf",e.data),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",!t.quotationInfo.buy_quickwear_part)}},directives:[w.DwRowDirective,w.DwColDirective,r.NgIf,S.DwTableComponent,S.DwTheadComponent,S.DwTrDirective,S.DwTableCellDirective,S.DwThMeasureDirective,_.TranslateDirective,S.DwCellAlignDirective,S.DwTbodyComponent,r.NgForOf],pipes:[r.DatePipe],styles:[".sub-title[_ngcontent-%COMP%]{margin-left:0;margin-bottom:24px}.sub-title[_ngcontent-%COMP%]:first-of-type{margin-top:0;margin-bottom:16px}.total-amount[_ngcontent-%COMP%]{height:49px;line-height:48px;color:#000000d9;font-weight:bold;font-size:16px;padding:0 24px;border:1px solid #f0f0f0;border-bottom:0;margin-top:16px}.total-amount[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fe3a3a}.total[_ngcontent-%COMP%]{height:64px;line-height:64px;color:#000000d9;font-weight:bold;font-size:24px;padding:0 24px;background:#f2f2f2}.total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fe3a3a;font-size:28px}"]}),e})();var R=n(45890),H=n(97834),z=n(80677),L=n(80419),j=n(85773),G=n(41937),Q=n(67280),W=n(8852),B=n(93761),U=n(96670),K=n(37568),Z=n(17494),J=n(85277),Y=n(78169),X=n(88059),ee=n(64840),te=n(89842);const ne=["child"];function re(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"em",57),s.\u0275\u0275listener("click",function(){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext(2).clear("customer")}),s.\u0275\u0275elementEnd()}}function ie(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275template(0,re,1,0,"em",54),s.\u0275\u0275elementStart(1,"button",55),s.\u0275\u0275listener("click",function(t){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext().openDataWin(t,"customer")}),s.\u0275\u0275element(2,"em",56),s.\u0275\u0275elementEnd()}if(2&e){const e=s.\u0275\u0275nextContext();s.\u0275\u0275property("ngIf",e.searchForm.value.customer_name)}}function ae(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"em",57),s.\u0275\u0275listener("click",function(){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext(2).clear("service_order_doc_no")}),s.\u0275\u0275elementEnd()}}function oe(e,t){if(1&e&&s.\u0275\u0275template(0,ae,1,0,"em",54),2&e){const e=s.\u0275\u0275nextContext();s.\u0275\u0275property("ngIf",e.searchForm.value.service_order_doc_no)}}function se(e,t){1&e&&(s.\u0275\u0275elementStart(0,"span",24),s.\u0275\u0275text(1,"\u5e8f\u5217\u53f7"),s.\u0275\u0275elementEnd())}function le(e,t){1&e&&(s.\u0275\u0275elementStart(0,"span",24),s.\u0275\u0275text(1,"\u9879\u76ee\u53f7"),s.\u0275\u0275elementEnd())}function de(e,t){1&e&&(s.\u0275\u0275elementStart(0,"span",24),s.\u0275\u0275text(1,"\u5e8f\u5217\u53f7/\u9879\u76ee\u53f7"),s.\u0275\u0275elementEnd())}function ce(e,t){1&e&&(s.\u0275\u0275elementStart(0,"th",34),s.\u0275\u0275elementStart(1,"span",24),s.\u0275\u0275text(2,"ERP\u9500\u552e\u8ba2\u5355\u5355\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd())}function me(e,t){1&e&&(s.\u0275\u0275elementStart(0,"th",58),s.\u0275\u0275elementStart(1,"span",24),s.\u0275\u0275text(2,"\u6536\u6b3e\u72b6\u6001"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd())}function pe(e,t){1&e&&(s.\u0275\u0275elementStart(0,"th",58),s.\u0275\u0275elementStart(1,"span",24),s.\u0275\u0275text(2,"\u5f00\u7968\u72b6\u6001"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd())}function ue(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"td"),s.\u0275\u0275text(1),s.\u0275\u0275elementEnd()),2&e){const e=s.\u0275\u0275nextContext().$implicit;s.\u0275\u0275advance(1),s.\u0275\u0275textInterpolate1(" ",e.erp_so_no," ")}}function he(e,t){1&e&&(s.\u0275\u0275elementStart(0,"td"),s.\u0275\u0275text(1," \u5df2\u6536\u6b3e "),s.\u0275\u0275elementEnd())}function ge(e,t){1&e&&(s.\u0275\u0275elementStart(0,"td"),s.\u0275\u0275text(1," \u672a\u6536\u6b3e "),s.\u0275\u0275elementEnd())}function fe(e,t){1&e&&(s.\u0275\u0275elementStart(0,"td"),s.\u0275\u0275text(1," \u5df2\u5f00\u7968 "),s.\u0275\u0275elementEnd())}function ve(e,t){1&e&&(s.\u0275\u0275elementStart(0,"td"),s.\u0275\u0275text(1," \u672a\u5f00\u7968 "),s.\u0275\u0275elementEnd())}function we(e,t){1&e&&(s.\u0275\u0275elementStart(0,"td",70),s.\u0275\u0275element(1,"span",71),s.\u0275\u0275text(2,"\u5f85\u5ba1\u6838 "),s.\u0275\u0275elementEnd())}function Se(e,t){1&e&&(s.\u0275\u0275elementStart(0,"td",70),s.\u0275\u0275element(1,"span",72),s.\u0275\u0275text(2,"\u5df2\u5ba1\u6838 "),s.\u0275\u0275elementEnd())}function _e(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"div",73),s.\u0275\u0275listener("click",function(){s.\u0275\u0275restoreView(e);const t=s.\u0275\u0275nextContext().$implicit;return s.\u0275\u0275nextContext().modify(t.quotation_id)}),s.\u0275\u0275element(1,"img",74),s.\u0275\u0275element(2,"img",75),s.\u0275\u0275elementEnd()}2&e&&s.\u0275\u0275property("dwActionId","modify")("dwDefaultAuthorized","disabled")}function xe(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"div",76),s.\u0275\u0275elementStart(1,"a",77),s.\u0275\u0275listener("dwOnConfirm",function(){s.\u0275\u0275restoreView(e);const t=s.\u0275\u0275nextContext().$implicit;return s.\u0275\u0275nextContext().delete(t.quotation_id)}),s.\u0275\u0275pipe(2,"translate"),s.\u0275\u0275pipe(3,"translate"),s.\u0275\u0275pipe(4,"translate"),s.\u0275\u0275elementStart(5,"a",78),s.\u0275\u0275element(6,"img",79),s.\u0275\u0275element(7,"img",80),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()}2&e&&(s.\u0275\u0275property("dwActionId","delete")("dwDefaultAuthorized","disabled"),s.\u0275\u0275advance(1),s.\u0275\u0275property("dwPopconfirmTitle",s.\u0275\u0275pipeBind1(2,6,"\u662f\u5426\u5220\u9664"))("dwOkText",s.\u0275\u0275pipeBind1(3,8,"dw-determine"))("dwCancelText",s.\u0275\u0275pipeBind1(4,10,"dw-cancel"))("dwPopconfirmPlacement","topRight"))}function ye(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"div",81),s.\u0275\u0275listener("click",function(){s.\u0275\u0275restoreView(e);const t=s.\u0275\u0275nextContext().$implicit;return s.\u0275\u0275nextContext().approve(t.quotation_id)}),s.\u0275\u0275element(1,"img",82),s.\u0275\u0275element(2,"img",83),s.\u0275\u0275elementEnd()}2&e&&s.\u0275\u0275property("dwActionId","approve")("dwDefaultAuthorized","disabled")}function Ee(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"div",84),s.\u0275\u0275listener("click",function(){s.\u0275\u0275restoreView(e);const t=s.\u0275\u0275nextContext().$implicit;return s.\u0275\u0275nextContext().disapprove(t.quotation_id)}),s.\u0275\u0275element(1,"img",85),s.\u0275\u0275element(2,"img",86),s.\u0275\u0275elementEnd()}2&e&&s.\u0275\u0275property("dwActionId","disapprove")("dwDefaultAuthorized","disabled")}function Ce(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"tr"),s.\u0275\u0275elementStart(1,"td"),s.\u0275\u0275text(2),s.\u0275\u0275pipe(3,"date"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(4,"td",59),s.\u0275\u0275elementStart(5,"a",60),s.\u0275\u0275listener("click",function(){const t=s.\u0275\u0275restoreView(e).$implicit;return s.\u0275\u0275nextContext().detail(t)}),s.\u0275\u0275text(6),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(7,"td",59),s.\u0275\u0275text(8),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(9,"td",59),s.\u0275\u0275text(10),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(11,"td",59),s.\u0275\u0275text(12),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(13,"td",59),s.\u0275\u0275text(14),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(15,"td",61),s.\u0275\u0275text(16),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(17,ue,2,1,"td",62),s.\u0275\u0275template(18,he,2,0,"td",62),s.\u0275\u0275template(19,ge,2,0,"td",62),s.\u0275\u0275template(20,fe,2,0,"td",62),s.\u0275\u0275template(21,ve,2,0,"td",62),s.\u0275\u0275template(22,we,3,0,"td",63),s.\u0275\u0275template(23,Se,3,0,"td",63),s.\u0275\u0275elementStart(24,"td",64),s.\u0275\u0275elementStart(25,"div",65),s.\u0275\u0275template(26,_e,3,2,"div",66),s.\u0275\u0275template(27,xe,8,12,"div",67),s.\u0275\u0275template(28,ye,3,2,"div",68),s.\u0275\u0275template(29,Ee,3,2,"div",69),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=s.\u0275\u0275nextContext();s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",s.\u0275\u0275pipeBind2(3,18,e.doc_date,"yyyy-MM-dd")," "),s.\u0275\u0275advance(4),s.\u0275\u0275textInterpolate(e.doc_no),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.service_order_no," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.customer_name," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.product_file_name," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.sn," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",null!==e.amount?e.amount.toFixed(2):"0.00"," "),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",n.isIntegrated),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",e.erp_collection_status&&n.isIntegrated),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",!e.erp_collection_status&&n.isIntegrated),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",e.erp_invoicing_status&&n.isIntegrated),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",!e.erp_invoicing_status&&n.isIntegrated),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",!e.approve_status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",e.approve_status),s.\u0275\u0275advance(3),s.\u0275\u0275property("ngIf",!e.approve_status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",!e.approve_status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",!e.approve_status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",e.approve_status)}}function be(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"dw-tag",87),s.\u0275\u0275listener("dwCheckedChange",function(t){return s.\u0275\u0275restoreView(e).$implicit.checked=t})("dwCheckedChange",function(t){const n=s.\u0275\u0275restoreView(e).$implicit;return s.\u0275\u0275nextContext().handleChange(t,n)}),s.\u0275\u0275text(1),s.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit;s.\u0275\u0275property("dwChecked",e.checked),s.\u0275\u0275advance(1),s.\u0275\u0275textInterpolate1(" ",e.text," ")}}function Ie(e,t){1&e&&(s.\u0275\u0275elementStart(0,"span",24),s.\u0275\u0275text(1,"\u5e8f\u5217\u53f7"),s.\u0275\u0275elementEnd())}function De(e,t){1&e&&(s.\u0275\u0275elementStart(0,"span",24),s.\u0275\u0275text(1,"\u9879\u76ee\u53f7"),s.\u0275\u0275elementEnd())}function Oe(e,t){1&e&&(s.\u0275\u0275elementStart(0,"span",24),s.\u0275\u0275text(1,"\u5e8f\u5217\u53f7/\u9879\u76ee\u53f7"),s.\u0275\u0275elementEnd())}function Pe(e,t){1&e&&(s.\u0275\u0275elementStart(0,"th",34),s.\u0275\u0275elementStart(1,"span",24),s.\u0275\u0275text(2,"ERP\u9500\u552e\u8ba2\u5355\u5355\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd())}function Me(e,t){1&e&&(s.\u0275\u0275elementStart(0,"th",58),s.\u0275\u0275elementStart(1,"span",24),s.\u0275\u0275text(2,"\u6536\u6b3e\u72b6\u6001"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd())}function Te(e,t){1&e&&(s.\u0275\u0275elementStart(0,"th",58),s.\u0275\u0275elementStart(1,"span",24),s.\u0275\u0275text(2,"\u5f00\u7968\u72b6\u6001"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd())}function Ve(e,t){1&e&&(s.\u0275\u0275elementStart(0,"th",88),s.\u0275\u0275elementStart(1,"span",24),s.\u0275\u0275text(2,"\u72b6\u6001"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd())}function ke(e,t){1&e&&(s.\u0275\u0275elementStart(0,"th",41),s.\u0275\u0275elementStart(1,"span",24),s.\u0275\u0275text(2,"\u64cd\u4f5c"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd())}function Ae(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"td"),s.\u0275\u0275text(1),s.\u0275\u0275elementEnd()),2&e){const e=s.\u0275\u0275nextContext().$implicit;s.\u0275\u0275advance(1),s.\u0275\u0275textInterpolate1(" ",e.erp_so_no," ")}}function Fe(e,t){1&e&&(s.\u0275\u0275elementStart(0,"td"),s.\u0275\u0275text(1," \u5df2\u6536\u6b3e "),s.\u0275\u0275elementEnd())}function qe(e,t){1&e&&(s.\u0275\u0275elementStart(0,"td"),s.\u0275\u0275text(1," \u672a\u6536\u6b3e "),s.\u0275\u0275elementEnd())}function Ne(e,t){1&e&&(s.\u0275\u0275elementStart(0,"td"),s.\u0275\u0275text(1," \u5df2\u5f00\u7968 "),s.\u0275\u0275elementEnd())}function $e(e,t){1&e&&(s.\u0275\u0275elementStart(0,"td"),s.\u0275\u0275text(1," \u672a\u5f00\u7968 "),s.\u0275\u0275elementEnd())}function Re(e,t){1&e&&(s.\u0275\u0275elementContainerStart(0),s.\u0275\u0275element(1,"span",90),s.\u0275\u0275text(2,"\u5f85\u62a5\u4ef7 "),s.\u0275\u0275elementContainerEnd())}function He(e,t){1&e&&(s.\u0275\u0275elementContainerStart(0),s.\u0275\u0275element(1,"span",71),s.\u0275\u0275text(2,"\u5f85\u5ba2\u6237\u786e\u8ba4 "),s.\u0275\u0275elementContainerEnd())}function ze(e,t){1&e&&(s.\u0275\u0275elementContainerStart(0),s.\u0275\u0275element(1,"span",72),s.\u0275\u0275text(2,"\u5f85\u53d1\u8d27 "),s.\u0275\u0275elementContainerEnd())}function Le(e,t){1&e&&(s.\u0275\u0275elementContainerStart(0),s.\u0275\u0275element(1,"span",72),s.\u0275\u0275text(2,"\u90e8\u5206\u53d1\u8d27 "),s.\u0275\u0275elementContainerEnd())}function je(e,t){1&e&&(s.\u0275\u0275elementContainerStart(0),s.\u0275\u0275element(1,"span",91),s.\u0275\u0275text(2,"\u5168\u90e8\u53d1\u8d27 "),s.\u0275\u0275elementContainerEnd())}function Ge(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"td"),s.\u0275\u0275template(1,Re,3,0,"ng-container",62),s.\u0275\u0275template(2,He,3,0,"ng-container",62),s.\u0275\u0275template(3,ze,3,0,"ng-container",62),s.\u0275\u0275template(4,Le,3,0,"ng-container",62),s.\u0275\u0275template(5,je,3,0,"ng-container",62),s.\u0275\u0275elementEnd()),2&e){const e=s.\u0275\u0275nextContext().$implicit;s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","1"===e.status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","2"===e.status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","3"===e.status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","5"===e.status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","4"===e.status)}}function Qe(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"div",95),s.\u0275\u0275listener("click",function(){s.\u0275\u0275restoreView(e);const t=s.\u0275\u0275nextContext(2).$implicit;return s.\u0275\u0275nextContext().quote(t)}),s.\u0275\u0275text(1),s.\u0275\u0275elementEnd()}if(2&e){const e=s.\u0275\u0275nextContext(2).$implicit;s.\u0275\u0275property("dwActionId","quote")("dwDefaultAuthorized","disabled"),s.\u0275\u0275advance(1),s.\u0275\u0275textInterpolate1(" ","1"===e.status?"\u62a5\u4ef7":"\u91cd\u65b0\u62a5\u4ef7"," ")}}function We(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"div",96),s.\u0275\u0275elementStart(1,"a",77),s.\u0275\u0275listener("dwOnConfirm",function(){s.\u0275\u0275restoreView(e);const t=s.\u0275\u0275nextContext(2).$implicit;return s.\u0275\u0275nextContext().delete(t.quotation_id)}),s.\u0275\u0275pipe(2,"translate"),s.\u0275\u0275pipe(3,"translate"),s.\u0275\u0275pipe(4,"translate"),s.\u0275\u0275elementStart(5,"a",97),s.\u0275\u0275text(6," \u5220\u9664 "),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()}2&e&&(s.\u0275\u0275property("dwActionId","delete")("dwDefaultAuthorized","disabled"),s.\u0275\u0275advance(1),s.\u0275\u0275property("dwPopconfirmTitle",s.\u0275\u0275pipeBind1(2,6,"\u662f\u5426\u5220\u9664"))("dwOkText",s.\u0275\u0275pipeBind1(3,8,"dw-determine"))("dwCancelText",s.\u0275\u0275pipeBind1(4,10,"dw-cancel"))("dwPopconfirmPlacement","topRight"))}function Be(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"div",95),s.\u0275\u0275listener("click",function(){s.\u0275\u0275restoreView(e);const t=s.\u0275\u0275nextContext(2).$implicit;return s.\u0275\u0275nextContext().disapprove(t.quotation_id)}),s.\u0275\u0275text(1," \u64a4\u5ba1 "),s.\u0275\u0275elementEnd()}2&e&&s.\u0275\u0275property("dwActionId","disapprove")("dwDefaultAuthorized","disabled")}function Ue(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"td",64),s.\u0275\u0275elementStart(1,"div",92),s.\u0275\u0275template(2,Qe,2,3,"div",93),s.\u0275\u0275template(3,We,7,12,"div",94),s.\u0275\u0275template(4,Be,2,2,"div",93),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()),2&e){const e=s.\u0275\u0275nextContext().$implicit;s.\u0275\u0275advance(2),s.\u0275\u0275property("ngIf","1"===e.status||"2"===e.status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","1"===e.status||"2"===e.status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","3"===e.status)}}function Ke(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"tr"),s.\u0275\u0275elementStart(1,"td"),s.\u0275\u0275text(2),s.\u0275\u0275pipe(3,"date"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(4,"td",59),s.\u0275\u0275elementStart(5,"a",60),s.\u0275\u0275listener("click",function(){const t=s.\u0275\u0275restoreView(e).$implicit;return s.\u0275\u0275nextContext().detail(t)}),s.\u0275\u0275text(6),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(7,"td",59),s.\u0275\u0275text(8),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(9,"td",59),s.\u0275\u0275text(10),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(11,"td",59),s.\u0275\u0275text(12),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(13,"td",61),s.\u0275\u0275text(14),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(15,Ae,2,1,"td",62),s.\u0275\u0275template(16,Fe,2,0,"td",62),s.\u0275\u0275template(17,qe,2,0,"td",62),s.\u0275\u0275template(18,Ne,2,0,"td",62),s.\u0275\u0275template(19,$e,2,0,"td",62),s.\u0275\u0275template(20,Ge,6,5,"td",62),s.\u0275\u0275template(21,Ue,5,3,"td",89),s.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=s.\u0275\u0275nextContext();s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",s.\u0275\u0275pipeBind2(3,13,e.doc_date,"yyyy-MM-dd")," "),s.\u0275\u0275advance(4),s.\u0275\u0275textInterpolate(e.doc_no),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.customer_name," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.product_file_name," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.sn," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ","1"!==e.status?e.amount.toFixed(2):"--"," "),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",n.isIntegrated&&"4"===n.state&&"0"===n.erp_collection_status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",e.erp_collection_status&&n.isIntegrated&&"4"===n.state&&"0"===n.erp_collection_status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",!e.erp_collection_status&&n.isIntegrated&&"4"===n.state&&"0"===n.erp_collection_status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",e.erp_invoicing_status&&n.isIntegrated&&"4"===n.state&&"0"===n.erp_collection_status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",!e.erp_invoicing_status&&n.isIntegrated&&"4"===n.state&&"0"===n.erp_collection_status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",!("4"===n.state&&"1"===n.erp_collection_status)),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","4"!==n.state)}}function Ze(e,t){1&e&&s.\u0275\u0275element(0,"app-quotation-detail",null,98)}function Je(e,t){if(1&e&&s.\u0275\u0275text(0),2&e){const e=s.\u0275\u0275nextContext();s.\u0275\u0275textInterpolate1("\u5171 ",e.rowCount," \u6761")}}const Ye=function(){return{x:"1300px",y:"calc(100vh - 171px - 140px)"}},Xe=function(){return{x:"100%",y:"calc(100vh - 171px - 140px)"}},et=function(){return{overflow:"auto"}};let tt=(()=>{class e{constructor(t,n,r,i,a,o,s,l,d,c){if(this.commonHttpService=t,this.message=n,this.fb=r,this.quotationService=i,this.customerOpenerService=a,this.router=o,this._route=s,this.modalService=l,this.datePipe=d,this.customerSrv=c,this.DW_IN_MFA=H.ns,this.search={pageNumber:1,pageSize:10},this.quotation_id="",this.quotation_doc_no="",this.rowCount=0,this.dataList=[],this.isCollapsed=!1,this.detailTitle="",this.isIntegrated=!1,this.fileType="0",this.queryType=0,this.fiterTags=[{text:"\u5168\u90e8",checked:!1,value:"0",erp_collection_status:""},{text:"\u5f85\u62a5\u4ef7",checked:!0,value:"1",erp_collection_status:""},{text:"\u5f85\u5ba2\u6237\u786e\u8ba4",checked:!1,value:"2",erp_collection_status:""},{text:"\u5f85\u53d1\u8d27",checked:!1,value:"3",erp_collection_status:""},{text:"\u5df2\u53d1\u8d27",checked:!1,value:"4",erp_collection_status:""},{text:"\u5f85\u6536\u6b3e",checked:!1,value:"4",erp_collection_status:"0"},{text:"\u5df2\u5b8c\u6210",checked:!1,value:"4",erp_collection_status:"1"}],this.state="1",this.erp_collection_status="",e.useKeeper&&e.keeper)return e.keeper;this._route.paramMap.subscribe(e=>{const t=e.get("id")||"";t&&(this.quotation_id=t.split("@")[0],this.quotation_doc_no=t.split("@")[1])})}ngAfterViewInit(){console.log(this.child)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}ngOnInit(){this.subscription=this.router.events.subscribe(t=>{if(t instanceof a.NavigationStart){const n=this.router.parseUrl(this.router.url).root.children[a.PRIMARY_OUTLET].segments,r=this.router.parseUrl(t.url).root.children[a.PRIMARY_OUTLET].segments,i=n[n.length-1].path,o=r[r.length-1].path,s=i.indexOf("@")>=0&&"quote"===o,l="quote"===i&&o.indexOf("@")>=0;s||l?(e.useKeeper=!0,e.keeper=this):(e.useKeeper=!1,e.keeper=this)}}),this.customerSrv.getIntegratedEnableStatus().subscribe(e=>{this.isIntegrated=e.data},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)}),this.orderBy={sortFiled:"doc_no",sort:"ASC"},this.searchForm=this.fb.group({}),this.searchForm.addControl("date_range",new m.FormControl("")),this.searchForm.addControl("customer_code",new m.FormControl("")),this.searchForm.addControl("customer_name",new m.FormControl("")),this.searchForm.addControl("service_order_doc_no",new m.FormControl("")),e.useKeeper&&e.keeper&&(this.quotation_id="",this.quotation_doc_no="",this.queryType=1),this.loadData(),this.quotation_id&&(this.detail({quotation_id:this.quotation_id,approve_status:!0,doc_no:this.quotation_doc_no}),setTimeout(()=>{this.child.initData(this.quotation_id,!1)},800)),this.commonHttpService.get("restful/service/serviceOrder/ServiceOrder/IsShowTypeOption").subscribe(e=>{this.fileType=e.data},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)})}reset(){this.searchForm=this.fb.group({}),this.searchForm.addControl("date_range",new m.FormControl("")),this.searchForm.addControl("customer_code",new m.FormControl("")),this.searchForm.addControl("customer_name",new m.FormControl("")),this.searchForm.addControl("service_order_doc_no",new m.FormControl("")),this.loadData()}loadData(){const e=this.searchForm.value;""!==e.date_range&&e.date_range.length&&""!==e.date_range[0]?(e.date_range[0]=this.datePipe.transform(e.date_range[0],"yyyy-MM-dd"),e.date_range[1]=this.datePipe.transform(e.date_range[1],"yyyy-MM-dd")):e.date_range=["",""];const t={serviceOrderDocNo:this.searchForm.value.service_order_doc_no,customerCodes:this.searchForm.value.customer_code,pageNumber:String(this.search.pageNumber),pageSize:String(this.search.pageSize),orderBy:this.orderBy,dateRange:{startDate:e.date_range[0],endDate:e.date_range[1]},queryType:this.queryType+"",status:this.state,erp_collection_status:this.erp_collection_status};this.quotationService.getQuotationList(t).subscribe(e=>{this.dataList=e.data.quotation||[],this.rowCount=e.data.rowCount,this.onAfterSearch()},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)})}onTabChange(e){this.queryType=e.index,this.search.pageNumber=1,this.loadData()}handleChange(e,t){if(e){for(const e of this.fiterTags)e.text!==t.text&&(e.checked=!1);this.state=t.value,this.erp_collection_status=t.erp_collection_status,this.search.pageNumber=1,this.loadData()}}onPageSizeChange(){this.search.pageNumber=1,this.loadData()}onPageIndexChange(e){this.search.pageNumber=e,this.loadData()}openDataWin(e,t){e.preventDefault(),this.customerOpenerService.open([]).subscribe(e=>{if(console.log(e),null==e||0===e.length)return;const n=t+"_name",r=t+"_code";this[n]="",this[r]="",this.searchForm.get(n).setValue(""),this.searchForm.get(r).setValue(""),e.forEach(e=>{this[n]+=e[n]+",",this[r]+=e[r]+","}),0!==this[n].length&&(this[n]=this[n].substr(0,this[n].length-1)),0!==this[r].length&&(this[r]=this[r].substr(0,this[r].length-1)),this.searchForm.get(n).setValue(this[n]),this.searchForm.get(r).setValue(this[r])})}clear(e){"service_order_doc_no"===e?this.searchForm.get("service_order_doc_no").setValue(""):(this.searchForm.get(`${e}_code`).setValue(""),this.searchForm.get(`${e}_name`).setValue(""))}detail(e){this.isCollapsed=!0,this.detailTitle=e.buy_quickwear_part?`<div class="detail-title">\n                            \u6613\u635f\u4ef6\u9500\u552e\u62a5\u4ef7\u5355\n                            <p>${e.doc_no}</p>\n                            <span class="${"1"===e.status?"bg_orange":"2"===e.status?"bg_red2":"3"===e.status||"5"===e.status?"bg_blue":"bg_blue2"}">\n                              ${"1"===e.status?"\u5f85\u62a5\u4ef7":"2"===e.status?"\u5f85\u5ba2\u6237\u786e\u8ba4":"3"===e.status?"\u5f85\u53d1\u8d27":"5"===e.status?"\u90e8\u5206\u53d1\u8d27":"\u5168\u90e8\u53d1\u8d27"}\n                            </span>\n                          </div>`:e.approve_status?`<div class="detail-title">\n                          \u670d\u52a1\u62a5\u4ef7\u5355\n                          <p>${e.doc_no}</p>\n                          <span class="bg_blue3">\u5df2\u5ba1\u6838</span>\n                        </div>`:`<div class="detail-title">\n                          \u670d\u52a1\u62a5\u4ef7\u5355\n                          <p>${e.doc_no}</p>\n                          <span class="bg_red">\u5f85\u5ba1\u6838</span>\n                        </div>`,setTimeout(()=>{this.child.initData(e.quotation_id,this.isIntegrated)})}create(){this.router.navigate([(this.DW_IN_MFA?"/assc_crs":"")+"/crs/quotation/quotation-create"],{relativeTo:this._route})}modify(e){this.router.navigate([(this.DW_IN_MFA?"/assc_crs":"")+"/crs/quotation/quotation-modify",e],{relativeTo:this._route})}quote(e){const t={relativeTo:this._route,queryParams:{id:e.quotation_id}};this.quotationService.getQuotationStatus(e.quotation_id).subscribe(n=>{n.data===e.status?this.router.navigate([(this.DW_IN_MFA?"/assc_crs":"")+"/crs/quotation/quote"],t):(this.message.create("error","\u5f53\u524d\u8ba2\u5355\u72b6\u6001\u5df2\u53d1\u751f\u53d8\u5316"),this.search.pageNumber=1,this.loadData())},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)})}approve(e){this.quotationService.approveQuotation(e).subscribe(e=>{e.success?(this.message.create("success","\u5ba1\u6838\u6210\u529f\uff01"),this.loadData()):this.message.create("error",e.message)},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)})}disapprove(e){this.quotationService.disapprove(e).subscribe(e=>{this.message.create("success","\u64a4\u9500\u5ba1\u6838\u6210\u529f"),this.loadData()},e=>{this.modalService.error({dwTitle:e.error.errorMessage,dwWidth:"600px",dwOkText:"\u786e\u5b9a"})})}delete(e){this.deleteMul([e])}deleteMul(e){console.log(e),e.length>0&&this.quotationService.deleteQuotation(e).subscribe(e=>{!0===e.success?null!==e.data&&!1===e.data.success?this.message.create("error",e.data.message):(this.message.create("success","\u64cd\u4f5c\u6210\u529f\uff01"),this.loadData()):this.message.create("error","\u64cd\u4f5c\u5931\u8d25\uff01")},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)})}order(e){const t=e.key;switch(e.value){case"ascend":this.orderBy={sortFiled:t,sort:"ASC"},this.search.pageNumber=1,this.loadData();break;case"descend":this.orderBy={sortFiled:t,sort:"DESC"},this.search.pageNumber=1,this.loadData()}}onBeforeSearch(){}onAfterSearch(){this.rowCount>0&&0===this.dataList.length&&(this.search.pageNumber=1,this.loadData())}}return e.\u0275fac=function(t){return new(t||e)(s.\u0275\u0275directiveInject(R.$),s.\u0275\u0275directiveInject(d.DwMessageService),s.\u0275\u0275directiveInject(m.FormBuilder),s.\u0275\u0275directiveInject(h),s.\u0275\u0275directiveInject(f),s.\u0275\u0275directiveInject(a.Router),s.\u0275\u0275directiveInject(a.ActivatedRoute),s.\u0275\u0275directiveInject(c.DwModalService),s.\u0275\u0275directiveInject(r.DatePipe),s.\u0275\u0275directiveInject(v.v))},e.\u0275cmp=s.\u0275\u0275defineComponent({type:e,selectors:[["app-quotation-list"]],viewQuery:function(e,t){if(1&e&&s.\u0275\u0275viewQuery(ne,5),2&e){let e;s.\u0275\u0275queryRefresh(e=s.\u0275\u0275loadQuery())&&(t.child=e.first)}},features:[s.\u0275\u0275ProvidersFeature([f])],decls:126,vars:61,consts:[[1,"dw-f-content-list","layoutClass","sales_layout"],[1,"issue_layout_head"],[1,"issue_layout_title"],[2,"margin-left","3px"],[1,"content-box"],[1,"sales_issue_form","sales_form","sales_shadow",2,"margin-bottom","10px",3,"formGroup"],["dw-row","",1,"search-form-box"],[1,"search-input"],[1,"label"],[1,"form-input","date-picker"],["formControlName","date_range",2,"width","100%"],[1,"form-input"],["dwSearch","",3,"dwSuffix"],["type","text","dw-input","","readonly","","dwMode","multiple","formControlName","customer_name","placeholder","",2,"width","100%"],["customerData",""],[3,"dwSuffix"],["type","text","dw-input","","formControlName","service_order_doc_no"],["ServiceDocNoData",""],["dw-button","","dwActionAuthorized","",3,"dwType","dwActionId","dwClick"],["dw-button","","dw-analyticsOn","click",3,"dwType","click"],["dw-row","","dwActionAuthorized","",1,"dw-f-btn-bar-action",3,"dwActionId","dwDefaultAuthorized"],["dw-col",""],["dw-button","","type","button","dwActionAuthorized","",3,"dwType","dwActionId","dwDefaultAuthorized","click"],["dw-icon","","dwType","plus"],["translate",""],[1,"dw-f-table","sales_table",2,"margin-top","-14px"],[1,"my-tab",3,"dwTabPosition","dwSelectedIndex","dwType","dwAnimated","dwSelectChange"],[3,"dwTitle"],["dwShowSizeChanger","",3,"dwData","dwTotal","dwFrontPagination","dwPageIndex","dwPageSize","dwShowTotal","dwScroll","dwPageIndexChange","dwPageSizeChange"],["dwTotalTable",""],[3,"dwSortOrderChange"],["dw-tr",""],["dw-th","","dwShowSort","","dwColumnKey","doc_date","dwWidth","114px"],["dw-th","","dwShowSort","","dwColumnKey","doc_no","dwWidth","140px"],["dw-th","","dwWidth","140px"],["dw-th",""],["translate","",4,"ngIf"],["dw-th","","dwAlign","right"],["dw-th","","dwWidth","140px",4,"ngIf"],["dw-th","","dwWidth","92px",4,"ngIf"],["dw-th","","dwAlign","center","dwWidth","80px"],["dw-th","","dwAlign","center","dwRight","","dwWidth","120px"],[4,"ngFor","ngForOf"],[1,"tag-wrap"],[1,"tag-label"],[1,"tags"],["dwMode","checkable","style","font-size: 15px;line-height: 28px;",3,"dwChecked","dwCheckedChange",4,"ngFor","ngForOf"],["dw-th","","dwShowSort","","dwColumnKey","doc_no","dwWidth","160px"],["dw-th","","dwAlign","right","dwWidth","140px"],["dw-th","","dwWidth","110px",4,"ngIf"],["dw-th","","dwAlign","center","dwRight","","dwWidth","120px",4,"ngIf"],[3,"dwVisible","dwWidth","dwBodyStyle","dwTitle","dwOnClose"],["dwDrawerContent",""],["totalTemplate",""],["dw-icon","","class","ant-input-clear-icon","dwTheme","fill","dwType","close-circle",3,"click",4,"ngIf"],["dw-button","","dwType","primary","dwSearch","","type","button",3,"click"],["dw-icon","","dwType","search"],["dw-icon","","dwTheme","fill","dwType","close-circle",1,"ant-input-clear-icon",3,"click"],["dw-th","","dwWidth","92px"],["dwEllipsis",""],[3,"click"],["dwAlign","right"],[4,"ngIf"],["dwAlign","center",4,"ngIf"],["dwRight",""],[1,"action-grid"],["dwActionAuthorized","","title","\u7f16\u8f91",3,"dwActionId","dwDefaultAuthorized","click",4,"ngIf"],["dwActionAuthorized","","title","\u5220\u9664",3,"dwActionId","dwDefaultAuthorized",4,"ngIf"],["dwActionAuthorized","","title","\u5ba1\u6838",3,"dwActionId","dwDefaultAuthorized","click",4,"ngIf"],["dwActionAuthorized","","title","\u64a4\u5ba1",3,"dwActionId","dwDefaultAuthorized","click",4,"ngIf"],["dwAlign","center"],[1,"status-dot","status2"],[1,"status-dot","status3"],["dwActionAuthorized","","title","\u7f16\u8f91",3,"dwActionId","dwDefaultAuthorized","click"],["src","../../../../../../assets/img/icon_edit.png","alt","\u7f16\u8f91",1,"action-icon"],["src","../../../../../../assets/img/icon_edit_hover.png","alt","\u7f16\u8f91",1,"action-icon"],["dwActionAuthorized","","title","\u5220\u9664",3,"dwActionId","dwDefaultAuthorized"],["dw-popconfirm","",3,"dwPopconfirmTitle","dwOkText","dwCancelText","dwPopconfirmPlacement","dwOnConfirm"],["dw-popconfirm","","translate",""],["src","../../../../../../assets/img/icon_delete.png","alt","\u5220\u9664",1,"action-icon"],["src","../../../../../../assets/img/icon_delete_hover.png","alt","\u5220\u9664",1,"action-icon"],["dwActionAuthorized","","title","\u5ba1\u6838",3,"dwActionId","dwDefaultAuthorized","click"],["src","../../../../../../assets/img/icon_check.png","alt","\u5ba1\u6838",1,"action-icon"],["src","../../../../../../assets/img/icon_check_hover.png","alt","\u5ba1\u6838",1,"action-icon"],["dwActionAuthorized","","title","\u64a4\u5ba1",3,"dwActionId","dwDefaultAuthorized","click"],["src","../../../../../../assets/img/icon_disapprove_nor.png","alt","\u64a4\u5ba1",1,"action-icon"],["src","../../../../../../assets/img/icon_disapprove_hover.png","alt","\u64a4\u5ba1",1,"action-icon"],["dwMode","checkable",2,"font-size","15px","line-height","28px",3,"dwChecked","dwCheckedChange"],["dw-th","","dwWidth","110px"],["dwRight","",4,"ngIf"],[1,"status-dot"],[1,"status-dot","status5"],[1,"action-box"],["dwActionAuthorized","",3,"dwActionId","dwDefaultAuthorized","click",4,"ngIf"],["dwActionAuthorized","",3,"dwActionId","dwDefaultAuthorized",4,"ngIf"],["dwActionAuthorized","",3,"dwActionId","dwDefaultAuthorized","click"],["dwActionAuthorized","",3,"dwActionId","dwDefaultAuthorized"],["dw-popconfirm","","translate","",2,"color","#0d9def"],["child",""]],template:function(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"dw-content",0),s.\u0275\u0275elementStart(1,"div",1),s.\u0275\u0275elementStart(2,"h2",2),s.\u0275\u0275elementStart(3,"span",3),s.\u0275\u0275text(4,"\u670d\u52a1\u62a5\u4ef7\u5355"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275element(5,"dw-divider"),s.\u0275\u0275elementStart(6,"div",4),s.\u0275\u0275elementStart(7,"form",5),s.\u0275\u0275elementStart(8,"div",6),s.\u0275\u0275elementStart(9,"div",7),s.\u0275\u0275elementStart(10,"div",8),s.\u0275\u0275text(11,"\u65e5\u671f"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(12,"dw-form-item",9),s.\u0275\u0275elementStart(13,"dw-form-control"),s.\u0275\u0275element(14,"dw-range-picker",10),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(15,"div",7),s.\u0275\u0275elementStart(16,"div",8),s.\u0275\u0275text(17,"\u5ba2\u6237"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(18,"dw-form-item",11),s.\u0275\u0275elementStart(19,"dw-form-control"),s.\u0275\u0275elementStart(20,"dw-input-group",12),s.\u0275\u0275element(21,"input",13),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(22,ie,3,1,"ng-template",null,14,s.\u0275\u0275templateRefExtractor),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(24,"div",7),s.\u0275\u0275elementStart(25,"div",8),s.\u0275\u0275text(26,"\u670d\u52a1\u5de5\u5355"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(27,"dw-form-item",11),s.\u0275\u0275elementStart(28,"dw-form-control"),s.\u0275\u0275elementStart(29,"dw-input-group",15),s.\u0275\u0275element(30,"input",16),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(31,oe,1,1,"ng-template",null,17,s.\u0275\u0275templateRefExtractor),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(33,"div",7),s.\u0275\u0275elementStart(34,"button",18),s.\u0275\u0275listener("dwClick",function(){return t.search.pageNumber=1,t.loadData()}),s.\u0275\u0275text(35),s.\u0275\u0275pipe(36,"translate"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(37,"button",19),s.\u0275\u0275listener("click",function(){return t.search.pageNumber=1,t.reset()}),s.\u0275\u0275text(38),s.\u0275\u0275pipe(39,"translate"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(40,"div",20),s.\u0275\u0275elementStart(41,"div",21),s.\u0275\u0275elementStart(42,"button",22),s.\u0275\u0275listener("click",function(){return t.create()}),s.\u0275\u0275element(43,"em",23),s.\u0275\u0275elementStart(44,"span",24),s.\u0275\u0275text(45,"\u65b0\u5efa"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(46,"div",25),s.\u0275\u0275elementStart(47,"dw-tabset",26),s.\u0275\u0275listener("dwSelectChange",function(e){return t.onTabChange(e)}),s.\u0275\u0275elementStart(48,"dw-tab",27),s.\u0275\u0275elementStart(49,"dw-table",28,29),s.\u0275\u0275listener("dwPageIndexChange",function(e){return t.search.pageNumber=e})("dwPageIndexChange",function(e){return t.onPageIndexChange(e)})("dwPageSizeChange",function(e){return t.search.pageSize=e})("dwPageSizeChange",function(){return t.onPageSizeChange()}),s.\u0275\u0275elementStart(51,"thead",30),s.\u0275\u0275listener("dwSortOrderChange",function(e){return t.order(e)}),s.\u0275\u0275elementStart(52,"tr",31),s.\u0275\u0275elementStart(53,"th",32),s.\u0275\u0275elementStart(54,"span",24),s.\u0275\u0275text(55,"\u586b\u5355\u65e5\u671f"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(56,"th",33),s.\u0275\u0275elementStart(57,"span",24),s.\u0275\u0275text(58,"\u670d\u52a1\u62a5\u4ef7\u5355\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(59,"th",34),s.\u0275\u0275elementStart(60,"span",24),s.\u0275\u0275text(61,"\u670d\u52a1\u5355\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(62,"th",35),s.\u0275\u0275elementStart(63,"span",24),s.\u0275\u0275text(64,"\u5ba2\u6237"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(65,"th",35),s.\u0275\u0275elementStart(66,"span",24),s.\u0275\u0275text(67,"\u4ea7\u54c1"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(68,"th",34),s.\u0275\u0275template(69,se,2,0,"span",36),s.\u0275\u0275template(70,le,2,0,"span",36),s.\u0275\u0275template(71,de,2,0,"span",36),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(72,"th",37),s.\u0275\u0275elementStart(73,"span",24),s.\u0275\u0275text(74,"\u91d1\u989d"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(75,ce,3,0,"th",38),s.\u0275\u0275template(76,me,3,0,"th",39),s.\u0275\u0275template(77,pe,3,0,"th",39),s.\u0275\u0275elementStart(78,"th",40),s.\u0275\u0275elementStart(79,"span",24),s.\u0275\u0275text(80,"\u72b6\u6001"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(81,"th",41),s.\u0275\u0275elementStart(82,"span",24),s.\u0275\u0275text(83,"\u64cd\u4f5c"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(84,"tbody"),s.\u0275\u0275template(85,Ce,30,21,"tr",42),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(86,"dw-tab",27),s.\u0275\u0275elementStart(87,"div",43),s.\u0275\u0275elementStart(88,"div",44),s.\u0275\u0275text(89,"\u72b6\u6001:"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(90,"div",45),s.\u0275\u0275template(91,be,2,2,"dw-tag",46),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(92,"dw-table",28,29),s.\u0275\u0275listener("dwPageIndexChange",function(e){return t.search.pageNumber=e})("dwPageIndexChange",function(e){return t.onPageIndexChange(e)})("dwPageSizeChange",function(e){return t.search.pageSize=e})("dwPageSizeChange",function(){return t.onPageSizeChange()}),s.\u0275\u0275elementStart(94,"thead",30),s.\u0275\u0275listener("dwSortOrderChange",function(e){return t.order(e)}),s.\u0275\u0275elementStart(95,"tr",31),s.\u0275\u0275elementStart(96,"th",32),s.\u0275\u0275elementStart(97,"span",24),s.\u0275\u0275text(98,"\u586b\u5355\u65e5\u671f"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(99,"th",47),s.\u0275\u0275elementStart(100,"span",24),s.\u0275\u0275text(101,"\u5355\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(102,"th",35),s.\u0275\u0275elementStart(103,"span",24),s.\u0275\u0275text(104,"\u5ba2\u6237"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(105,"th",35),s.\u0275\u0275elementStart(106,"span",24),s.\u0275\u0275text(107,"\u4ea7\u54c1"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(108,"th",34),s.\u0275\u0275template(109,Ie,2,0,"span",36),s.\u0275\u0275template(110,De,2,0,"span",36),s.\u0275\u0275template(111,Oe,2,0,"span",36),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(112,"th",48),s.\u0275\u0275elementStart(113,"span",24),s.\u0275\u0275text(114,"\u91d1\u989d"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(115,Pe,3,0,"th",38),s.\u0275\u0275template(116,Me,3,0,"th",39),s.\u0275\u0275template(117,Te,3,0,"th",39),s.\u0275\u0275template(118,Ve,3,0,"th",49),s.\u0275\u0275template(119,ke,3,0,"th",50),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(120,"tbody"),s.\u0275\u0275template(121,Ke,22,16,"tr",42),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(122,"dw-drawer",51),s.\u0275\u0275listener("dwOnClose",function(){return t.isCollapsed=!1}),s.\u0275\u0275template(123,Ze,2,0,"ng-template",52),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(124,Je,1,1,"ng-template",null,53,s.\u0275\u0275templateRefExtractor)),2&e){const e=s.\u0275\u0275reference(23),n=s.\u0275\u0275reference(32),r=s.\u0275\u0275reference(50),i=s.\u0275\u0275reference(125);s.\u0275\u0275advance(7),s.\u0275\u0275property("formGroup",t.searchForm),s.\u0275\u0275advance(13),s.\u0275\u0275property("dwSuffix",e),s.\u0275\u0275advance(9),s.\u0275\u0275property("dwSuffix",n),s.\u0275\u0275advance(5),s.\u0275\u0275property("dwType","primary")("dwActionId","query"),s.\u0275\u0275advance(1),s.\u0275\u0275textInterpolate1("",s.\u0275\u0275pipeBind1(36,54,"\u67e5\u8be2")," "),s.\u0275\u0275advance(2),s.\u0275\u0275property("dwType","defult"),s.\u0275\u0275advance(1),s.\u0275\u0275textInterpolate1(" ",s.\u0275\u0275pipeBind1(39,56,"\u91cd\u7f6e")," "),s.\u0275\u0275advance(2),s.\u0275\u0275property("dwActionId","add")("dwDefaultAuthorized","disabled"),s.\u0275\u0275advance(2),s.\u0275\u0275property("dwType","primary")("dwActionId","add")("dwDefaultAuthorized","disabled"),s.\u0275\u0275advance(5),s.\u0275\u0275property("dwTabPosition","top")("dwSelectedIndex",t.queryType)("dwType","line")("dwAnimated",!1),s.\u0275\u0275advance(1),s.\u0275\u0275property("dwTitle","\u7ef4\u4fee\u670d\u52a1\u62a5\u4ef7"),s.\u0275\u0275advance(1),s.\u0275\u0275property("dwData",t.dataList)("dwTotal",t.rowCount)("dwFrontPagination",!1)("dwPageIndex",t.search.pageNumber)("dwPageSize",t.search.pageSize)("dwShowTotal",i)("dwScroll",s.\u0275\u0275pureFunction0(58,Ye)),s.\u0275\u0275advance(20),s.\u0275\u0275property("ngIf","1"===t.fileType),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","2"===t.fileType),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","0"===t.fileType),s.\u0275\u0275advance(4),s.\u0275\u0275property("ngIf",t.isIntegrated),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",t.isIntegrated),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",t.isIntegrated),s.\u0275\u0275advance(8),s.\u0275\u0275property("ngForOf",r.data),s.\u0275\u0275advance(1),s.\u0275\u0275property("dwTitle","\u6613\u635f\u4ef6\u9500\u552e\u62a5\u4ef7"),s.\u0275\u0275advance(5),s.\u0275\u0275property("ngForOf",t.fiterTags),s.\u0275\u0275advance(1),s.\u0275\u0275property("dwData",t.dataList)("dwTotal",t.rowCount)("dwFrontPagination",!1)("dwPageIndex",t.search.pageNumber)("dwPageSize",t.search.pageSize)("dwShowTotal",i)("dwScroll",s.\u0275\u0275pureFunction0(59,Xe)),s.\u0275\u0275advance(17),s.\u0275\u0275property("ngIf","1"===t.fileType),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","2"===t.fileType),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","0"===t.fileType),s.\u0275\u0275advance(4),s.\u0275\u0275property("ngIf",t.isIntegrated&&"4"===t.state&&"0"===t.erp_collection_status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",t.isIntegrated&&"4"===t.state&&"0"===t.erp_collection_status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",t.isIntegrated&&"4"===t.state&&"0"===t.erp_collection_status),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",!("4"===t.state&&"1"===t.erp_collection_status)),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","4"!==t.state),s.\u0275\u0275advance(2),s.\u0275\u0275property("ngForOf",r.data),s.\u0275\u0275advance(1),s.\u0275\u0275property("dwVisible",t.isCollapsed)("dwWidth","70%")("dwBodyStyle",s.\u0275\u0275pureFunction0(60,et))("dwTitle",t.detailTitle)}},directives:[z.DwContentComponent,L.DwDividerComponent,m.\u0275NgNoValidate,m.NgControlStatusGroup,m.FormGroupDirective,w.DwRowDirective,j.DwFormItemComponent,w.DwColDirective,j.DwFormControlComponent,G.DwDatePickerComponent,G.DwRangePickerComponent,m.NgControlStatus,m.FormControlName,Q.DwInputGroupComponent,W.u,Q.DwInputGroupWhitSuffixOrPrefixDirective,Q.DwInputDirective,m.DefaultValueAccessor,B.DwButtonComponent,U.uG,K.DwActionAuthorizedDirective,Z.DwAnalyticsOn,J.DwIconDirective,_.TranslateDirective,Y.DwTabSetComponent,Y.DwTabComponent,S.DwTableComponent,S.DwTheadComponent,S.DwTrDirective,S.DwTableCellDirective,S.DwThMeasureDirective,S.DwThAddOnComponent,r.NgIf,S.DwCellAlignDirective,S.DwCellFixedDirective,S.DwTbodyComponent,r.NgForOf,X.DwDrawerComponent,X.DwDrawerContentDirective,S.DwCellEllipsisDirective,ee.DwPopconfirmDirective,te.DwTagComponent,$],pipes:[_.TranslatePipe,r.DatePipe],styles:[".tag-wrap[_ngcontent-%COMP%]{display:flex;align-items:center;height:32px;margin-bottom:16px}.tag-label[_ngcontent-%COMP%]{color:#000000d9;font-size:14px;font-weight:bold;margin-right:14px;white-space:nowrap}.tags[_ngcontent-%COMP%]{color:#000000d9;white-space:nowrap}.ant-tag[_ngcontent-%COMP%]{height:32px;line-height:32px;padding:0 16px}.ant-tag[_ngcontent-%COMP%]:last-child{margin-right:0}.ant-tag-checkable-checked[_ngcontent-%COMP%], .ant-tag[_ngcontent-%COMP%]:hover{background:#f2f2f2;border-radius:16px;color:#000000d9}.status-dot[_ngcontent-%COMP%]{display:inline-block;width:8px;height:8px;border-radius:4px;margin-right:8px;background:#f3a830}.status-dot.status2[_ngcontent-%COMP%]{background:#f07360}.status-dot.status3[_ngcontent-%COMP%]{background:#58cfdd}.status-dot.status4[_ngcontent-%COMP%]{background:#73ce7e}.status-dot.status5[_ngcontent-%COMP%]{background:#188AF9}.action-box[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.action-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{color:#0d9def;cursor:pointer;margin:0 5px}"]}),e})();var nt=n(47372);class rt extends g.DwClientPagingDataSource{constructor(e,t){super(),this.dwDapHttp=e,this.url=t}getDataList(e,t){return this.dwDapHttp.get(this.url).pipe((0,nt.map)(n=>(this._result={currentPage:e,datas:Object.assign([],n.data.service_order),pageCount:Math.ceil(n.data.service_order.length/t),pageSize:t,rowCount:n.data.service_order.length},this._result)))}}let it=(()=>{class e{constructor(e,t){this.dwHttp=e,this.selectModalService=t,this.config={modalTitle:"\u9009\u62e9\u670d\u52a1\u5de5\u5355",modalWidth:"80%",tableMultiSelect:!1,tableIdField:"service_order_id",tableNameField:"doc_no",tablePageSize:10,tableColDefs:[{title:"\u670d\u52a1\u5355\u53f7",field:"doc_no"},{title:"\u65e5\u671f",field:"doc_date",dataPipe:"date:yyyy-MM-dd",width:"100px"},{title:"\u5ba2\u6237\u540d\u79f0",field:"customer_name"},{title:"\u8bbe\u5907\u540d\u79f0",field:"product_file_name"},{title:"\u8bbe\u5907\u578b\u53f7",field:"model"},{title:"\u5e8f\u5217\u53f7",field:"sn"},{title:"\u89c4\u683c",field:"specification"}],dataSource:new rt(this.dwHttp,"restful/service/serviceOrder/ServiceOrder/ServiceOrderListForQuotation")}}open(e){return this.selectModalService.open(this.config,e).pipe((0,nt.switchMap)(e=>this.dwHttp.get(`restful/service/serviceOrder/ServiceOrder/ServiceOrderByIdForOpener?id=${e[0]}`)))}}return e.\u0275fac=function(t){return new(t||e)(s.\u0275\u0275inject(p.DwDapHttpClient),s.\u0275\u0275inject(g.DwSelectModalService))},e.\u0275prov=s.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac}),e})();var at=n(13437),ot=n(35626),st=n(91970);function lt(e,t){1&e&&(s.\u0275\u0275elementStart(0,"div"),s.\u0275\u0275text(1,"\u221a"),s.\u0275\u0275elementEnd())}function dt(e,t){1&e&&(s.\u0275\u0275elementStart(0,"div"),s.\u0275\u0275text(1,"\u221a"),s.\u0275\u0275elementEnd())}function ct(e,t){1&e&&(s.\u0275\u0275elementStart(0,"div"),s.\u0275\u0275text(1,"\u221a"),s.\u0275\u0275elementEnd())}let mt=(()=>{class e{constructor(e,t){this.commonHttpService=e,this.message=t,this.visibleChanged=new s.EventEmitter,this.default_id="",this.custom_view_id="",this.custom_config=null}ngOnInit(){console.log("ngOnInit")}init(e,t){this.poiX=e,this.poiY=t,this.commonHttpService.get(`restful/service/autoSettings/CustomView/CustomView?viewId=${this.view_id}`).subscribe(e=>{if(this.custom_config=e.data.custom_view_id?e.data.config:null,this.custom_view_id=e.data.custom_view_id||"",e.data.config&&e.data.config.viewConfig&&e.data.config.viewConfig.length){const t=e.data.config.viewConfig.filter(e=>e.optionId===this.optionId);this.default_id=t.length?t[0].deafult:""}else this.default_id=""},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)})}chooseDefault(e,t){e.stopPropagation();const n=this.default_id===t?"":t;if(this.custom_config){let e=null;const t=JSON.parse(JSON.stringify(this.custom_config));t.viewConfig.forEach((t,n)=>{t.optionId===this.optionId&&(e=n)}),null!==e?t.viewConfig[e].deafult=n:t.viewConfig.push({optionId:this.optionId,deafult:n});const r={custom_view_id:this.custom_view_id,config:t};this.commonHttpService.put("restful/service/autoSettings/CustomView/CustomView",{param:r}).subscribe(e=>{this.default_id=n,this.custom_config=r.config,this.visibleChanged.emit({value:n,visible:!0})})}else{const e={view_id:this.view_id,config:{viewConfig:[{optionId:this.optionId,deafult:n}]}};this.commonHttpService.post("restful/service/autoSettings/CustomView/CustomView",{param:e}).subscribe(t=>{this.default_id=n,this.custom_config=e.config,this.visibleChanged.emit({value:n,visible:!0})})}}close(){this.visibleChanged.emit({value:"",visible:!1})}}return e.\u0275fac=function(t){return new(t||e)(s.\u0275\u0275directiveInject(R.$),s.\u0275\u0275directiveInject(d.DwMessageService))},e.\u0275cmp=s.\u0275\u0275defineComponent({type:e,selectors:[["app-custom-part"]],inputs:{visible:"visible",view_id:"view_id",optionId:"optionId"},outputs:{visibleChanged:"visibleChanged"},decls:11,vars:9,consts:[[1,"custom_part",3,"click"],[1,"options"],[1,"one_option",3,"click"],[4,"ngIf"]],template:function(e,t){1&e&&(s.\u0275\u0275elementStart(0,"div",0),s.\u0275\u0275listener("click",function(){return t.close()}),s.\u0275\u0275elementStart(1,"div",1),s.\u0275\u0275elementStart(2,"div",2),s.\u0275\u0275listener("click",function(e){return t.chooseDefault(e,"0")}),s.\u0275\u0275template(3,lt,2,0,"div",3),s.\u0275\u0275text(4," \u5e38\u7528\u914d\u4ef6 "),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(5,"div",2),s.\u0275\u0275listener("click",function(e){return t.chooseDefault(e,"1")}),s.\u0275\u0275template(6,dt,2,0,"div",3),s.\u0275\u0275text(7," \u914d\u4ef6\u4fe1\u606f "),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(8,"div",2),s.\u0275\u0275listener("click",function(e){return t.chooseDefault(e,"2")}),s.\u0275\u0275template(9,ct,2,0,"div",3),s.\u0275\u0275text(10," \u6613\u635f\u4ef6\u6e05\u5355 "),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()),2&e&&(s.\u0275\u0275styleProp("top",t.visible?0:-999999999999999,"px"),s.\u0275\u0275advance(1),s.\u0275\u0275styleProp("left",t.poiX,"px")("top",t.poiY,"px"),s.\u0275\u0275advance(2),s.\u0275\u0275property("ngIf","0"===t.default_id),s.\u0275\u0275advance(3),s.\u0275\u0275property("ngIf","1"===t.default_id),s.\u0275\u0275advance(3),s.\u0275\u0275property("ngIf","2"===t.default_id))},directives:[r.NgIf],styles:[".custom_part[_ngcontent-%COMP%]{width:100vw;height:100vh;position:fixed;left:0;top:0;z-index:1001}.custom_part[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{position:absolute;background:#fff;border-radius:2px;box-shadow:0 3px 6px -4px #0000001f,0 6px 16px #00000014,0 9px 28px 8px #0000000d}.custom_part[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .one_option[_ngcontent-%COMP%]{padding:5px 12px 5px 28px;color:#000000a6;font-size:14px;line-height:22px;white-space:nowrap;cursor:pointer;position:relative}.custom_part[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .one_option[_ngcontent-%COMP%]:hover{background:#f5f5f5}.custom_part[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .one_option[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:28px;height:100%;font-weight:bold;font-size:16px;display:flex;align-items:center;justify-content:center}"]}),e})();var pt=n(74591),ut=n(90697);const ht=["child"];function gt(e,t){1&e&&s.\u0275\u0275element(0,"dw-option",21)}function ft(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"div",22),s.\u0275\u0275listener("click",function(){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext(2).clearInput()}),s.\u0275\u0275element(1,"em",23),s.\u0275\u0275elementEnd()}}function vt(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"div",24),s.\u0275\u0275listener("click",function(){const t=s.\u0275\u0275restoreView(e).index;return s.\u0275\u0275nextContext(2).swichNav(t)}),s.\u0275\u0275text(1),s.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=t.index,r=s.\u0275\u0275nextContext(2);s.\u0275\u0275classMap(r.currOrigTab==n?"swiper-tab-list tab-on":"swiper-tab-list"),s.\u0275\u0275advance(1),s.\u0275\u0275textInterpolate1(" ",e.itemGroupName," ")}}function wt(e,t){if(1&e&&s.\u0275\u0275element(0,"app-big-img",37),2&e){const e=s.\u0275\u0275nextContext().$implicit;s.\u0275\u0275property("item",e)}}function St(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"tr"),s.\u0275\u0275elementStart(1,"td",34),s.\u0275\u0275element(2,"label",35),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(3,"td"),s.\u0275\u0275text(4),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(5,"td"),s.\u0275\u0275text(6),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(7,"td"),s.\u0275\u0275text(8),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(9,"td"),s.\u0275\u0275text(10),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(11,"td"),s.\u0275\u0275template(12,wt,1,1,"app-big-img",36),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;s.\u0275\u0275advance(1),s.\u0275\u0275property("dwAlign","center"),s.\u0275\u0275advance(1),s.\u0275\u0275property("dwValue",e.material_id),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.material_code," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.material_name," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.specification," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.model," "),s.\u0275\u0275advance(2),s.\u0275\u0275property("ngIf",e.url)}}function _t(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"div"),s.\u0275\u0275elementStart(1,"dw-table",25,26),s.\u0275\u0275listener("dwPageIndexChange",function(t){const n=s.\u0275\u0275restoreView(e).index;return s.\u0275\u0275nextContext(2).materialGroups[n].pageIndex=t})("dwPageSizeChange",function(t){const n=s.\u0275\u0275restoreView(e).index;return s.\u0275\u0275nextContext(2).materialGroups[n].pageSize=t})("dwPageIndexChange",function(t){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext(2).pageIndexChange(t)}),s.\u0275\u0275elementStart(3,"thead"),s.\u0275\u0275elementStart(4,"tr",27),s.\u0275\u0275elementStart(5,"th",28),s.\u0275\u0275element(6,"span",29),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(7,"th",30),s.\u0275\u0275elementStart(8,"span",29),s.\u0275\u0275text(9,"\u914d\u4ef6\u7f16\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(10,"th",31),s.\u0275\u0275elementStart(11,"span",29),s.\u0275\u0275text(12,"\u914d\u4ef6\u540d\u79f0"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(13,"th",31),s.\u0275\u0275elementStart(14,"span",29),s.\u0275\u0275text(15,"\u89c4\u683c"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(16,"th",31),s.\u0275\u0275elementStart(17,"span",29),s.\u0275\u0275text(18,"\u578b\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(19,"th",32),s.\u0275\u0275elementStart(20,"span",29),s.\u0275\u0275text(21,"\u56fe\u7247"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(22,"tbody"),s.\u0275\u0275template(23,St,13,7,"tr",33),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()}if(2&e){const e=t.index,n=s.\u0275\u0275reference(2),r=s.\u0275\u0275nextContext(2);s.\u0275\u0275classMap(r.currOrigTab==e?"scroll-box":"scroll-box hide"),s.\u0275\u0275advance(1),s.\u0275\u0275property("dwData",r.materialGroups[e].list)("dwFrontPagination",!1)("dwTotal",r.materialGroups[e].itemCount)("dwPageIndex",r.materialGroups[e].pageIndex)("dwPageSize",r.materialGroups[e].pageSize),s.\u0275\u0275advance(22),s.\u0275\u0275property("ngForOf",n.data)}}function xt(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"div",4),s.\u0275\u0275elementStart(1,"div",5),s.\u0275\u0275elementStart(2,"div",6),s.\u0275\u0275listener("contextmenu",function(t){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext().rightClick(t)}),s.\u0275\u0275elementStart(3,"dw-select",7),s.\u0275\u0275listener("ngModelChange",function(t){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext().typeIdx=t})("ngModelChange",function(t){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext().bindPickerChange(t)}),s.\u0275\u0275template(4,gt,1,0,"dw-option",8),s.\u0275\u0275element(5,"dw-option",9),s.\u0275\u0275element(6,"dw-option",10),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(7,"div",11),s.\u0275\u0275elementStart(8,"div",12),s.\u0275\u0275listener("click",function(){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext().getMaterialGroups()}),s.\u0275\u0275element(9,"em",13),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(10,"input",14),s.\u0275\u0275listener("ngModelChange",function(t){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext().searchValue=t})("keydown",function(t){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext().onKeydown(t)}),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(11,ft,2,0,"div",15),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(12,"div",16),s.\u0275\u0275elementStart(13,"div",17),s.\u0275\u0275template(14,vt,2,3,"div",18),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(15,"dw-checkbox-wrapper",19),s.\u0275\u0275listener("dwOnChange",function(t){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext().checkboxChange(t)}),s.\u0275\u0275template(16,_t,24,8,"div",20),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()}if(2&e){const e=s.\u0275\u0275nextContext();s.\u0275\u0275advance(3),s.\u0275\u0275property("ngModel",e.typeIdx),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","1"===e.type),s.\u0275\u0275advance(6),s.\u0275\u0275property("ngModel",e.searchValue),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",e.searchValue),s.\u0275\u0275advance(3),s.\u0275\u0275property("ngForOf",e.materialGroups),s.\u0275\u0275advance(2),s.\u0275\u0275property("ngForOf",e.materialGroups)}}const yt=function(){return{height:"450px",overflow:"auto","padding-bottom":"8px"}};let Et=(()=>{class e{constructor(e,t,n){this.commonHttpService=e,this.message=t,this.serviceOrderDetailSrv=n,this.partVisibleChanged=new s.EventEmitter,this.type="1",this.product_file_id="",this.typeIdx="0",this.searchValue="",this.currOrigTab=0,this.origParts=[],this.materialGroups=[],this.chosenPartIds=[],this.showCustomPart=!1}initData(e,t="1"){!e||(this.product_file_id=e,this.type=t,this.typeIdx="1"===t?"0":"1",this.searchValue="",this.chosenPartIds=[],this.commonHttpService.get(`restful/service/autoSettings/CustomView/CustomView?viewId=${this.view_id}`).subscribe(e=>{if(e.data.config&&e.data.config.viewConfig&&e.data.config.viewConfig.length){const t=e.data.config.viewConfig.filter(e=>e.optionId===this.optionId);t.length&&t[0].deafult&&(this.typeIdx="2"===this.type&&"0"===t[0].deafult?"1":t[0].deafult)}this.getMaterialGroups()},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage),this.getMaterialGroups()}))}getMaterialGroups(){let e=`ItemGroupByProductIdForQuotation?productId=${this.product_file_id}&searchValue=${this.searchValue}`,t="getQuotationMaterialGroups";"1"===this.typeIdx&&(e=`AllMaterialGroups?searchValue=${this.searchValue}`,t="getMaterialGroups"),"2"===this.typeIdx&&(e=`QuickwearPartAllMaterialGroups?productFileId=${this.product_file_id}&searchValue=${this.searchValue}`,t="getQuickwearPartAllMaterialGroups"),this.serviceOrderDetailSrv[t](e).subscribe(e=>{this.origParts=[],this.materialGroups="0"===this.typeIdx?e.data:e;for(let t=0;t<this.materialGroups.length;t++)this.materialGroups[t].list=[],this.materialGroups[t].pageSize=10,this.materialGroups[t].pageIndex=1,this.materialGroups[t].allPages=Math.ceil(this.materialGroups[t].itemCount/this.materialGroups[t].pageSize);this.currOrigTab=0,this.materialGroups.length&&this.getOrigParts()})}pageIndexChange(e){this.materialGroups[this.currOrigTab].pageIndex=e,this.getOrigParts()}getOrigParts(){let e=`material/Material/MaterialsByProductIdForQuotation?productId=${this.product_file_id}&itemGroupId=${this.materialGroups[this.currOrigTab].itemGroupId}&searchValue=${this.searchValue}&pageIndex=${this.materialGroups[this.currOrigTab].pageIndex}&pageSize=${this.materialGroups[this.currOrigTab].pageSize}`;"1"===this.typeIdx&&(e=`material/Material/MaterialListByPageForQuotation?searchValue=${this.searchValue}&itemGroupId=${this.materialGroups[this.currOrigTab].itemGroupId}&pageIndex=${this.materialGroups[this.currOrigTab].pageIndex}&pageSize=${this.materialGroups[this.currOrigTab].pageSize}`),"2"===this.typeIdx&&(e=`productFile/QuickwearPart/MaterialForOpenner?productFileId=${this.product_file_id}&searchValue=${this.searchValue}&itemGroupId=${this.materialGroups[this.currOrigTab].itemGroupId}&pageIndex=${this.materialGroups[this.currOrigTab].pageIndex}&pageSize=${this.materialGroups[this.currOrigTab].pageSize}`),this.serviceOrderDetailSrv.getQuotationMaterialList(e).subscribe(e=>{this.materialGroups[this.currOrigTab].list=e.data.quotation})}checkboxChange(e){this.chosenPartIds=e}clearInput(){this.searchValue="",this.getMaterialGroups()}bindPickerChange(e){this.getMaterialGroups()}swichNav(e){this.currOrigTab!==e&&(this.currOrigTab=e,this.materialGroups[this.currOrigTab].list.length||this.getOrigParts())}close(){this.partVisibleChanged.emit(null)}chooseOk(){const e=[];this.materialGroups.forEach(t=>{t.list.forEach(t=>{this.chosenPartIds.indexOf(t.material_id)>=0&&e.push(t)})}),this.partVisibleChanged.emit(e)}onKeydown(e){13===e.keyCode&&this.getMaterialGroups()}ngOnInit(){}rightClick(e){e.preventDefault(),e.stopPropagation(),console.log(e),this.showCustomPart=!0,this.child.init(e.x,e.y)}customPartVisibleChanged(e){this.showCustomPart=e.visible,""!==e.value&&this.typeIdx!==e.value&&(this.typeIdx="2"===this.type&&"0"===e.value?"1":e.value,this.getMaterialGroups())}}return e.\u0275fac=function(t){return new(t||e)(s.\u0275\u0275directiveInject(R.$),s.\u0275\u0275directiveInject(d.DwMessageService),s.\u0275\u0275directiveInject(st.v))},e.\u0275cmp=s.\u0275\u0275defineComponent({type:e,selectors:[["app-part-opener"]],viewQuery:function(e,t){if(1&e&&s.\u0275\u0275viewQuery(ht,5),2&e){let e;s.\u0275\u0275queryRefresh(e=s.\u0275\u0275loadQuery())&&(t.child=e.first)}},inputs:{visible:"visible",view_id:"view_id",optionId:"optionId"},outputs:{partVisibleChanged:"partVisibleChanged"},decls:4,vars:8,consts:[["dwTitle","\u9009\u62e9\u914d\u4ef6",3,"dwBodyStyle","dwMaskClosable","dwWidth","dwVisible","dwVisibleChange","dwOnCancel","dwOnOk"],["dwModalContent",""],[3,"visible","view_id","optionId","visibleChanged"],["child",""],[1,"wrapper"],[1,"top-box"],[1,"select-box",3,"contextmenu"],[2,"width","100%",3,"ngModel","ngModelChange"],["dwValue","0","dwLabel","\u5e38\u7528\u914d\u4ef6",4,"ngIf"],["dwValue","1","dwLabel","\u914d\u4ef6\u4fe1\u606f"],["dwValue","2","dwLabel","\u6613\u635f\u4ef6\u6e05\u5355"],[1,"search-box"],[1,"search",3,"click"],["dw-icon","","dwType","search","dwTheme","outline"],["dw-input","","type","text","placeholder","\u641c\u7d22",3,"ngModel","ngModelChange","keydown"],["class","close",3,"click",4,"ngIf"],[1,"choose-wrap"],[1,"swiper-tab"],[3,"class","click",4,"ngFor","ngForOf"],[1,"radio-group",3,"dwOnChange"],[3,"class",4,"ngFor","ngForOf"],["dwValue","0","dwLabel","\u5e38\u7528\u914d\u4ef6"],[1,"close",3,"click"],["dw-icon","","dwTheme","fill","dwType","close-circle",1,"ant-input-clear-icon"],[3,"click"],[3,"dwData","dwFrontPagination","dwTotal","dwPageIndex","dwPageSize","dwPageIndexChange","dwPageSizeChange"],["dwTable",""],["dw-tr",""],["dw-th","","dwWidth","40px"],["translate",""],["dw-th","","dwWidth","116px"],["dw-th","","dwWidth","120px"],["dw-th","","dwWidth","88px"],[4,"ngFor","ngForOf"],["width","40",3,"dwAlign"],["dw-checkbox","",3,"dwValue"],[3,"item",4,"ngIf"],[3,"item"]],template:function(e,t){1&e&&(s.\u0275\u0275elementStart(0,"dw-modal",0),s.\u0275\u0275listener("dwVisibleChange",function(e){return t.visible=e})("dwOnCancel",function(){return t.close()})("dwOnOk",function(){return t.chooseOk()}),s.\u0275\u0275template(1,xt,17,6,"ng-template",1),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(2,"app-custom-part",2,3),s.\u0275\u0275listener("visibleChanged",function(e){return t.customPartVisibleChanged(e)}),s.\u0275\u0275elementEnd()),2&e&&(s.\u0275\u0275property("dwBodyStyle",s.\u0275\u0275pureFunction0(7,yt))("dwMaskClosable",!0)("dwWidth",800)("dwVisible",t.visible),s.\u0275\u0275advance(2),s.\u0275\u0275property("visible",t.showCustomPart)("view_id",t.view_id)("optionId",t.optionId))},directives:[c.DwModalComponent,c.DwModalContentDirective,mt,ot.DwSelectComponent,m.NgControlStatus,m.NgModel,r.NgIf,ot.DwOptionComponent,J.DwIconDirective,W.u,Q.DwInputDirective,m.DefaultValueAccessor,r.NgForOf,pt.DwCheckboxWrapperComponent,S.DwTableComponent,S.DwTheadComponent,S.DwTrDirective,S.DwTableCellDirective,S.DwThMeasureDirective,_.TranslateDirective,S.DwTbodyComponent,S.DwCellAlignDirective,pt.DwCheckboxComponent,ut.a],styles:[".top-box[_ngcontent-%COMP%]{width:100%;height:32px;display:flex;margin-bottom:24px}.select-box[_ngcontent-%COMP%]{width:120px;height:100%;margin-right:24px}.search-box[_ngcontent-%COMP%]{flex:1;height:100%;position:relative}.search-box[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{width:30px;height:100%;display:flex;align-items:center;justify-content:center;position:absolute;top:0;left:0;z-index:2}.search-box[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-size:16px;color:#999}.search-box[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{position:absolute;top:0;right:8px;font-size:20px}.search-box[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]   .ant-input-clear-icon[_ngcontent-%COMP%]:last-child{font-size:16px}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:32px;background:#fff;border-radius:4px;padding:0 30px}.choose-wrap[_ngcontent-%COMP%]{height:354px;flex:1;display:flex}.swiper-tab[_ngcontent-%COMP%]{width:120px;height:100%;overflow-y:auto;margin-right:24px}.swiper-tab[_ngcontent-%COMP%]   .swiper-tab-list[_ngcontent-%COMP%]{width:100%;min-height:40px;line-height:40px;text-align:center;color:#000000a6;font-size:14px;background:#e8e8e8;cursor:pointer}.swiper-tab[_ngcontent-%COMP%]   .swiper-tab-list.tab-on[_ngcontent-%COMP%]{color:#fff;background:#00a3ff}.radio-group[_ngcontent-%COMP%]{flex:1;height:100%;position:relative;overflow:auto}.scroll-box[_ngcontent-%COMP%]{height:100%}.scroll-box.hide[_ngcontent-%COMP%]{display:none}.warranty[_ngcontent-%COMP%]{display:inline-block;width:60px;height:24px;line-height:22px;text-align:center;color:#00af26;font-size:12px;border:1px solid #84d997;border-radius:12px}.warranty.red[_ngcontent-%COMP%]{color:#fe3a3a;border-color:#fe4949}.ant-radio-wrapper[_ngcontent-%COMP%]{margin-right:0}"]}),e})();var Ct=n(61937),bt=n(82542);function It(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"div",29),s.\u0275\u0275listener("click",function(){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext(2).clearInput()}),s.\u0275\u0275element(1,"em",30),s.\u0275\u0275elementEnd()}}function Dt(e,t){1&e&&(s.\u0275\u0275elementStart(0,"th",31),s.\u0275\u0275elementStart(1,"span",18),s.\u0275\u0275text(2,"\u7c7b\u578b"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd())}function Ot(e,t){1&e&&(s.\u0275\u0275elementStart(0,"span",18),s.\u0275\u0275text(1,"\u5e8f\u5217\u53f7"),s.\u0275\u0275elementEnd())}function Pt(e,t){1&e&&(s.\u0275\u0275elementStart(0,"span",18),s.\u0275\u0275text(1,"\u9879\u76ee\u53f7"),s.\u0275\u0275elementEnd())}function Mt(e,t){1&e&&(s.\u0275\u0275elementStart(0,"span",18),s.\u0275\u0275text(1,"\u5e8f\u5217\u53f7/\u9879\u76ee\u53f7"),s.\u0275\u0275elementEnd())}function Tt(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"td"),s.\u0275\u0275text(1),s.\u0275\u0275elementEnd()),2&e){const e=s.\u0275\u0275nextContext().$implicit;s.\u0275\u0275advance(1),s.\u0275\u0275textInterpolate1(" ","1"===e.type?"\u5355\u673a":"\u4ea7\u7ebf/\u9879\u76ee"," ")}}function Vt(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"tr"),s.\u0275\u0275elementStart(1,"td",32),s.\u0275\u0275element(2,"label",33),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(3,"td"),s.\u0275\u0275text(4),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(5,"td"),s.\u0275\u0275text(6),s.\u0275\u0275pipe(7,"date"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(8,"td"),s.\u0275\u0275text(9),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(10,Tt,2,1,"td",34),s.\u0275\u0275elementStart(11,"td"),s.\u0275\u0275text(12),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(13,"td"),s.\u0275\u0275text(14),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(15,"td"),s.\u0275\u0275text(16),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(17,"td"),s.\u0275\u0275text(18),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()),2&e){const e=t.$implicit,n=s.\u0275\u0275nextContext(2);s.\u0275\u0275advance(1),s.\u0275\u0275property("dwAlign","center"),s.\u0275\u0275advance(1),s.\u0275\u0275propertyInterpolate("dwValue",e.service_order_id),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.doc_no," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",s.\u0275\u0275pipeBind2(7,10,e.doc_date,"yyyy-MM-dd")," "),s.\u0275\u0275advance(3),s.\u0275\u0275textInterpolate1(" ",e.customer_name," "),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","0"===n.fileType),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.product_file_name," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.model," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.sn," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.specification," ")}}function kt(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"div",2),s.\u0275\u0275elementStart(1,"div",3),s.\u0275\u0275elementStart(2,"div",4),s.\u0275\u0275elementStart(3,"div",5),s.\u0275\u0275listener("click",function(){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext().getServiceOrderList()}),s.\u0275\u0275element(4,"em",6),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(5,"input",7),s.\u0275\u0275listener("ngModelChange",function(t){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext().searchValue=t})("keydown",function(t){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext().onKeydown(t)}),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(6,It,2,0,"div",8),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(7,"div",9),s.\u0275\u0275elementStart(8,"label",10),s.\u0275\u0275listener("ngModelChange",function(t){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext().onlyNotComplete=t})("ngModelChange",function(t){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext().checkboxChange(t)}),s.\u0275\u0275text(9," \u4ec5\u663e\u793a\u672a\u5b8c\u6210\u7684\u5de5\u5355 "),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(10,"div",11),s.\u0275\u0275elementStart(11,"dw-radio-group",12),s.\u0275\u0275listener("ngModelChange",function(t){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext().service_order_id=t}),s.\u0275\u0275elementStart(12,"div"),s.\u0275\u0275elementStart(13,"dw-table",13,14),s.\u0275\u0275elementStart(15,"thead",15),s.\u0275\u0275listener("dwSortOrderChange",function(t){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext().order(t)}),s.\u0275\u0275elementStart(16,"tr",16),s.\u0275\u0275elementStart(17,"th",17),s.\u0275\u0275element(18,"span",18),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(19,"th",19),s.\u0275\u0275elementStart(20,"span",18),s.\u0275\u0275text(21,"\u670d\u52a1\u5355\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(22,"th",20),s.\u0275\u0275elementStart(23,"span",18),s.\u0275\u0275text(24,"\u65e5\u671f"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(25,"th",21),s.\u0275\u0275elementStart(26,"span",18),s.\u0275\u0275text(27,"\u5ba2\u6237\u540d\u79f0"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(28,Dt,3,0,"th",22),s.\u0275\u0275elementStart(29,"th",23),s.\u0275\u0275elementStart(30,"span",18),s.\u0275\u0275text(31,"\u8bbe\u5907\u540d\u79f0"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(32,"th",24),s.\u0275\u0275elementStart(33,"span",18),s.\u0275\u0275text(34,"\u8bbe\u5907\u578b\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(35,"th",25),s.\u0275\u0275template(36,Ot,2,0,"span",26),s.\u0275\u0275template(37,Pt,2,0,"span",26),s.\u0275\u0275template(38,Mt,2,0,"span",26),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(39,"th",27),s.\u0275\u0275elementStart(40,"span",18),s.\u0275\u0275text(41,"\u89c4\u683c"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(42,"tbody"),s.\u0275\u0275template(43,Vt,19,13,"tr",28),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()}if(2&e){const e=s.\u0275\u0275reference(14),t=s.\u0275\u0275nextContext();s.\u0275\u0275advance(5),s.\u0275\u0275property("ngModel",t.searchValue),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",t.searchValue),s.\u0275\u0275advance(2),s.\u0275\u0275property("ngModel",t.onlyNotComplete),s.\u0275\u0275advance(3),s.\u0275\u0275property("ngModel",t.service_order_id),s.\u0275\u0275advance(2),s.\u0275\u0275property("dwData",t.serviceOrderList),s.\u0275\u0275advance(15),s.\u0275\u0275property("ngIf","0"===t.fileType),s.\u0275\u0275advance(8),s.\u0275\u0275property("ngIf","1"===t.fileType),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","2"===t.fileType),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","0"===t.fileType),s.\u0275\u0275advance(5),s.\u0275\u0275property("ngForOf",e.data)}}const At=function(){return{"padding-bottom":"8px"}};let Ft=(()=>{class e{constructor(e,t,n){this.commonHttpService=e,this.message=t,this.quotationService=n,this.orderVisibleChanged=new s.EventEmitter,this.service_order_id=0,this.searchValue="",this.onlyNotComplete=!0,this.serviceOrderList=[],this.fileType="0"}initData(){this.service_order_id=0,this.searchValue="",this.getServiceOrderList()}getServiceOrderList(){this.quotationService.getServiceOrderListForQuotation({searchText:this.searchValue,onlyShowUnfinished:this.onlyNotComplete}).subscribe(e=>{this.serviceOrderList=e.data.service_order})}checkboxChange(e){this.service_order_id=0,this.getServiceOrderList()}clearInput(){this.searchValue="",this.service_order_id=0,this.getServiceOrderList()}close(){this.orderVisibleChanged.emit(null)}chooseOk(){this.orderVisibleChanged.emit(this.service_order_id)}onKeydown(e){13===e.keyCode&&(this.service_order_id=0,this.getServiceOrderList())}ngOnInit(){this.commonHttpService.get("restful/service/serviceOrder/ServiceOrder/IsShowTypeOption").subscribe(e=>{this.fileType=e.data},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)})}order(e){const t=e.key;switch(e.value){case"ascend":this.serviceOrderList=Ct.l.order(this.serviceOrderList,[t]);break;case"descend":this.serviceOrderList=Ct.l.order(this.serviceOrderList,[t,-1])}}}return e.\u0275fac=function(t){return new(t||e)(s.\u0275\u0275directiveInject(R.$),s.\u0275\u0275directiveInject(d.DwMessageService),s.\u0275\u0275directiveInject(h))},e.\u0275cmp=s.\u0275\u0275defineComponent({type:e,selectors:[["app-service-order-opener"]],inputs:{visible:"visible"},outputs:{orderVisibleChanged:"orderVisibleChanged"},decls:2,vars:5,consts:[["dwTitle","\u9009\u62e9\u670d\u52a1\u5de5\u5355",3,"dwBodyStyle","dwMaskClosable","dwWidth","dwVisible","dwVisibleChange","dwOnCancel","dwOnOk"],["dwModalContent",""],[1,"wrapper"],[1,"top-box"],[1,"search-box"],[1,"search",3,"click"],["dw-icon","","dwType","search","dwTheme","outline"],["dw-input","","type","text","placeholder","\u641c\u7d22",3,"ngModel","ngModelChange","keydown"],["class","close",3,"click",4,"ngIf"],[1,"checkbox-wrap"],["dw-checkbox","",2,"white-space","nowrap",3,"ngModel","ngModelChange"],[1,"choose-wrap"],[1,"radio-group",3,"ngModel","ngModelChange"],[3,"dwData"],["dwTable",""],[3,"dwSortOrderChange"],["dw-tr",""],["dw-th","","dwWidth","38px"],["translate",""],["dw-th","","dwWidth","144px","dwShowSort","","dwColumnKey","doc_no"],["dw-th","","dwWidth","98px","dwShowSort","","dwColumnKey","doc_date"],["dw-th","","dwWidth","118px","dwShowSort","","dwColumnKey","customer_name"],["dw-th","","dwWidth","80px","dwShowSort","","dwColumnKey","type",4,"ngIf"],["dw-th","","dwWidth","128px","dwShowSort","","dwColumnKey","product_file_name"],["dw-th","","dwWidth","112px","dwShowSort","","dwColumnKey","model"],["dw-th","","dwWidth","180px","dwShowSort","","dwColumnKey","sn"],["translate","",4,"ngIf"],["dw-th","","dwWidth","134px","dwShowSort","","dwColumnKey","specification"],[4,"ngFor","ngForOf"],[1,"close",3,"click"],["dw-icon","","dwTheme","fill","dwType","close-circle",1,"ant-input-clear-icon"],["dw-th","","dwWidth","80px","dwShowSort","","dwColumnKey","type"],[3,"dwAlign"],["dw-radio","",3,"dwValue"],[4,"ngIf"]],template:function(e,t){1&e&&(s.\u0275\u0275elementStart(0,"dw-modal",0),s.\u0275\u0275listener("dwVisibleChange",function(e){return t.visible=e})("dwOnCancel",function(){return t.close()})("dwOnOk",function(){return t.chooseOk()}),s.\u0275\u0275template(1,kt,44,10,"ng-template",1),s.\u0275\u0275elementEnd()),2&e&&s.\u0275\u0275property("dwBodyStyle",s.\u0275\u0275pureFunction0(4,At))("dwMaskClosable",!0)("dwWidth",1100)("dwVisible",t.visible)},directives:[c.DwModalComponent,c.DwModalContentDirective,J.DwIconDirective,W.u,Q.DwInputDirective,m.DefaultValueAccessor,m.NgControlStatus,m.NgModel,r.NgIf,pt.DwCheckboxComponent,bt.DwRadioGroupComponent,S.DwTableComponent,S.DwTheadComponent,S.DwTrDirective,S.DwTableCellDirective,S.DwThMeasureDirective,_.TranslateDirective,S.DwThAddOnComponent,S.DwTbodyComponent,r.NgForOf,S.DwCellAlignDirective,bt.DwRadioComponent],pipes:[r.DatePipe],styles:[".top-box[_ngcontent-%COMP%]{width:100%;height:32px;display:flex;margin-bottom:24px}.checkbox-wrap[_ngcontent-%COMP%]{display:flex;align-items:center;margin-left:16px}.search-box[_ngcontent-%COMP%]{flex:1;height:100%;position:relative}.search-box[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{width:30px;height:100%;display:flex;align-items:center;justify-content:center;position:absolute;top:0;left:0;z-index:2}.search-box[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-size:16px;color:#999}.search-box[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{position:absolute;top:0;right:8px;font-size:20px}.search-box[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]   .ant-input-clear-icon[_ngcontent-%COMP%]:last-child{font-size:16px}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:32px;background:#fff;border-radius:4px;padding:0 30px}.choose-wrap[_ngcontent-%COMP%]{flex:1;display:flex}.radio-group[_ngcontent-%COMP%]{flex:1;height:100%;position:relative;overflow:auto}.ant-radio-wrapper[_ngcontent-%COMP%]{margin-right:0}"]}),e})();var qt=n(119);function Nt(e,t){1&e&&(s.\u0275\u0275elementStart(0,"span",39),s.\u0275\u0275text(1,"\u65b0\u5efa\u670d\u52a1\u62a5\u4ef7\u5355"),s.\u0275\u0275elementEnd())}function $t(e,t){1&e&&(s.\u0275\u0275elementStart(0,"span",39),s.\u0275\u0275text(1,"\u4fee\u6539\u670d\u52a1\u62a5\u4ef7\u5355"),s.\u0275\u0275elementEnd())}function Rt(e,t){if(1&e&&s.\u0275\u0275element(0,"dw-option",40),2&e){const e=t.$implicit;s.\u0275\u0275property("dwLabel",e.quote_type_name)("dwValue",e.quote_type_id)}}function Ht(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"em",44),s.\u0275\u0275listener("click",function(){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext(2).clear()}),s.\u0275\u0275elementEnd()}}function zt(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275template(0,Ht,1,0,"em",41),s.\u0275\u0275elementStart(1,"button",42),s.\u0275\u0275listener("click",function(){s.\u0275\u0275restoreView(e);const t=s.\u0275\u0275nextContext(),n=s.\u0275\u0275reference(103);return t.openServiceOrder(),n.initData()}),s.\u0275\u0275element(2,"em",43),s.\u0275\u0275elementEnd()}if(2&e){const e=s.\u0275\u0275nextContext();s.\u0275\u0275property("ngIf",e.form.controls.product_file_id.value)}}function Lt(e,t){if(1&e&&s.\u0275\u0275element(0,"dw-option",40),2&e){const e=t.$implicit;s.\u0275\u0275property("dwLabel",e.warehouse_name)("dwValue",e.warehouse_id)}}function jt(e,t){1&e&&(s.\u0275\u0275elementStart(0,"div",12),s.\u0275\u0275text(1,"\u5e8f\u5217\u53f7"),s.\u0275\u0275elementEnd())}function Gt(e,t){1&e&&(s.\u0275\u0275elementStart(0,"div",12),s.\u0275\u0275text(1,"\u9879\u76ee\u53f7"),s.\u0275\u0275elementEnd())}function Qt(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"tr"),s.\u0275\u0275elementStart(1,"td"),s.\u0275\u0275text(2),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(3,"td"),s.\u0275\u0275text(4),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(5,"td"),s.\u0275\u0275text(6),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(7,"td"),s.\u0275\u0275text(8),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(9,"td"),s.\u0275\u0275text(10),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(11,"td"),s.\u0275\u0275elementStart(12,"dw-input-number",55),s.\u0275\u0275listener("ngModelChange",function(t){return s.\u0275\u0275restoreView(e).$implicit.price=t})("ngModelChange",function(){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext(2).partPriceChange()}),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(13,"td"),s.\u0275\u0275elementStart(14,"dw-input-number",55),s.\u0275\u0275listener("ngModelChange",function(t){return s.\u0275\u0275restoreView(e).$implicit.quality=t})("ngModelChange",function(){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext(2).partPriceChange()}),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(15,"td",56),s.\u0275\u0275text(16),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(17,"td"),s.\u0275\u0275elementStart(18,"input",57),s.\u0275\u0275listener("ngModelChange",function(t){return s.\u0275\u0275restoreView(e).$implicit.remark=t}),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(19,"td",58),s.\u0275\u0275elementStart(20,"div",59),s.\u0275\u0275elementStart(21,"div",60),s.\u0275\u0275listener("click",function(){const t=s.\u0275\u0275restoreView(e).index;return s.\u0275\u0275nextContext(2).deleteGrid("part",t)}),s.\u0275\u0275element(22,"img",61),s.\u0275\u0275element(23,"img",62),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit;s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.material_code," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.material_name," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.specification," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.model," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.unit," "),s.\u0275\u0275advance(2),s.\u0275\u0275property("ngModel",e.price)("dwMin",0)("dwPrecision",2),s.\u0275\u0275advance(2),s.\u0275\u0275property("ngModel",e.quality)("dwMin",0)("dwPrecision",2),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",(e.price*e.quality).toFixed(2)," "),s.\u0275\u0275advance(2),s.\u0275\u0275property("ngModel",e.remark)}}const Wt=function(){return{x:"1100px"}};function Bt(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"div",33),s.\u0275\u0275elementStart(1,"div",12),s.\u0275\u0275text(2,"\u9009\u62e9\u914d\u4ef6"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(3,"div",13),s.\u0275\u0275elementStart(4,"div",45),s.\u0275\u0275listener("click",function(){s.\u0275\u0275restoreView(e);const t=s.\u0275\u0275nextContext();return s.\u0275\u0275reference(101).initData(t.form.controls.product_file_id.value,t.form.controls.type.value),t.openSpareParts()}),s.\u0275\u0275element(5,"em",46),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(6,"dw-table",47,48),s.\u0275\u0275elementStart(8,"thead"),s.\u0275\u0275elementStart(9,"tr",49),s.\u0275\u0275elementStart(10,"th",50),s.\u0275\u0275elementStart(11,"span",6),s.\u0275\u0275text(12,"\u7f16\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(13,"th",50),s.\u0275\u0275elementStart(14,"span",6),s.\u0275\u0275text(15,"\u540d\u79f0"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(16,"th",50),s.\u0275\u0275elementStart(17,"span",6),s.\u0275\u0275text(18,"\u89c4\u683c"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(19,"th",50),s.\u0275\u0275elementStart(20,"span",6),s.\u0275\u0275text(21,"\u578b\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(22,"th",50),s.\u0275\u0275elementStart(23,"span",6),s.\u0275\u0275text(24,"\u5355\u4f4d"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(25,"th",50),s.\u0275\u0275elementStart(26,"span",6),s.\u0275\u0275text(27,"\u5355\u4ef7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(28,"th",50),s.\u0275\u0275elementStart(29,"span",6),s.\u0275\u0275text(30,"\u6570\u91cf"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(31,"th",51),s.\u0275\u0275elementStart(32,"span",6),s.\u0275\u0275text(33,"\u91d1\u989d"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(34,"th",50),s.\u0275\u0275elementStart(35,"span",6),s.\u0275\u0275text(36,"\u5907\u6ce8"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(37,"th",52),s.\u0275\u0275elementStart(38,"span",6),s.\u0275\u0275text(39,"\u64cd\u4f5c"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(40,"tbody"),s.\u0275\u0275template(41,Qt,24,13,"tr",53),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(42,"div",54),s.\u0275\u0275text(43," \u5408\u8ba1\uff1a"),s.\u0275\u0275elementStart(44,"span"),s.\u0275\u0275text(45),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()}if(2&e){const e=s.\u0275\u0275reference(7),t=s.\u0275\u0275nextContext();s.\u0275\u0275advance(6),s.\u0275\u0275property("dwData",t.spareParts)("dwFrontPagination",!1)("dwShowPagination",!1)("dwScroll",s.\u0275\u0275pureFunction0(6,Wt)),s.\u0275\u0275advance(35),s.\u0275\u0275property("ngForOf",e.data),s.\u0275\u0275advance(4),s.\u0275\u0275textInterpolate1("\uffe5",t.partAmountTotal,"")}}function Ut(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"tr"),s.\u0275\u0275elementStart(1,"td"),s.\u0275\u0275text(2),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(3,"td"),s.\u0275\u0275text(4),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(5,"td"),s.\u0275\u0275elementStart(6,"dw-input-number",70),s.\u0275\u0275listener("ngModelChange",function(t){return s.\u0275\u0275restoreView(e).$implicit.price=t})("ngModelChange",function(){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext(2).itemPriceChange()}),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(7,"td"),s.\u0275\u0275elementStart(8,"input",57),s.\u0275\u0275listener("ngModelChange",function(t){return s.\u0275\u0275restoreView(e).$implicit.remark=t}),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(9,"td"),s.\u0275\u0275elementStart(10,"div",59),s.\u0275\u0275elementStart(11,"div",60),s.\u0275\u0275listener("click",function(){const t=s.\u0275\u0275restoreView(e).index;return s.\u0275\u0275nextContext(2).deleteGrid("serviceItem",t)}),s.\u0275\u0275element(12,"img",61),s.\u0275\u0275element(13,"img",62),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit;s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.service_item_code," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.service_item_name," "),s.\u0275\u0275advance(2),s.\u0275\u0275property("ngModel",e.price)("dwMin",0)("dwStep",1)("dwPrecision",2),s.\u0275\u0275advance(2),s.\u0275\u0275property("ngModel",e.remark)}}function Kt(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"div",33),s.\u0275\u0275elementStart(1,"div",12),s.\u0275\u0275text(2,"\u9009\u62e9\u670d\u52a1\u9879\u76ee"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(3,"div",13),s.\u0275\u0275elementStart(4,"div",45),s.\u0275\u0275listener("click",function(){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext().openServiceItem()}),s.\u0275\u0275element(5,"em",46),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(6,"dw-table",63,64),s.\u0275\u0275elementStart(8,"thead"),s.\u0275\u0275elementStart(9,"tr",49),s.\u0275\u0275elementStart(10,"th",65),s.\u0275\u0275elementStart(11,"span",6),s.\u0275\u0275text(12,"\u9879\u76ee\u7f16\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(13,"th",66),s.\u0275\u0275elementStart(14,"span",6),s.\u0275\u0275text(15,"\u9879\u76ee\u540d\u79f0"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(16,"th",67),s.\u0275\u0275elementStart(17,"span",6),s.\u0275\u0275text(18,"\u4ef7\u683c"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(19,"th",68),s.\u0275\u0275elementStart(20,"span",6),s.\u0275\u0275text(21,"\u5907\u6ce8"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(22,"th",69),s.\u0275\u0275elementStart(23,"span",6),s.\u0275\u0275text(24,"\u64cd\u4f5c"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(25,"tbody"),s.\u0275\u0275template(26,Ut,14,7,"tr",53),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(27,"div",54),s.\u0275\u0275text(28," \u5408\u8ba1\uff1a"),s.\u0275\u0275elementStart(29,"span"),s.\u0275\u0275text(30),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()}if(2&e){const e=s.\u0275\u0275reference(7),t=s.\u0275\u0275nextContext();s.\u0275\u0275advance(6),s.\u0275\u0275property("dwData",t.serviceItems)("dwFrontPagination",!1)("dwShowPagination",!1),s.\u0275\u0275advance(16),s.\u0275\u0275property("dwAlign","center"),s.\u0275\u0275advance(4),s.\u0275\u0275property("ngForOf",e.data),s.\u0275\u0275advance(4),s.\u0275\u0275textInterpolate1("\uffe5",t.itemAmountTotal,"")}}let Zt=(()=>{class e{constructor(e,t,n,r,i,a,o){this.fb=e,this.router=t,this.activeRoute=n,this.quotationService=r,this.serviceOrderService=i,this.serviceItemSelectService=a,this.message=o,this.DW_IN_MFA=H.ns,this.id="",this.quote_type_list=[],this.warehouse_list=[],this.isSparePartVisible=!1,this.isServiceOrderVisible=!1,this.spareParts=[],this.serviceItems=[],this.serviceItemVisible=!0,this.sparepartChangeVisible=!0,this.partAmountTotal="0.00",this.itemAmountTotal="0.00",this.totalAmount="0.00",this.activeRoute.paramMap.subscribe(e=>{this.id=e.get("id")||""}),this.form=this.fb.group({doc_no:[{value:"",disabled:!0}],doc_date:[{value:"",disabled:!0}],quote_type:["",m.Validators.required],employee_id:[{value:"",disabled:!0}],employee_name:[{value:"",disabled:!0}],service_order_id:["",m.Validators.required],service_order_no:["",m.Validators.required],type:["1"],customer_code:[{value:"",disabled:!0}],customer_name:[{value:"",disabled:!0}],product_file_id:[{value:"",disabled:!0}],product_file_code:[{value:"",disabled:!0}],product_file_name:[{value:"",disabled:!0}],sn:[{value:"",disabled:!0}],specification:[{value:"",disabled:!0}],model:[{value:"",disabled:!0}],remark:[""],approve_date:[""],approve_employee_id:[0],approve_status:[0],erp_so_no:[""],erp_collection_status:[0],erp_invoicing_status:[0],warehouse_id:0})}ngOnInit(){this.id||this.getQuotationDocNo(),this.getTransactionType(),this.getWarehouseList()}getTransactionType(){this.quotationService.getTransactionType().subscribe(e=>{e.success?(this.quote_type_list=e.data.quote_type,this.id&&this.getQuotationInfo()):this.message.create("error",e.message)},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)})}getWarehouseList(){this.warehouse_list.push({warehouse_id:0,warehouse_name:""}),this.quotationService.getWarehouseList().subscribe(e=>{e.success?e.data.warehouse.forEach(e=>{this.warehouse_list.push({warehouse_id:e.warehouse_id,warehouse_name:e.warehouse_name})}):this.message.create("error",e.message)},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)})}getQuotationDocNo(){this.quotationService.getQuotationDocNo().subscribe(e=>{e.success?(this.form.get("doc_no").setValue(e.data.doc_no),this.form.get("doc_date").setValue(e.data.doc_date),this.form.get("employee_id").setValue(e.data.employee_id),this.form.get("employee_name").setValue(e.data.employee_name)):this.message.create("error",e.message)},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)})}getQuotationInfo(){this.quotationService.getQuotationInfo(this.id).subscribe(e=>{if(e.success){const t=e.data.quotation[0];this.form.get("doc_no").setValue(t.doc_no),this.form.get("doc_date").setValue(t.doc_date),this.form.get("quote_type").setValue(t.quote_type),this.form.get("employee_id").setValue(t.employee_id),this.form.get("employee_name").setValue(t.employee_name),this.form.get("service_order_id").setValue(t.service_order_id),this.form.get("service_order_no").setValue(t.service_order_no),this.form.get("type").setValue(t.type||"1"),this.form.get("customer_code").setValue(t.customer_code),this.form.get("customer_name").setValue(t.customer_name),this.form.get("product_file_id").setValue(t.product_file_id),this.form.get("product_file_code").setValue(t.product_file_code),this.form.get("product_file_name").setValue(t.product_file_name),this.form.get("sn").setValue(t.sn),this.form.get("specification").setValue(t.specification),this.form.get("model").setValue(t.model),this.form.get("remark").setValue(t.remark),this.form.get("approve_date").setValue(t.approve_date),this.form.get("approve_employee_id").setValue(t.approve_employee_id),this.form.get("approve_status").setValue(t.approve_status),this.form.get("erp_so_no").setValue(t.erp_so_no),this.form.get("erp_collection_status").setValue(t.erp_collection_status),this.form.get("erp_invoicing_status").setValue(t.erp_invoicing_status),this.form.get("warehouse_id").setValue(t.warehouse_id);const n=[],r=[];t.child.quotation_details.forEach(e=>{"1"===e.expense_type?n.push({price:e.price,material_code:e.item_code,material_id:e.item_id,material_name:e.item_name,model:e.item_model,specification:e.item_spec,unit:e.item_unit,quality:e.quality,remark:e.remark}):r.push({service_item_code:e.item_code,service_item_id:e.item_id,service_item_name:e.item_name,price:e.price,remark:e.remark})}),this.spareParts=n,this.serviceItems=r,this.partPriceChange(),this.itemPriceChange()}else this.message.create("error",e.message)},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)})}openServiceOrder(){this.isServiceOrderVisible=!0}orderChangeVisible(e){e&&this.quotationService.getServiceOrderByIdForOpener(e).subscribe(e=>{if(null!==e){const t=e.data.service_order[0];this.form.get("service_order_id").setValue(t.service_order_id),this.form.get("service_order_no").setValue(t.doc_no),this.form.get("type").setValue(t.type||"1"),this.form.get("customer_code").setValue(t.customer_code),this.form.get("customer_name").setValue(t.customer_name),this.form.get("product_file_id").setValue(t.product_file_id),this.form.get("product_file_code").setValue(t.product_file_code),this.form.get("product_file_name").setValue(t.product_file_name),this.form.get("sn").setValue(t.sn),this.form.get("specification").setValue(t.specification),this.form.get("model").setValue(t.model),this.serviceItemVisible=t.service_item,this.sparepartChangeVisible=t.sparepart_change}},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)}),this.isServiceOrderVisible=!1}clear(){this.form.get("service_order_id").setValue(0),this.form.get("service_order_no").setValue(""),this.form.get("type").setValue("1"),this.form.get("customer_code").setValue(""),this.form.get("customer_name").setValue(""),this.form.get("product_file_id").setValue(""),this.form.get("product_file_code").setValue(""),this.form.get("product_file_name").setValue(""),this.form.get("sn").setValue(""),this.form.get("specification").setValue(""),this.form.get("model").setValue("")}openSpareParts(){this.form.controls.product_file_id.value?this.isSparePartVisible=!0:this.message.create("error","\u8bf7\u5148\u9009\u62e9\u670d\u52a1\u5de5\u5355")}partChangeVisible(e){if(e&&e.length){const t=[],n=[];this.spareParts.length&&this.spareParts.forEach(e=>{t.push(e),n.push(e.material_id)}),e.forEach(e=>{n.indexOf(e.material_id)<0&&(e.price=e.customer_settlement_price,e.quality=1,e.remark="",t.push(e))}),this.spareParts=t,this.partPriceChange()}this.isSparePartVisible=!1}openServiceItem(){this.form.controls.product_file_id.value?(this.serviceItemSelectService.setConfig([],!0),this.serviceItemSelectService.open([]).subscribe(({data:e})=>{console.log(e.service_item);const t=[],n=[];this.serviceItems.length&&this.serviceItems.forEach(e=>{t.push(e.service_item_id),n.push(e)}),e.service_item.forEach(e=>{t.indexOf(e.service_item_id)<0&&(e.price=e.customer_settlement_price,e.remark="",n.push(e))}),this.serviceItems=n,this.itemPriceChange()})):this.message.create("error","\u8bf7\u5148\u9009\u62e9\u670d\u52a1\u5de5\u5355")}partPriceChange(){this.partAmountTotal="0.00",this.spareParts.forEach(e=>{this.partAmountTotal=(parseFloat(this.partAmountTotal)+e.price*e.quality).toFixed(2)}),this.totalAmount=(parseFloat(this.partAmountTotal)+parseFloat(this.itemAmountTotal)).toFixed(2)}itemPriceChange(){this.itemAmountTotal="0.00",this.serviceItems.forEach(e=>{this.itemAmountTotal=(parseFloat(this.itemAmountTotal)+e.price).toFixed(2)}),this.totalAmount=(parseFloat(this.partAmountTotal)+parseFloat(this.itemAmountTotal)).toFixed(2)}deleteGrid(e,t){if("part"===e){const e=[];this.spareParts.forEach(t=>{e.push(t)}),e.splice(t,1),this.spareParts=e,this.partPriceChange()}else{const e=[];this.serviceItems.forEach(t=>{e.push(t)}),e.splice(t,1),this.serviceItems=e,this.itemPriceChange()}}handleOk(){if(!this.spareParts.length&&!this.serviceItems.length)return void this.message.create("error","\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u4e2a\u914d\u4ef6\u6216\u4e00\u4e2a\u670d\u52a1\u9879\u76ee");let e=!0,t=!0;if(this.spareParts.forEach(n=>{(!n.price&&0!==n.price||n.price<0)&&(e=!1),n.quality<=0&&(t=!1)}),this.serviceItems.forEach(t=>{(!t.price&&0!==t.price||t.price<0)&&(e=!1)}),!t)return void this.message.create("error","\u914d\u4ef6\u6570\u91cf\u9700\u5927\u4e8e0");if(!e)return void this.message.create("error","\u914d\u4ef6\u5355\u4ef7\u6216\u670d\u52a1\u9879\u76ee\u4ef7\u683c\u4e0d\u53ef\u4e3a\u7a7a");const n=[];this.spareParts.forEach(e=>{n.push({expense_type:"1",item_id:e.material_id,item_code:e.material_code,item_name:e.material_name,item_spec:e.specification,item_model:e.model,item_unit:e.unit,price:e.price,quality:e.quality,amount:e.price*e.quality,remark:e.remark})}),this.serviceItems.forEach(e=>{n.push({expense_type:"2",item_id:e.service_item_id,item_code:e.service_item_code,item_name:e.service_item_name,item_spec:"",item_model:"",item_unit:"",price:e.price,quality:1,amount:e.price,remark:e.remark})});const r={quotation_details:n,doc_no:this.form.controls.doc_no.value,doc_date:this.form.controls.doc_date.value,quote_type:this.form.controls.quote_type.value,employee_id:this.form.controls.employee_id.value,employee_name:this.form.controls.employee_name.value,service_order_id:this.form.controls.service_order_id.value,service_order_no:this.form.controls.service_order_no.value,customer_code:this.form.controls.customer_code.value,customer_name:this.form.controls.customer_name.value,product_file_id:this.form.controls.product_file_id.value,product_file_code:this.form.controls.product_file_code.value,product_file_name:this.form.controls.product_file_name.value,sn:this.form.controls.sn.value,specification:this.form.controls.specification.value,model:this.form.controls.model.value,remark:this.form.controls.remark.value,approve_date:this.form.controls.approve_date.value,approve_employee_id:this.form.controls.approve_employee_id.value,approve_status:this.form.controls.approve_status.value,erp_so_no:this.form.controls.erp_so_no.value,erp_collection_status:this.form.controls.erp_collection_status.value,erp_invoicing_status:this.form.controls.erp_invoicing_status.value,warehouse_id:this.form.controls.warehouse_id.value};this.id?this.modify(r):this.create(r)}create(e){this.quotationService.create(e).subscribe(e=>{e.success?(this.message.create("success","\u4fdd\u5b58\u6210\u529f\uff01"),this.returnQuotationList()):this.message.create("error",e.message)},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)})}modify(e){this.quotationService.modify(e,this.id).subscribe(e=>{e.success?(this.message.create("success","\u4fdd\u5b58\u6210\u529f\uff01"),this.returnQuotationList()):this.message.create("error",e.message)},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)})}handleCancel(){this.returnQuotationList()}returnQuotationList(){this.router.navigate([(this.DW_IN_MFA?"/assc_crs":"")+"/crs/quotation/quotation-list/@"],{relativeTo:this.activeRoute})}}return e.\u0275fac=function(t){return new(t||e)(s.\u0275\u0275directiveInject(m.FormBuilder),s.\u0275\u0275directiveInject(a.Router),s.\u0275\u0275directiveInject(a.ActivatedRoute),s.\u0275\u0275directiveInject(h),s.\u0275\u0275directiveInject(it),s.\u0275\u0275directiveInject(at.y),s.\u0275\u0275directiveInject(d.DwMessageService))},e.\u0275cmp=s.\u0275\u0275defineComponent({type:e,selectors:[["app-quotation-modify"]],features:[s.\u0275\u0275ProvidersFeature([at.y,it])],decls:104,vars:18,consts:[[1,"dw-f-content-list","layoutClass","sales_layout"],[1,"issue_layout_head"],[1,"issue_layout_title"],["style","margin-left: 3px;",4,"ngIf"],[2,"float","right"],["dw-button","","type","submit",3,"dwType","disabled","click"],["translate",""],["dw-button","","type","button",3,"dwType","click"],[1,"content-box"],["dw-form","",3,"formGroup"],["dw-row",""],[1,"box","half"],[1,"label"],[1,"cont-table",2,"width","calc(100% - 114px)"],["dw-input","","formControlName","doc_no"],["formControlName","doc_date"],[2,"margin-right","4px","color","#ff4d4f","vertical-align","-3px"],["formControlName","quote_type","required","",2,"width","100%"],[3,"dwLabel","dwValue",4,"ngFor","ngForOf"],["dw-input","","formControlName","employee_name"],["dwSearch","",3,"dwSuffix"],["type","text","dw-input","","readonly","","required","","formControlName","service_order_no",2,"width","100%"],["orderData",""],["formControlName","warehouse_id",2,"width","100%"],["dw-input","","formControlName","customer_name"],["dw-input","","formControlName","product_file_name"],["class","label",4,"ngIf"],["dw-input","","formControlName","sn"],["dw-input","","formControlName","specification"],["dw-input","","formControlName","model"],[1,"box","big-half"],["dw-input","","maxlength","200","formControlName","remark",2,"height","32px"],["class","box",4,"ngIf"],[1,"box"],[1,"total"],[3,"visible","view_id","optionId","partVisibleChanged"],["child2",""],[3,"visible","orderVisibleChanged"],["child3",""],[2,"margin-left","3px"],[3,"dwLabel","dwValue"],["dw-icon","","class","ant-input-clear-icon","dwTheme","fill","dwType","close-circle",3,"click",4,"ngIf"],["dw-button","","dwType","primary","dwSearch","","type","button",3,"click"],["dw-icon","","dwType","search"],["dw-icon","","dwTheme","fill","dwType","close-circle",1,"ant-input-clear-icon",3,"click"],[1,"plus-icon",3,"click"],["dw-icon","","dwType","plus","dwTheme","outline"],[3,"dwData","dwFrontPagination","dwShowPagination","dwScroll"],["dwTable2",""],["dw-tr",""],["dw-th",""],["dw-th","","dwAlign","right"],["dw-th","","dwAlign","center","dwRight","0px","width","80"],[4,"ngFor","ngForOf"],[1,"total-amount"],[3,"ngModel","dwMin","dwPrecision","ngModelChange"],["dwAlign","right"],["dw-input","","type","text",3,"ngModel","ngModelChange"],["dwRight","0px"],[1,"action-grid"],["title","\u5220\u9664",3,"click"],["src","../../../../../../assets/img/icon_delete.png","alt","\u5220\u9664",1,"action-icon"],["src","../../../../../../assets/img/icon_delete_hover.png","alt","\u5220\u9664",1,"action-icon"],[3,"dwData","dwFrontPagination","dwShowPagination"],["dwTable3",""],["dw-th","","width","144"],["dw-th","","width","160"],["dw-th","","width","136"],["dw-th","","width","264"],["dw-th","","width","136","width","80",3,"dwAlign"],[3,"ngModel","dwMin","dwStep","dwPrecision","ngModelChange"]],template:function(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"dw-content",0),s.\u0275\u0275elementStart(1,"div",1),s.\u0275\u0275elementStart(2,"h2",2),s.\u0275\u0275template(3,Nt,2,0,"span",3),s.\u0275\u0275template(4,$t,2,0,"span",3),s.\u0275\u0275elementStart(5,"div",4),s.\u0275\u0275elementStart(6,"button",5),s.\u0275\u0275listener("click",function(){return t.handleOk()}),s.\u0275\u0275elementStart(7,"span",6),s.\u0275\u0275text(8,"\u4fdd\u5b58"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(9,"button",7),s.\u0275\u0275listener("click",function(){return t.handleCancel()}),s.\u0275\u0275elementStart(10,"span",6),s.\u0275\u0275text(11,"\u53d6\u6d88"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275element(12,"dw-divider"),s.\u0275\u0275elementStart(13,"div",8),s.\u0275\u0275elementStart(14,"form",9),s.\u0275\u0275elementStart(15,"div",10),s.\u0275\u0275elementStart(16,"div",11),s.\u0275\u0275elementStart(17,"div",12),s.\u0275\u0275text(18,"\u5355\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(19,"div",13),s.\u0275\u0275element(20,"input",14),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(21,"div",11),s.\u0275\u0275elementStart(22,"div",12),s.\u0275\u0275text(23,"\u586b\u5355\u65e5\u671f"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(24,"div",13),s.\u0275\u0275element(25,"dw-date-picker",15),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(26,"div",10),s.\u0275\u0275elementStart(27,"div",11),s.\u0275\u0275elementStart(28,"div",12),s.\u0275\u0275elementStart(29,"span",16),s.\u0275\u0275text(30,"*"),s.\u0275\u0275elementEnd(),s.\u0275\u0275text(31," \u62a5\u4ef7\u7c7b\u578b "),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(32,"div",13),s.\u0275\u0275elementStart(33,"dw-select",17),s.\u0275\u0275template(34,Rt,1,2,"dw-option",18),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(35,"div",11),s.\u0275\u0275elementStart(36,"div",12),s.\u0275\u0275text(37,"\u586b\u5355\u4eba\u5458"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(38,"div",13),s.\u0275\u0275element(39,"input",19),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(40,"div",10),s.\u0275\u0275elementStart(41,"div",11),s.\u0275\u0275elementStart(42,"div",12),s.\u0275\u0275elementStart(43,"span",16),s.\u0275\u0275text(44,"*"),s.\u0275\u0275elementEnd(),s.\u0275\u0275text(45," \u670d\u52a1\u5de5\u5355 "),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(46,"div",13),s.\u0275\u0275elementStart(47,"dw-input-group",20),s.\u0275\u0275element(48,"input",21),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(49,zt,3,1,"ng-template",null,22,s.\u0275\u0275templateRefExtractor),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(51,"div",11),s.\u0275\u0275elementStart(52,"div",12),s.\u0275\u0275text(53,"\u4ed3\u5e93"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(54,"div",13),s.\u0275\u0275elementStart(55,"dw-select",23),s.\u0275\u0275template(56,Lt,1,2,"dw-option",18),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(57,"div",10),s.\u0275\u0275elementStart(58,"div",11),s.\u0275\u0275elementStart(59,"div",12),s.\u0275\u0275text(60,"\u5ba2\u6237"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(61,"div",13),s.\u0275\u0275element(62,"input",24),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(63,"div",11),s.\u0275\u0275elementStart(64,"div",12),s.\u0275\u0275text(65,"\u4ea7\u54c1"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(66,"div",13),s.\u0275\u0275element(67,"input",25),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(68,"div",10),s.\u0275\u0275elementStart(69,"div",11),s.\u0275\u0275template(70,jt,2,0,"div",26),s.\u0275\u0275template(71,Gt,2,0,"div",26),s.\u0275\u0275elementStart(72,"div",13),s.\u0275\u0275element(73,"input",27),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(74,"div",11),s.\u0275\u0275elementStart(75,"div",12),s.\u0275\u0275text(76,"\u89c4\u683c"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(77,"div",13),s.\u0275\u0275element(78,"input",28),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(79,"div",10),s.\u0275\u0275elementStart(80,"div",11),s.\u0275\u0275elementStart(81,"div",12),s.\u0275\u0275text(82,"\u578b\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(83,"div",13),s.\u0275\u0275element(84,"input",29),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(85,"div",10),s.\u0275\u0275elementStart(86,"div",30),s.\u0275\u0275elementStart(87,"div",12),s.\u0275\u0275text(88,"\u5907\u6ce8"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(89,"div",13),s.\u0275\u0275element(90,"textarea",31),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(91,Bt,46,7,"div",32),s.\u0275\u0275template(92,Kt,31,6,"div",32),s.\u0275\u0275elementStart(93,"div",33),s.\u0275\u0275element(94,"div",12),s.\u0275\u0275elementStart(95,"div",13),s.\u0275\u0275elementStart(96,"div",34),s.\u0275\u0275text(97," \u8d39\u7528\u5408\u8ba1\uff1a"),s.\u0275\u0275elementStart(98,"span"),s.\u0275\u0275text(99),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(100,"app-part-opener",35,36),s.\u0275\u0275listener("partVisibleChanged",function(e){return t.partChangeVisible(e)}),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(102,"app-service-order-opener",37,38),s.\u0275\u0275listener("orderVisibleChanged",function(e){return t.orderChangeVisible(e)}),s.\u0275\u0275elementEnd()),2&e){const e=s.\u0275\u0275reference(50);s.\u0275\u0275advance(3),s.\u0275\u0275property("ngIf",!t.id),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",!!t.id),s.\u0275\u0275advance(2),s.\u0275\u0275property("dwType","primary")("disabled",!t.form.valid),s.\u0275\u0275advance(3),s.\u0275\u0275property("dwType","default"),s.\u0275\u0275advance(5),s.\u0275\u0275property("formGroup",t.form),s.\u0275\u0275advance(20),s.\u0275\u0275property("ngForOf",t.quote_type_list),s.\u0275\u0275advance(13),s.\u0275\u0275property("dwSuffix",e),s.\u0275\u0275advance(9),s.\u0275\u0275property("ngForOf",t.warehouse_list),s.\u0275\u0275advance(14),s.\u0275\u0275property("ngIf","1"===t.form.value.type),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","2"===t.form.value.type),s.\u0275\u0275advance(20),s.\u0275\u0275property("ngIf",t.sparepartChangeVisible),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",t.serviceItemVisible),s.\u0275\u0275advance(7),s.\u0275\u0275textInterpolate1("\uffe5",t.totalAmount,""),s.\u0275\u0275advance(1),s.\u0275\u0275property("visible",t.isSparePartVisible)("view_id","quotation_modify")("optionId","part_opener"),s.\u0275\u0275advance(2),s.\u0275\u0275property("visible",t.isServiceOrderVisible)}},directives:[z.DwContentComponent,r.NgIf,B.DwButtonComponent,U.uG,W.u,_.TranslateDirective,L.DwDividerComponent,m.\u0275NgNoValidate,m.NgControlStatusGroup,j.DwFormDirective,m.FormGroupDirective,w.DwRowDirective,Q.DwInputDirective,m.DefaultValueAccessor,m.NgControlStatus,m.FormControlName,G.DwDatePickerComponent,ot.DwSelectComponent,m.RequiredValidator,r.NgForOf,Q.DwInputGroupComponent,Q.DwInputGroupWhitSuffixOrPrefixDirective,m.MaxLengthValidator,Et,Ft,ot.DwOptionComponent,J.DwIconDirective,S.DwTableComponent,S.DwTheadComponent,S.DwTrDirective,S.DwTableCellDirective,S.DwThMeasureDirective,S.DwCellAlignDirective,S.DwCellFixedDirective,S.DwTbodyComponent,qt.DwInputNumberComponent,m.NgModel],styles:[".plus-icon[_ngcontent-%COMP%]{width:48px;height:32px;border:1px solid #d0d0d0;border-radius:4px;background:#f5f5f5;display:flex;align-items:center;justify-content:center;margin-bottom:16px;color:#999;font-size:20px;cursor:pointer}.plus-icon.in-grid[_ngcontent-%COMP%]{display:inline-block;margin:0;text-align:center}.box[_ngcontent-%COMP%]{width:100%;display:flex;margin-bottom:20px}.box.half[_ngcontent-%COMP%]{width:40%;margin-bottom:12px}.box.big-half[_ngcontent-%COMP%]{width:80%}.box[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{width:104px;height:32px;line-height:32px;font-size:14px;text-align:right;white-space:nowrap}.total-amount[_ngcontent-%COMP%]{height:49px;line-height:48px;text-align:right;color:#000000d9;font-weight:bold;font-size:16px;padding:0 24px;border:1px solid #f0f0f0;border-top:0}.total-amount[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fe3a3a}.total[_ngcontent-%COMP%]{height:64px;line-height:64px;text-align:right;color:#000000d9;font-weight:bold;font-size:24px;padding:0 24px;background:#f2f2f2}.total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fe3a3a;font-size:28px}"]}),e})();var Jt=n(51033);function Yt(e,t){if(1&e&&s.\u0275\u0275element(0,"dw-option",41),2&e){const e=t.$implicit;s.\u0275\u0275property("dwLabel",e.warehouse_name)("dwValue",e.warehouse_id)}}function Xt(e,t){1&e&&(s.\u0275\u0275elementStart(0,"div",12),s.\u0275\u0275text(1,"\u5e8f\u5217\u53f7"),s.\u0275\u0275elementEnd())}function en(e,t){1&e&&(s.\u0275\u0275elementStart(0,"div",12),s.\u0275\u0275text(1,"\u9879\u76ee\u53f7"),s.\u0275\u0275elementEnd())}function tn(e,t){if(1&e){const e=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"tr"),s.\u0275\u0275elementStart(1,"td"),s.\u0275\u0275text(2),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(3,"td"),s.\u0275\u0275text(4),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(5,"td"),s.\u0275\u0275text(6),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(7,"td"),s.\u0275\u0275text(8),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(9,"td"),s.\u0275\u0275text(10),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(11,"td",42),s.\u0275\u0275text(12),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(13,"td"),s.\u0275\u0275elementStart(14,"dw-input-number",43),s.\u0275\u0275listener("ngModelChange",function(t){return s.\u0275\u0275restoreView(e).$implicit.price=t})("ngModelChange",function(){return s.\u0275\u0275restoreView(e),s.\u0275\u0275nextContext().partPriceChange()}),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(15,"td",42),s.\u0275\u0275text(16),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(17,"td"),s.\u0275\u0275elementStart(18,"input",44),s.\u0275\u0275listener("ngModelChange",function(t){return s.\u0275\u0275restoreView(e).$implicit.remark=t}),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit;s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.material_code," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.material_name," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.specification," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.model," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.unit," "),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",e.quality," "),s.\u0275\u0275advance(2),s.\u0275\u0275property("ngModel",e.price)("dwMin",0)("dwPrecision",2),s.\u0275\u0275advance(2),s.\u0275\u0275textInterpolate1(" ",(e.price*e.quality).toFixed(2)," "),s.\u0275\u0275advance(2),s.\u0275\u0275property("ngModel",e.remark)}}const nn=function(){return{x:"900px"}},rn=[{path:"",pathMatch:"prefix",component:l,data:{dwRouteData:{programId:"quotation"}},children:[{path:"quotation-list/:id",component:tt,canActivate:[o.DwAuthGuardService,Jt.L],data:{dwRouteData:{dwAuthId:"quotation"},reload:!0}},{path:"quotation-create",component:Zt,canActivate:[o.DwAuthGuardService,Jt.L],data:{dwRouteData:{dwAuthId:"quotation"},reload:!0}},{path:"quotation-modify/:id",component:Zt,canActivate:[o.DwAuthGuardService,Jt.L],data:{dwRouteData:{dwAuthId:"quotation"},reload:!0}},{path:"quote",component:(()=>{class e{constructor(e,t,n,r,i){this.fb=e,this.router=t,this.activeRoute=n,this.quotationService=r,this.message=i,this.DW_IN_MFA=H.ns,this.id="",this.warehouse_list=[],this.spareParts=[],this.partAmountTotal="0.00",this.activeRoute.queryParamMap.subscribe(e=>{this.id=e.get("id")}),this.form=this.fb.group({doc_no:[{value:"",disabled:!0}],doc_date:[{value:"",disabled:!0}],quote_type_name:[{value:"",disabled:!0}],employee_id:[{value:"",disabled:!0}],employee_name:[{value:"",disabled:!0}],customer_code:[{value:"",disabled:!0}],customer_name:[{value:"",disabled:!0}],type:["1"],product_file_id:[{value:"",disabled:!0}],product_file_code:[{value:"",disabled:!0}],product_file_name:[{value:"",disabled:!0}],sn:[{value:"",disabled:!0}],specification:[{value:"",disabled:!0}],model:[{value:"",disabled:!0}],remark:[""],warehouse_id:0})}ngOnInit(){this.getQuotationInfo(),this.getWarehouseList()}getWarehouseList(){this.warehouse_list.push({warehouse_id:0,warehouse_name:""}),this.quotationService.getWarehouseList().subscribe(e=>{e.success?e.data.warehouse.forEach(e=>{this.warehouse_list.push({warehouse_id:e.warehouse_id,warehouse_name:e.warehouse_name})}):this.message.create("error",e.message)},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)})}getQuotationInfo(){this.quotationService.getQuotationInfo(this.id).subscribe(e=>{if(e.success){const t=e.data.quotation[0];this.form.get("doc_no").setValue(t.doc_no),this.form.get("doc_date").setValue(t.doc_date),this.form.get("quote_type_name").setValue(t.quote_type_name),this.form.get("employee_id").setValue(t.employee_id),this.form.get("employee_name").setValue(t.employee_name),this.form.get("customer_code").setValue(t.customer_code),this.form.get("customer_name").setValue(t.customer_name),this.form.get("type").setValue(t.file_type||"1"),this.form.get("product_file_id").setValue(t.product_file_id),this.form.get("product_file_code").setValue(t.product_file_code),this.form.get("product_file_name").setValue(t.product_file_name),this.form.get("sn").setValue(t.sn),this.form.get("specification").setValue(t.specification),this.form.get("model").setValue(t.model),this.form.get("remark").setValue(t.remark),this.form.get("warehouse_id").setValue(t.warehouse_id);const n=[];t.child.quotation_details.forEach(e=>{"1"===e.expense_type&&n.push({quotation_details_id:e.quotation_details_id,price:e.price,material_code:e.item_code,material_id:e.item_id,material_name:e.item_name,model:e.item_model,specification:e.item_spec,unit:e.item_unit,quality:e.quality,remark:e.remark})}),this.spareParts=n,this.partPriceChange()}else this.message.create("error",e.message)},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)})}partPriceChange(){this.partAmountTotal="0.00",this.spareParts.forEach(e=>{this.partAmountTotal=(parseFloat(this.partAmountTotal)+e.price*e.quality).toFixed(2)})}handleOk(){let e=!0;if(this.spareParts.forEach(t=>{(!t.price&&0!==t.price||t.price<0)&&(e=!1)}),!e)return void this.message.create("error","\u914d\u4ef6\u5355\u4ef7\u4e0d\u53ef\u4e3a\u7a7a");const t=[];this.spareParts.forEach(e=>{t.push({quotation_details_id:e.quotation_details_id+"",item_id:e.material_id,item_code:e.material_code,item_name:e.material_name,item_spec:e.specification,item_model:e.model,item_unit:e.unit,price:e.price,quality:e.quality,amount:e.price*e.quality,remark:e.remark})}),this.quote({quotation_details:t,remark:this.form.controls.remark.value,warehouse_id:this.form.controls.warehouse_id.value})}quote(e){this.quotationService.quote(e,this.id).subscribe(e=>{this.message.create("success","\u62a5\u4ef7\u6210\u529f\uff01"),this.returnQuotationList()},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)})}handleCancel(){this.returnQuotationList()}returnQuotationList(){this.router.navigate([(this.DW_IN_MFA?"/assc_crs":"")+"/crs/quotation/quotation-list/@"],{relativeTo:this.activeRoute})}}return e.\u0275fac=function(t){return new(t||e)(s.\u0275\u0275directiveInject(m.FormBuilder),s.\u0275\u0275directiveInject(a.Router),s.\u0275\u0275directiveInject(a.ActivatedRoute),s.\u0275\u0275directiveInject(h),s.\u0275\u0275directiveInject(d.DwMessageService))},e.\u0275cmp=s.\u0275\u0275defineComponent({type:e,selectors:[["app-quote"]],decls:119,vars:13,consts:[[1,"dw-f-content-list","layoutClass","sales_layout"],[1,"issue_layout_head"],[1,"issue_layout_title"],[2,"margin-left","3px"],[2,"float","right"],["dw-button","","type","submit",3,"dwType","click"],["translate",""],["dw-button","","type","button",3,"dwType","click"],[1,"content-box"],["dw-form","",3,"formGroup"],["dw-row",""],[1,"box","half"],[1,"label"],[1,"cont-table",2,"width","calc(100% - 114px)"],["dw-input","","formControlName","doc_no"],["formControlName","doc_date"],[2,"margin-right","4px","color","#ff4d4f","vertical-align","-3px"],["dw-input","","formControlName","quote_type_name"],["dw-input","","formControlName","employee_name"],["dw-input","","formControlName","customer_name"],["formControlName","warehouse_id",2,"width","100%"],[3,"dwLabel","dwValue",4,"ngFor","ngForOf"],["class","label",4,"ngIf"],["dw-input","","formControlName","sn"],["dw-input","","formControlName","product_file_name"],["dw-input","","formControlName","model"],["dw-input","","formControlName","specification"],[1,"box","big-half"],["dw-input","","maxlength","200","formControlName","remark",2,"height","32px"],[1,"box"],[3,"dwData","dwFrontPagination","dwShowPagination","dwScroll"],["dwTable2",""],["dw-tr",""],["dw-th",""],["dw-th","","width","80"],["dw-th","","width","80","dwAlign","right"],["dw-th","","width","100"],["dw-th","","dwAlign","right"],["dw-th","","width","180"],[4,"ngFor","ngForOf"],[1,"total-amount"],[3,"dwLabel","dwValue"],["dwAlign","right"],[3,"ngModel","dwMin","dwPrecision","ngModelChange"],["dw-input","","type","text",3,"ngModel","ngModelChange"]],template:function(e,t){if(1&e&&(s.\u0275\u0275elementStart(0,"dw-content",0),s.\u0275\u0275elementStart(1,"div",1),s.\u0275\u0275elementStart(2,"h2",2),s.\u0275\u0275elementStart(3,"span",3),s.\u0275\u0275text(4,"\u6613\u635f\u4ef6\u9500\u552e\u62a5\u4ef7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(5,"div",4),s.\u0275\u0275elementStart(6,"button",5),s.\u0275\u0275listener("click",function(){return t.handleOk()}),s.\u0275\u0275elementStart(7,"span",6),s.\u0275\u0275text(8,"\u62a5\u4ef7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(9,"button",7),s.\u0275\u0275listener("click",function(){return t.handleCancel()}),s.\u0275\u0275elementStart(10,"span",6),s.\u0275\u0275text(11,"\u53d6\u6d88"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275element(12,"dw-divider"),s.\u0275\u0275elementStart(13,"div",8),s.\u0275\u0275elementStart(14,"form",9),s.\u0275\u0275elementStart(15,"div",10),s.\u0275\u0275elementStart(16,"div",11),s.\u0275\u0275elementStart(17,"div",12),s.\u0275\u0275text(18,"\u5355\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(19,"div",13),s.\u0275\u0275element(20,"input",14),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(21,"div",11),s.\u0275\u0275elementStart(22,"div",12),s.\u0275\u0275text(23,"\u586b\u5355\u65e5\u671f"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(24,"div",13),s.\u0275\u0275element(25,"dw-date-picker",15),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(26,"div",10),s.\u0275\u0275elementStart(27,"div",11),s.\u0275\u0275elementStart(28,"div",12),s.\u0275\u0275elementStart(29,"span",16),s.\u0275\u0275text(30,"*"),s.\u0275\u0275elementEnd(),s.\u0275\u0275text(31," \u62a5\u4ef7\u7c7b\u578b "),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(32,"div",13),s.\u0275\u0275element(33,"input",17),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(34,"div",11),s.\u0275\u0275elementStart(35,"div",12),s.\u0275\u0275text(36,"\u586b\u5355\u4eba\u5458"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(37,"div",13),s.\u0275\u0275element(38,"input",18),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(39,"div",10),s.\u0275\u0275elementStart(40,"div",11),s.\u0275\u0275elementStart(41,"div",12),s.\u0275\u0275text(42,"\u5ba2\u6237"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(43,"div",13),s.\u0275\u0275element(44,"input",19),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(45,"div",11),s.\u0275\u0275elementStart(46,"div",12),s.\u0275\u0275text(47,"\u4ed3\u5e93"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(48,"div",13),s.\u0275\u0275elementStart(49,"dw-select",20),s.\u0275\u0275template(50,Yt,1,2,"dw-option",21),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(51,"div",10),s.\u0275\u0275elementStart(52,"div",11),s.\u0275\u0275template(53,Xt,2,0,"div",22),s.\u0275\u0275template(54,en,2,0,"div",22),s.\u0275\u0275elementStart(55,"div",13),s.\u0275\u0275element(56,"input",23),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(57,"div",11),s.\u0275\u0275elementStart(58,"div",12),s.\u0275\u0275text(59,"\u4ea7\u54c1"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(60,"div",13),s.\u0275\u0275element(61,"input",24),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(62,"div",10),s.\u0275\u0275elementStart(63,"div",11),s.\u0275\u0275elementStart(64,"div",12),s.\u0275\u0275text(65,"\u578b\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(66,"div",13),s.\u0275\u0275element(67,"input",25),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(68,"div",11),s.\u0275\u0275elementStart(69,"div",12),s.\u0275\u0275text(70,"\u89c4\u683c"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(71,"div",13),s.\u0275\u0275element(72,"input",26),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(73,"div",10),s.\u0275\u0275elementStart(74,"div",27),s.\u0275\u0275elementStart(75,"div",12),s.\u0275\u0275text(76,"\u5907\u6ce8"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(77,"div",13),s.\u0275\u0275element(78,"textarea",28),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(79,"div",29),s.\u0275\u0275element(80,"div",12),s.\u0275\u0275elementStart(81,"div",13),s.\u0275\u0275elementStart(82,"dw-table",30,31),s.\u0275\u0275elementStart(84,"thead"),s.\u0275\u0275elementStart(85,"tr",32),s.\u0275\u0275elementStart(86,"th",33),s.\u0275\u0275elementStart(87,"span",6),s.\u0275\u0275text(88,"\u7f16\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(89,"th",33),s.\u0275\u0275elementStart(90,"span",6),s.\u0275\u0275text(91,"\u540d\u79f0"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(92,"th",33),s.\u0275\u0275elementStart(93,"span",6),s.\u0275\u0275text(94,"\u89c4\u683c"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(95,"th",33),s.\u0275\u0275elementStart(96,"span",6),s.\u0275\u0275text(97,"\u578b\u53f7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(98,"th",34),s.\u0275\u0275elementStart(99,"span",6),s.\u0275\u0275text(100,"\u5355\u4f4d"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(101,"th",35),s.\u0275\u0275elementStart(102,"span",6),s.\u0275\u0275text(103,"\u6570\u91cf"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(104,"th",36),s.\u0275\u0275elementStart(105,"span",6),s.\u0275\u0275text(106,"\u5355\u4ef7"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(107,"th",37),s.\u0275\u0275elementStart(108,"span",6),s.\u0275\u0275text(109,"\u91d1\u989d"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(110,"th",38),s.\u0275\u0275elementStart(111,"span",6),s.\u0275\u0275text(112,"\u5907\u6ce8"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(113,"tbody"),s.\u0275\u0275template(114,tn,19,11,"tr",39),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(115,"div",40),s.\u0275\u0275text(116," \u5408\u8ba1\uff1a"),s.\u0275\u0275elementStart(117,"span"),s.\u0275\u0275text(118),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementEnd()),2&e){const e=s.\u0275\u0275reference(83);s.\u0275\u0275advance(6),s.\u0275\u0275property("dwType","primary"),s.\u0275\u0275advance(3),s.\u0275\u0275property("dwType","default"),s.\u0275\u0275advance(5),s.\u0275\u0275property("formGroup",t.form),s.\u0275\u0275advance(36),s.\u0275\u0275property("ngForOf",t.warehouse_list),s.\u0275\u0275advance(3),s.\u0275\u0275property("ngIf","1"===t.form.value.type),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf","2"===t.form.value.type),s.\u0275\u0275advance(28),s.\u0275\u0275property("dwData",t.spareParts)("dwFrontPagination",!1)("dwShowPagination",!1)("dwScroll",s.\u0275\u0275pureFunction0(12,nn)),s.\u0275\u0275advance(32),s.\u0275\u0275property("ngForOf",e.data),s.\u0275\u0275advance(4),s.\u0275\u0275textInterpolate1("\uffe5",t.partAmountTotal,"")}},directives:[z.DwContentComponent,B.DwButtonComponent,U.uG,W.u,_.TranslateDirective,L.DwDividerComponent,m.\u0275NgNoValidate,m.NgControlStatusGroup,j.DwFormDirective,m.FormGroupDirective,w.DwRowDirective,Q.DwInputDirective,m.DefaultValueAccessor,m.NgControlStatus,m.FormControlName,G.DwDatePickerComponent,ot.DwSelectComponent,r.NgForOf,r.NgIf,m.MaxLengthValidator,S.DwTableComponent,S.DwTheadComponent,S.DwTrDirective,S.DwTableCellDirective,S.DwThMeasureDirective,S.DwCellAlignDirective,S.DwTbodyComponent,ot.DwOptionComponent,qt.DwInputNumberComponent,m.NgModel],styles:[".box[_ngcontent-%COMP%]{width:100%;display:flex;margin-bottom:20px}.box.half[_ngcontent-%COMP%]{width:40%;margin-bottom:12px}.box.big-half[_ngcontent-%COMP%]{width:80%}.box[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{width:104px;height:32px;line-height:32px;font-size:14px;text-align:right;white-space:nowrap}.total-amount[_ngcontent-%COMP%]{height:49px;line-height:48px;text-align:right;color:#000000d9;font-weight:bold;font-size:16px;padding:0 24px;border:1px solid #f0f0f0;border-top:0}.total-amount[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fe3a3a}"]}),e})(),canActivate:[o.DwAuthGuardService,Jt.L],data:{dwRouteData:{dwAuthId:"quotation"},reload:!0}}]}];let an=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=s.\u0275\u0275defineInjector({imports:[[a.RouterModule.forChild(rn)],a.RouterModule]}),e})(),on=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=s.\u0275\u0275defineInjector({imports:[[r.CommonModule,i.m,an,d.DwMessageModule,c.DwModalModule,pt.DwCheckboxModule,ot.DwSelectModule,bt.DwRadioModule,S.DwTableModule,J.DwIconModule,Q.DwInputModule,_.TranslateModule,w.DwGridModule,B.DwButtonModule,z.DwLayoutModule,G.DwDatePickerModule,L.DwDividerModule,X.DwDrawerModule,j.DwFormModule,ee.DwPopconfirmModule,Y.DwTabsModule,te.DwTagModule,K.DwActionModule,m.ReactiveFormsModule,qt.DwInputNumberModule]]}),e})()},13437:function(e,t,n){n.d(t,{y:function(){return l}});var r=n(47372),i=n(9682);class a extends i.DwClientPagingDataSource{constructor(e,t){super(),this.dwDapHttp=e,this.url=t}getDataList(e,t){return this.dwDapHttp.get(this.url).pipe((0,r.map)(n=>(this._result={currentPage:e,datas:Object.assign([],n),pageCount:Math.ceil(n.length/t),pageSize:t,rowCount:n.length},this._result)))}}var o=n(51156),s=n(42746);let l=(()=>{class e{constructor(e,t){this.dwHttp=e,this.selectModalService=t}setConfig(e,t){this.config={modalTitle:"\u9009\u62e9\u670d\u52a1\u9879\u76ee",modalWidth:"50%",tableMultiSelect:t,tableIdField:"service_item_id",tableNameField:"service_item_name",tablePageSize:10,tableColDefs:[{title:"\u9879\u76ee\u7f16\u53f7",field:"service_item_code",width:""},{title:"\u9879\u76ee\u540d\u79f0",field:"service_item_name",width:""},{title:"\u4ef7\u683c",field:"customer_settlement_price",width:""}],tableCustomTag:e=>"("+e.service_item_code+")"+e.service_item_name,dataSource:new a(this.dwHttp,"restful/service/serviceItem/ServiceItem/ServiceItem?name=&code=")}}open(e){return this.selectModalService.open(this.config,e).pipe((0,r.switchMap)(e=>this.dwHttp.get(`restful/service/serviceItem/ServiceItem/ServiceItemByIds?ids=${e}`)))}}return e.\u0275fac=function(t){return new(t||e)(s.\u0275\u0275inject(o.DwDapHttpClient),s.\u0275\u0275inject(i.DwSelectModalService))},e.\u0275prov=s.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac}),e})()},91970:function(e,t,n){n.d(t,{v:function(){return l}});var r=n(51156),i=n(66800),a=n(47372),o=n(99487),s=n(42746);let l=(()=>{class e{constructor(e,t){this.dapHttp=e,this.userService=t}emptyServiceOrder(){return{doc_date:new Date,is_under_warranty:!1,description:"",appointment_date:new Date,picture_id:"",contact:"",contact_phone:"",address:"",delivery_date:new Date,service_type_name:"",breakdown_name:"",service_urgency_name:""}}emptyServiceOrderCurrentLink(){return{state:"",employee_name:"",file_id:"",employee_show:"",state_show:"",button_show:""}}getServiceOrderBaseInfo(e){return this.dapHttp.get(`restful/service/serviceOrder/ServiceOrder/ServiceOrderBaseInfo?id=${e}`)}getServiceOrderLink(e){return this.dapHttp.get(`restful/service/serviceOrder/ServiceOrder/ServiceOrderLink?id=${e}`)}getServiceOrderProgress(e){return this.dapHttp.get(`restful/service/serviceOrder/ServiceOrder/ServiceOrderProgress?id=${e}`).pipe((0,a.map)(e=>e))}getServiceDocInfo(e){return this.dapHttp.get(`restful/service/serviceOrder/ServiceOrder/ServiceDocInfo?id=${e}`).pipe((0,a.map)(e=>e))}getServiceDocCalcDetail(e){return this.dapHttp.get(`restful/service/serviceOrder/ServiceOrder/ServiceDocCalcDetail?id=${e}`).pipe((0,a.map)(e=>e))}getServiceOrderProcessrecordListCount(e){return this.dapHttp.get(`restful/service/serviceDoc/ServiceDoc/ServiceOrderProcessrecordListCount?serviceOrderId=${e}`)}getServiceOrderProcessrecordList(e){return this.dapHttp.get(`restful/service/serviceDoc/ServiceDoc/ServiceOrderProcessrecordList?serviceOrderId=${e}`).pipe((0,a.map)(e=>e))}getServiceOrderReview(e){return this.dapHttp.get(`restful/service/serviceOrder/ServiceOrder/ServiceOrderReview?service_order_id=${e}`)}getUserId(){return this.dapHttp.get("restful/service/employee/Employee/CurrentEmployee")}getBreakdownOpener(){return this.dapHttp.get("restful/service/breakdown/Breakdown/BreakdownOpener?name=")}getMaterialGroups(e){return this.dapHttp.get(`restful/service/serviceDoc/ServiceReport/${e}`)}getMaterialList(e){return this.dapHttp.get(`restful/service/serviceDoc/ServiceReport/${e}`)}getNewMaterialListByOrder(e){return this.dapHttp.get(`restful/service/serviceDoc/ServiceReport/PartsDeliveryDetails?serviceOrderId=${e}`)}getNewMaterialListBySite(e){return this.dapHttp.get(`restful/service/serviceDoc/ServiceReport/EngineerMaterials?serviceOrderId=${e}`)}getSummaryInfo(e){return this.dapHttp.get(`restful/service/serviceDoc/ServiceDoc/ServiceDocSummary?serviceDocId=${e}`)}getQuotationServiceItems(e){return this.dapHttp.get(`restful/service/serviceDoc/ServiceDoc/QuotationServiceItems?serviceOrderId=${e}`)}getQuotationMaterialGroups(e){return this.dapHttp.get(`restful/service/itemGroup/ItemGroup/${e}`)}getQuotationMaterialList(e){return this.dapHttp.get(`restful/service/${e}`)}getQuotationNewMaterialListByOrder(e){return this.dapHttp.get(`restful/service/material/Material/PartsDeliveryDetails?serviceOrderId=${e}`)}getQuickwearPartAllMaterialGroups(e){return this.dapHttp.get(`restful/service/productFile/QuickwearPart/${e}`)}uploadImg(e){return this.dapHttp.post("restful/service/serviceDoc/File/UploadImage",e)}getFileById(e){return this.dapHttp.get(`restful/service/employee/Employee/File?file_id=${e}`).pipe((0,a.map)(e=>e))}createReport(e){return this.dapHttp.post("restful/service/serviceDoc/ServiceReport/ServiceReport",{params:e})}getServiceReportInfo(e){return this.dapHttp.get(`restful/service/serviceDoc/serviceReport/ServiceDocInfo?serviceDocId=${e}`)}modifyReport(e){return this.dapHttp.post("restful/service/serviceDoc/ServiceReport/ServiceReportModify",{params:e})}exportPDF(e){return this.dapHttp.get("restful/service/serviceDoc/ServiceReport/ServiceReportPdf",{params:e=e||{},headers:this.getHeader(),observe:"events",responseType:"blob",reportProgress:!0})}getHeader(){return new o.HttpHeaders({token:this.userService.getUser("token")})}serviceDocPartChanges(e){return this.dapHttp.post("restful/service/serviceDoc/ServiceReport/ServiceDocPartChanges",{params:e})}getAutoSettings(){return this.dapHttp.get("restful/service/autoSettings/AutoSettings/AutoSettings")}getServiceTypes(){return this.dapHttp.get("restful/service/serviceType/serviceType/ServiceType?code=&name=").pipe((0,a.map)(e=>e))}checkNotCompletePartsApply(e){return this.dapHttp.get("restful/service/serviceDoc/ServiceDoc/NotCompletePartsApplyCount?serviceDocId="+e).pipe((0,a.map)(e=>e))}serviceOrderRecordShowAlert(e){return this.dapHttp.get("restful/service/serviceDoc/ServiceReport/ServiceOrderRecordShowAlert?productFileId="+e).pipe((0,a.map)(e=>e))}saveAmountInfo(e){return this.dapHttp.put("restful/service/serviceDoc/ServiceReport/ModifyServiceDocCalcDetail",e)}getServiceOrderCustomerSettled(e){return this.dapHttp.get("restful/service/serviceDoc/ServiceReport/ServiceOrderCustomerSettled?serviceOrderId="+e)}getReturnvisitItemList(){return this.dapHttp.get("restful/service/returnvisitItem/ReturnVisitItem/ReturnVisitItemList?isIncludeSystemData=true").pipe((0,a.map)(e=>e))}returnvisit(e){return this.dapHttp.put("restful/service/serviceOrder/ServiceOrder/ReturnVisitEvaluation",{params:e})}saveAttachments(e){return this.dapHttp.post("restful/service/productFile/ProductFile/Attachments",e,{})}download(e){return this.dapHttp.get("restful/service/productFile/ProductFile/downloadFile",{params:e=e||{},headers:this.getHeader(),observe:"events",responseType:"blob",reportProgress:!0})}getCurrentEmployee(){return this.dapHttp.get("restful/service/employee/Employee/CurrentEmployee")}getWorkrecord(e){return this.dapHttp.get(`restful/service/serviceDoc/ServiceDoc/ServiceDocLog?serviceDocId=${e}`).pipe((0,a.map)(e=>e))}}return e.\u0275fac=function(t){return new(t||e)(s.\u0275\u0275inject(r.DwDapHttpClient),s.\u0275\u0275inject(i.DwUserService))},e.\u0275prov=s.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},90697:function(e,t,n){n.d(t,{a:function(){return h}});var r=n(64762),i=n(45890),a=n(83237),o=n(42746),s=n(67733),l=n(85277),d=n(31441),c=n(55245);const m=function(){return{width:"100%"}};function p(e,t){if(1&e&&o.\u0275\u0275element(0,"img",6),2&e){const e=o.\u0275\u0275nextContext();o.\u0275\u0275property("src",e.previewImage,o.\u0275\u0275sanitizeUrl)("ngStyle",o.\u0275\u0275pureFunction0(2,m))}}const u=function(){return{showPreviewIcon:!0,showRemoveIcon:!1,showDownloadIcon:!1}};let h=(()=>{class e{constructor(e,t){this.http=e,this.message=t,this.fileList=[],this.previewImage="",this.previewVisible=!1,this.handlePreview=e=>(0,r.mG)(this,void 0,void 0,function*(){this.item.file_id?this.http.get(`restful/service/material/Material/MaterialOriginUrl?fileId=${this.item.file_id}`).subscribe(t=>{this.previewImage=t||e.url,this.previewVisible=!0},e=>{e.hasOwnProperty("error")&&e.error.hasOwnProperty("errorMessage")&&e.error.errorMessage&&this.message.error(e.error.errorMessage)}):(this.previewImage=e.url,this.previewVisible=!0)})}ngOnInit(){this.fileList=this.item.url?[{uid:this.item.file_id||this.item.url,name:this.item.file_id||this.item.url,status:"done",url:this.item.url}]:[]}}return e.\u0275fac=function(t){return new(t||e)(o.\u0275\u0275directiveInject(i.$),o.\u0275\u0275directiveInject(a.DwMessageService))},e.\u0275cmp=o.\u0275\u0275defineComponent({type:e,selectors:[["app-big-img"]],inputs:{item:"item"},decls:8,vars:8,consts:[[1,"small_img"],["dwListType","picture-card",3,"dwShowUploadList","dwFileList","dwShowButton","dwPreview","dwFileListChange"],["dw-icon","","dwType","plus"],[1,"ant-upload-text"],[3,"dwVisible","dwContent","dwFooter","dwOnCancel"],["modalContent",""],["alt","img",3,"src","ngStyle"]],template:function(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"div",0),o.\u0275\u0275elementStart(1,"dw-upload",1),o.\u0275\u0275listener("dwFileListChange",function(e){return t.fileList=e}),o.\u0275\u0275element(2,"em",2),o.\u0275\u0275elementStart(3,"div",3),o.\u0275\u0275text(4,"Upload"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(5,"dw-modal",4),o.\u0275\u0275listener("dwOnCancel",function(){return t.previewVisible=!1}),o.\u0275\u0275template(6,p,1,3,"ng-template",null,5,o.\u0275\u0275templateRefExtractor),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd()),2&e){const e=o.\u0275\u0275reference(7);o.\u0275\u0275advance(1),o.\u0275\u0275property("dwShowUploadList",o.\u0275\u0275pureFunction0(7,u))("dwFileList",t.fileList)("dwShowButton",!1)("dwPreview",t.handlePreview),o.\u0275\u0275advance(4),o.\u0275\u0275property("dwVisible",t.previewVisible)("dwContent",e)("dwFooter",null)}},directives:[s.DwUploadComponent,l.DwIconDirective,d.DwModalComponent,c.NgStyle],styles:[""]}),e})()},45890:function(e,t,n){n.d(t,{$:function(){return o}});var r=n(51156),i=n(99487),a=n(42746);let o=(()=>{class e{constructor(e){this.dwDapHttpClient=e}get(e,t){const n=new i.HttpParams({fromObject:t});return this.dwDapHttpClient.get(e,{params:n})}post(e,t){return this.dwDapHttpClient.post(e,t)}put(e,t){return this.dwDapHttpClient.put(e,t)}delete(e,t){return this.dwDapHttpClient.request("DELETE",e,{body:t})}}return e.\u0275fac=function(t){return new(t||e)(a.\u0275\u0275inject(r.DwDapHttpClient))},e.\u0275prov=a.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},51033:function(e,t,n){n.d(t,{L:function(){return c}}),n(87974);var r=n(32276),i=n(51156),a=n(66800),o=n(83237),s=n(31441),l=n(71049),d=n(42746);let c=(()=>{class e{constructor(e,t,n,r,i){this.http=e,this.authService=t,this.userService=n,this.message=r,this.modalService=i,this.uerId=""}canLoad(e){return!0}canActivateChild(e,t){return!0}canActivate(e,t){return new l.Observable(e=>{this.uerId=this.userService.getUser("userId"),this.uerId?this.http.get(`restful/service/employee/Employee/ValidateIamUser?userId=${this.uerId}`).subscribe(t=>{t.success?(sessionStorage.setItem("employeeInfo",JSON.stringify(t.data?t.data.data:{})),e.next(!0)):(this.modalService.warning({dwTitle:"\u63d0\u793a",dwContent:t.data,dwWidth:"400px",dwOnOk:()=>{this.authService.logout(),window.location.reload()}}),e.next(!1))},t=>{console.log(t),t.hasOwnProperty("error")&&t.error.hasOwnProperty("errorMessage")&&t.error.errorMessage&&this.message.error(t.error.errorMessage),e.next(!1)}):e.next(!0)})}}return e.\u0275fac=function(t){return new(t||e)(d.\u0275\u0275inject(i.DwDapHttpClient),d.\u0275\u0275inject(r.DwAuthService),d.\u0275\u0275inject(a.DwUserService),d.\u0275\u0275inject(o.DwMessageService),d.\u0275\u0275inject(s.DwModalService))},e.\u0275prov=d.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},61937:function(e,t,n){n.d(t,{l:function(){return r}});class r{static order(e,...t){return e?[...e].sort((e,n)=>{let r=0,i=0;const a=t.length;for(let o=0;o<a;o++){const s=t[o][0],l=t[o][1]||1,d=Math.pow(2,a-o)*l;let c,m;s instanceof Function?(c=String(s(e)||""),m=String(s(n)||"")):(c=String(e[s]||""),m=String(n[s]||"")),1===c.localeCompare(m)?r+=d:-1===c.localeCompare(m)&&(i+=d)}return r-i}):[]}static crossPageCache(e,t,n,r){const i=e[r];if(i){const e=i[n];i.checked?t.includes(e)||t.push(e):t.includes(e)&&t.splice(t.indexOf(e),1)}}static crossPageCheck(e,t,n){for(const r of e)t.includes(r[n])?r.checked||(r.checked=!0):r.checked&&(r.checked=!1)}static parseJson(e){try{return JSON.parse(e)}catch(t){return null}}}},64762:function(e,t,n){n.d(t,{ZT:function(){return i},pi:function(){return a},_T:function(){return o},gn:function(){return s},fM:function(){return l},w6:function(){return d},mG:function(){return c},ev:function(){return m}});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o}function l(e,t){return function(n,r){t(n,r,e)}}function d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{l(r.next(e))}catch(t){a(t)}}function s(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())})}function m(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)(r||!(i in t))&&(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}}}]);